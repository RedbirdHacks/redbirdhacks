/*!CK:2646487737!*//*1421682769,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["LHn6X"]); }

__d("TickerReadStateTracking",["Style","clickRefAction"],function(a,b,c,d,e,f,g,h){var i=73,j='ticker_hover',k=[];function l(n){if(!n)return null;var o=JSON.parse(n.getAttribute('data-ft'));if(!o)return null;if(o.mf_story_key)return o.mf_story_key;if(o.fbid)return o.fbid;return null;}function m(n){var o=l(n);if(!o||o in k)return;k[o]=true;var p={evt:i};h(j,n,null,'FORCE',{ft:p});}e.exports.log=m;},null);
__d("TickerController",["Event","Animation","Arbiter","AsyncRequest","AsyncSignal","Bootloader","ChannelConstants","LegacyContextualDialog","CSS","DOM","HTML","JSLogger","Keys","LayerFadeOnHide","LiveTimer","NavigationMessage","Parent","Rect","Run","ScrollableArea","SelectorDeprecated","Style","TickerReadStateTracking","Toggler","UIPagelet","URI","UserActivity","UserAgent_DEPRECATED","Vector","DOMVector","BanzaiODS","$","clickRefAction","collectDataAttributes","containsNode","copyProperties","cx","csx","ex","emptyFunction","ge","getElementText","goURI","throttle","userAction","tickerPhoteSnowLiftOpenStatus"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za){var ab=1,bb=2,cb=3,db=4,eb=15000,fb=r.create('ticker_controller');function gb(hb,ib,jb){if(hb===(void 0))return;gb._instances[hb.id]=this;gb._activeInstance=this;this._root=hb;this._content=p.find(hb,'.ticker_stream');this._stories=p.find(this._root,'.tickerActivityStories');this._scrollableArea=ib;this._container=p.find(hb,'div.uiScrollableAreaWrap');this._newestStory={};this._storyIDs=[];this._objectIDs=[];this._fetchedStories={};this._fetchedStoriesDialog={};this._storyDialogResources={};this._removedStoryIDs=[];this._storiesToRemove=[];var kb=Date.now();this._initTime=kb;this._lastUpdate=kb;this._lastPull=kb;this._lastInsert=kb;this._lastCustomStory=0;this._pollOnly=false;this._needNonCustomStoryNum=0;this._doCustomUpdate=true;this._autoloadStoryIndex=1;this._scrollTopThreshold=100;this._scrollTopPrompt=p.find(this._root,'.scrollTopPrompt');this._scrollTopPromptVisible=false;this._maxStoriesToKeep=50;this._minStoriesToKeep=25;this._tickerInSidebarMode=!!w.byClass(this._root,'fbChatSidebar');this._loadStoriesWithActions();ma('ticker_flyout');ma('ticker_flyout_prefetch');ma('ticker_flyout_loadtime');ma('ticker_stream');this._ua={flyout:ya('ticker').uai('flyout','flyout',false),flyout_prefetch:ya('ticker').uai('flyout_prefetch','flyout_prefetch',false),flyout_loadtime:ya('ticker').uai('ticker_flyout_loadtime','flyout_loadtime',false),stream:ya('ticker').uai('ticker_stream','stream',false)};this._uaCurStoryIDFetch=null;this._uaCurStoryIDPrefetch=null;var lb=p.create('div',{className:'storyQueue hidden_elem'});this._storyQueue=lb;p.appendContent(this._root,lb);this._lastKStories={head:null,tail:null,count:0,actors:{},apps:{},stories:{}};this._dedupeKeys={};this._initObjectIDs();this._initConfig(jb);this._resetMorePager();this._initListeners();this._initSubscriptions(jb);i.inform('ticker/init',this,i.BEHAVIOR_PERSISTENT);this._poll();}pa(gb,{_instances:{},_activeInstance:null,_placeholders:{},getInstance:function(hb){var ib=w.byClass(la(hb),'fbFeedTicker');return ib?gb._instances[ib.id]:null;},isLoaded:function(hb){var ib=gb._placeholders[hb.id];return !ib||ib.status==cb;},show:function(hb,ib){ib=ib||ta;for(var jb in gb._instances){var kb=ua(jb);if(!kb||kb.parentNode.id==hb.id)continue;gb.hide(kb.parentNode);}gb._doPositionChange(hb);o.show(hb);var lb=gb._placeholders[hb.id];if(lb&&lb.status==ab){var mb=(ia.getElementDimensions(hb).y||0)>0,nb=hb.id==='pagelet_rhc_ticker'&&!o.hasClass(hb,'hidden_rhc_ticker');if(mb||nb){gb._fetchTickerForPlaceholder(hb,ib);}else i.subscribe('Ticker/resized',function(){if(lb.status==ab)gb._fetchTickerForPlaceholder(hb,ib);});}else{var ob=p.scry(hb,'.fbFeedTicker')[0],pb=ob&&gb.getInstance(ob);gb._activeInstance=pb;pb&&pb._poll();gb._placeholders[hb.id]={status:db,callback:ib};ib();}i.inform('ticker/show',{node:hb,callback:ib});},_doPositionChange:function(hb){if(o.shown(hb))return;new k('/common/ods_endpoint.php',{k:'ticker.render.switch.'+hb.id}).send();},hide:function(hb){var ib=p.scry(hb,'.fbFeedTicker')[0],jb=ib&&gb.getInstance(ib);jb&&jb.hideActiveStory();o.hide(hb);},hideStoriesByClass:function(hb){for(var ib in gb._instances)p.scry(la(ib),hb).forEach(o.hide);},hideStory:function(hb){var ib=hb&&gb.getInstance(hb);ib&&ib.hideStory(hb);},replaceStory:function(hb,ib){var jb=p.scry(document.body,'div.fbFeedTickerStory'),kb=gb.getInstance(jb[0]),lb=kb._findStoryById(hb);kb.handleRemoveStory();o.hide(lb);p.insertAfter(lb,ib);ib.setAttribute('data-story-id',lb.getAttribute('id'));var mb=setTimeout(function(){gb.removeMarkup(ib,lb);},eb);ib.setAttribute('data-timeout-token',mb);},removeMarkup:function(hb,ib){o.addClass(hb,'removedStoryMarkup');new h(hb).to('height',0).duration(500).ondone(function(){p.remove(hb);}).go();},undoHideStory:function(hb){var ib=hb&&gb.getInstance(hb);ib&&ib.undoHideStory(hb);},insertStoriesAtBottom:function(hb){gb._activeInstance.insertStoriesAtBottom(hb);},_fetchTickerForPlaceholder:function(hb,ib){var jb={handler:function(){gb._placeholders[hb.id].status=cb;ib();}};ea.loadFromEndpoint('TickerEntStoryPagelet',hb.id,gb._placeholders[hb.id].pageletData,jb);gb._placeholders[hb.id].status=bb;},registerStoryDialog:function(hb,ib){i.subscribe('ticker/init',function(){var jb=ua(hb),kb=jb&&gb.getInstance(jb);kb&&kb.registerStoryDialog(jb,ib);},i.SUBSCRIBE_ALL);},registerPlaceholder:function(hb,ib){var jb=gb._placeholders[hb];gb._placeholders[hb]={status:ab,pageletData:ib};if(jb&&jb.status==db){gb.show(la(hb));jb.callback();}}});pa(gb.prototype,{ADS_IDLE_MS:300000,FLYOUT_MAX_HEIGHT:450,FLYOUT_OFFSET_THRESHOLD:20,FLYOUT_COMMENT_OFFSET:15,FLYOUT_VIEWPORT_PADDING:75,FLYOUT_ACTION_FOOTER_PADDING:8,FLYOUT_TARGET_HEIGHT_OFFSET:25,DEFAULT_LOOK_BEHIND:10,init:function(hb,ib,jb){new gb(hb,ib,jb);},_lastKStoriesInsert:function(hb){this._lastKStories.stories[hb.getAttribute("data-story-key")]=true;var ib={story:hb,next:null};if(this._lastKStories.head)this._lastKStories.head.next=ib;this._lastKStories.head=ib;this._lastKStories.count++;if(!this._lastKStories.tail)this._lastKStories.tail=this._lastKStories.head;var jb=hb.getAttribute("data-actor");if(!this._lastKStories.actors[jb])this._lastKStories.actors[jb]=0;this._lastKStories.actors[jb]++;var kb=hb.getAttribute("data-app");if(kb){if(!this._lastKStories.apps[kb])this._lastKStories.apps[kb]=0;this._lastKStories.apps[kb]++;}if(this._lastKStories.count>this.DEFAULT_LOOK_BEHIND){while(this._lastKStories.tail&&!this._lastKStoriesRemove(this._lastKStories.tail.story))this._lastKStories.tail=this._lastKStories.tail.next;if(!this._lastKStories.tail)this._lastKStories.head=null;}},_lastKStoriesRemove:function(hb){var ib=hb.getAttribute("data-story-key"),jb=hb.getAttribute("data-actor"),kb=hb.getAttribute("data-app");if(this._lastKStories.stories[ib]){delete this._lastKStories.stories[ib];this._lastKStories.actors[jb]--;if(kb)this._lastKStories.apps[kb]--;this._lastKStories.count--;return true;}else return false;},_loadStoriesWithActions:function(){var hb=ua('rightCol');if(!hb)return;this._toggleWrapper=p.scry(hb,'.tickerToggleWrapper')[0];if(this._toggleWrapper){var ib=p.scry(this._stories,'.tickerStoryWithButton');this._storiesWithActions={};for(var jb=0;jb<ib.length;jb++){var kb=ib[jb];this._storiesWithActions[kb.getAttribute('data-story-key')]=kb;}}},_initConfig:function(hb){pa(this,{_newest:hb.newest,_page_newest:hb.newest,_timeout:hb.timeout,_heartbeatTimeout:Math.min(5000,hb.heartbeatTimeout),_maxHeartbeatTimeout:Math.max(30000,hb.maxHeartbeatTimeout),_pullTimeout:Math.max(30000,hb.pullTimeout),_insertTimeout:hb.insertTimeout,_friendCount:hb.friendCount,_maxQueueLength:hb.maxQueueLength,_heartbeatEndpoint:hb.heartbeatEndpoint,_maxCustomQueueLength:hb.maxCustomQueueLength,_customStoryInsertTimeout:Math.max(5000,hb.customStoryInsertTimeout),_nonCustomToCustomStoryRatio:hb.nonCustomToCustomStoryRatio,_minForceUpdateInterval:Math.max(hb.insertTimeout,hb.minForceUpdateInterval),_popupOnHover:hb.popupOnHover,_priorityAppId:hb.priorityAppId,_userIdleTimeout:hb.userIdleTimeout,_firstCustomStoryDelay:hb.firstCustomStoryDelay,_pollOnly:hb.pollOnly,_tickerSource:hb.tickerSource,_logFlyouts:hb.logFlyouts,_userScrollGaurdDelay:hb.userScrollGaurdDelay,_rescheduleScrollToTopDelay:hb.rescheduleScrollToTopDelay,_aggressiveRegulator:hb.aggressiveRegulator});this._queueCustomStories(hb.customStories);},_initListeners:function(){this._listeners=g.listen(this._root,{click:this._handleClick.bind(this),keydown:this._handleKeydown.bind(this),mouseout:this._handleMouseout.bind(this),mouseover:this._handleMouseover.bind(this),mousedown:this._tickerDeClicker.bind(this),mouseup:this._handleMouseup.bind(this)});this._listeners.scroll=g.listen(this._container,'scroll',this._handleScroll.bind(this));setTimeout(this._initInfiniteScrollListener.bind(this),0);},_initSubscriptions:function(hb){y.onLeave(this._cleanup.bind(this));this._subscriptions=[i.subscribe(v.NAVIGATION_BEGIN,this._onNavHandler.bind(this)),i.subscribe('composer/publish',this._handleComposerPublish.bind(this)),i.subscribe('Ticker/storiesInserted',this._handleStoriesInserted.bind(this)),i.subscribe('Ticker/fixed',this._setFixed.bind(this,true)),i.subscribe('Ticker/unfixed',this._setFixed.bind(this,false)),i.subscribe('Ticker/resized',this._checkInfiniteScroll.bind(this)),i.subscribe('ufi/comment',this._scrollDialogToBottom.bind(this)),i.subscribe('ufi/changed',this._redrawFlyout.bind(this)),i.subscribe('Ticker/chatOpened',this._handleChatOpened.bind(this))];if(!hb.pollOnly)this._subscriptions.push(i.subscribe(m.getArbiterType('ticker_update'),this._handleTickerPush.bind(this)));if(hb.pushChannel&&!hb.pollOnly)this.setPushChannel(hb.pushChannel);},_handleClick:function(event){if(!(event.button===1||event.altKey||event.ctrlKey||event.metaKey))event.prevent();var hb=event.getTarget();if(this._getButtonFromNode(hb)){this._logUserAction(hb,'click',event);this._handleActionButton(event);return;}var ib=this._getStoryFromNode(hb),jb=w.byClass(hb,'tickerStoryAllowClick');if(!ib||ib==this._selectedStory||jb)return;if(this._storyIsHidden(ib))return;if(ib==this._activeStory&&!this._selectedStory)this._selecting=true;this._logUserEvent('flyout','click');this._logUserEvent('flyout_loadtime','open');if(this._storyCanOpenExternally(ib)){var kb=ib.getAttribute('data-href');if(kb&&!hb.getAttribute('href')){var lb={href:kb},mb=na(hb,['ft','gt']);ma('click',lb,event,'FORCE',mb);ya('ticker',lb,event).uai('click');}else this._logUserAction(hb,'click',event);this._openStoryExternally(ib,event);return;}this._logUserAction(hb,'flyout',event);this._activateStory(ib,'click');this._selectStory(ib);},_handleMouseover:function(event){this._setLocked(true);var hb=event.getTarget(),ib=this._getOpenableStory(hb);if(!ib){var jb=w.byClass(hb,"_5wvy");if(jb){clearTimeout(parseInt(jb.getAttribute('data-timeout-token'),10));var kb=setTimeout(function(){gb.removeMarkup(jb,ib);},eb);jb.setAttribute('data-timeout-token',kb);}return;}event.kill();if(this._popupOnHover){if(!(ib.id in this._fetchedStories)){this._logUserEvent('flyout_prefetch','prefetch_on_hover');this._uaCurStoryIDPrefetch=ib.id;}this._fetchStory(ib);}if(this._selectedStory)return;if(this._popupOnHover){this._clearHoverTimeouts();var lb=this._storyCanOpenExternally(ib)?500:1000,mb=this._activeStory?75:lb;this._hoverShowTimeout=this._setTimeout(function(){this._logUserEvent('flyout','hover',mb);this._logUserEvent('flyout_loadtime','open');this._activateStory(ib,'hover');this._logUserAction(hb,'flyout',event);}.bind(this),mb);}},_handleMouseout:function(event){var hb=event.getTarget();this._setLocked(false);if(hb==this._getStoryFromNode(hb)){var ib=p.scry(hb.parentNode,'.openToggler');for(var jb=0;jb<ib.length;jb++)aa.toggle(ib[jb]);}this._clearClickedStory();this._scheduleHide();},_handleKeydown:function(event){this._tickerDeClicker(event);var hb=this._activeStory;if(!hb)return;var ib=g.getKeyCode(event);switch(ib){case s.UP:case s.DOWN:var jb=this._getInsertedStories(),kb;if(event.getModifiers().any){kb=ib===s.UP?0:jb.length-1;}else kb=jb.indexOf(hb)+(ib===s.UP?-1:1);hb=jb[kb];break;case s.ESC:this._deactivateStory(true);return;default:return;}event.kill();if(!hb)return;this._activateStory(hb,'keypress');this._selectStory(hb);},_fadeTopmostStoryButton:function(){var hb=0,ib=15;if(this._storiesWithActions)for(var jb in this._storiesWithActions){var kb=this._storiesWithActions[jb],lb=p.scry(kb,'.tickerInlineActionButton')[0],mb=p.scry(lb,'.tickerActionIcon')[0],nb=ia.getElementPosition(lb).y-ia.getElementPosition(this._toggleWrapper).y;if(nb<hb){ba.set(lb,'opacity',0);ba.set(mb,'opacity',0);}else if(nb>=hb&&nb<ib){var ob=(nb-hb)/(ib-hb);ba.set(lb,'opacity',ob);ba.set(mb,'opacity',ob);break;}else{ba.set(lb,'opacity',1);ba.set(mb,'opacity',1);}}},_handleScroll:function(){var hb=za.checkIsOpen();if(hb)this._preventFlyoutDismiss=true;if(!this._preventScrollDismiss&&!hb){if(!this._preventFlyoutDismiss){this._deactivateStory(true);}else this._preventFlyoutDismiss=false;}else this._preventScrollDismiss=false;if(!this._handleScrollThrottled)this._handleScrollThrottled=xa(this._handleScrollInner.bind(this));this._handleScrollThrottled();},_handleScrollInner:function(){this._fadeTopmostStoryButton();this._checkInfiniteScroll();this._setIsUserScrolling();if(!this._scrollLogged){this._scrollLogged=true;var hb=this._stories.childNodes.length,ib=this._stories.getAttribute('data-gt'),jb={ticker_scroll:1,number_stories:hb,source:ib};ma('scroll',null,null,'FORCE',{gt:jb});ya('ticker').uai('scroll');}},_setIsUserScrolling:function(){clearTimeout(this._userScrollingToken);if(this._isScrolledToTop()){this._userScrolling=false;return;}this._userScrolling=true;this._userScrollingToken=setTimeout(function(){this._userScrolling=false;this._userScrollingToken=null;}.bind(this),this._userScrollGaurdDelay);},_isUserScrolling:function(){return this._userScrolling;},_handleStoriesInserted:function(){this._initInfiniteScrollListener();if(this._scrollableArea instanceof z){this._scrollableArea.adjustGripper();}else fb.error('wrong_scrollable_area',{dump:this});this._logUserEvent('stream','insert');},_handleActionButton:function(event){var hb=event.getTarget(),ib=this._getOpenableStory(hb),jb=this._getStoryDialog(ib);if(jb)var kb=jb.subscribe('beforehide',function(){jb.unsubscribe(kb);return false;});},_handleScrollToTopClick:function(){this._scrollToTop(this._poll.bind(this));},_scheduleScrollToTop:function(){this._scrollToTopToken&&clearTimeout(this._scrollToTopToken);this._scrollToTopToken=setTimeout(function(){if(this._isLocked()||this._isUserScrolling()){this._scheduleScrollToTop();}else{this._scrollToTopToken=null;this._scrollToTop();}}.bind(this),this._rescheduleScrollToTopDelay);},_scrollToTop:function(hb){new h(this._container).to('scrollTop',0).ease(h.ease.end).ondone(hb).go();},_clearHoverTimeouts:function(){clearTimeout(this._hoverShowTimeout);clearTimeout(this._hoverHideTimeout);},_getAllStories:function(){return p.scry(this._root,'div.fbFeedTickerStory');},_findStoryById:function(hb){var ib=p.scry(this._root,'.fbFeedTickerStory'),jb;for(story in ib){jb=ib[story];if(hb==this._getStoryDialogParams(jb).token)return jb;}return null;},_getInsertedStories:function(){return this._getAllStories().filter(function(hb){return !o.hasClass(hb,'queuedStory')&&!o.hasClass(hb,'customStory');});},_getQueuedStories:function(){return p.scry(this._storyQueue,'.fbFeedTickerStory.queuedStory');},_getQueuedCustomStories:function(){return p.scry(this._storyQueue,'.fbFeedTickerStory.customStory');},_getButtonFromNode:function(hb){return w.byClass(hb,'tickerInlineOverlay');},_getStoryFromNode:function(hb){return w.byClass(hb,'fbFeedTickerStory');},_getActionButtonFromStory:function(hb){return p.scry(hb,'.tickerInlineActionButton')[0];},_getOpenableStory:function(hb){var ib=this._getStoryFromNode(hb);return this._storyCanOpenDialog(ib)?ib:null;},_getStoryDialog:function(hb){return this._fetchedStoriesDialog[hb.id]||n.getInstance(hb);},_getStoryDialogParams:function(hb){var ib=hb&&hb.getAttribute('data-flyoutdata')||null;return ib&&JSON.parse(ib)||null;},_storyCanOpenDialog:function(hb){return !!this._getStoryDialogParams(hb)&&!this._storyIsHidden(hb);},_storyCanOpenExternally:function(hb){return !!hb.getAttribute('data-href')||!this._storyCanOpenDialog(hb);},_storyIsHidden:function(hb){return o.hasClass(hb,'tickerStoryHidden');},hideActiveStory:function(){this._activeStory&&this.hideStory(this._activeStory);},hideStory:function(hb){this._deactivateStory();if(va(hb)==='')p.remove(hb);o.addClass(hb,'tickerStoryHidden');o.removeClass(hb,'tickerStoryClickable');},undoHideStory:function(hb){o.addClass(hb,'tickerStoryClickable');o.removeClass(hb,'tickerStoryHidden');},insertStoriesAtBottom:function(hb){if(!hb)return;var ib=p.create('div');ib.appendChild(hb);var jb=p.scry(ib,'.fbFeedTickerStory'),kb=p.find(ib,'.tickerMorePager'),lb=[];for(var mb=0;mb<jb.length;mb++)if(!this.dedupeStory(jb[mb]))lb.push(jb[mb]);if(lb.length){lb.push(kb);p.replace(p.find(this._root,'.tickerMorePager'),lb);}i.inform('Ticker/storiesInserted');},_scheduleHide:function(){if(this._popupOnHover&&!this._selectedStory){this._clearHoverTimeouts();this._hoverHideTimeout=this._setTimeout(this._deactivateStory.bind(this),100);}},_setScrollTopPromptVisible:function(hb){this._scrollTopPromptVisible=hb;o.conditionShow(this._scrollTopPrompt,hb);if(hb&&!this._listeners.scrollTop){this._listeners.scrollTop=g.listen(this._scrollTopPrompt,{click:this._handleScrollToTopClick.bind(this)});}else if(!hb&&this._listeners.scrollTop){this._listeners.scrollTop.click.remove();this._listeners.scrollTop=null;}},_isUserIdle:function(){return !ga.isActive(this._userIdleTimeout);},_schedulePoll:function(){clearTimeout(this._pollToken);this._pollToken=this._setTimeout(this._poll.bind(this),this._timeout);},_poll:function(){if(!this._isTickerVisible())return;if(this._storiesToRemove.length>0){if(this._isInsertingStory)return this._schedulePoll();var hb=this._storiesToRemove.pop();this.removeStory(hb);}var ib=!this._isScrolledToTop()&&this._getQueuedStories().length;this._setScrollTopPromptVisible(ib);var jb=Date.now(),kb=jb-this._lastInsert;if(kb<this._insertTimeout||this._isLocked())return this._schedulePoll();var lb=this._getQueuedStories(),mb=this._getQueuedCustomStories(),nb=this._isUserIdle(),ob=lb.length>0,pb=mb.length>0&&!nb&&(jb-this._initTime>this._firstCustomStoryDelay)&&(this._needNonCustomStoryNum===0||(!ob&&(jb-this._lastCustomStory)>this._customStoryInsertTimeout));if(pb){this.insertStory(mb.shift());this._lastCustomStory=jb;this._needNonCustomStoryNum=this._nonCustomToCustomStoryRatio;return this._schedulePoll();}if(ob){var qb=lb.shift();this.insertStory(qb);this._needNonCustomStoryNum--;if(this._needNonCustomStoryNum<0)this._needNonCustomStoryNum=0;return this._schedulePoll();}if(nb)return ga.subscribeOnce(this._poll.bind(this));var rb=mb.length===0&&this._needNonCustomStoryNum===0&&this._nonCustomToCustomStoryRatio>0&&ga.isActive(this.ADS_IDLE_MS)&&((jb-this._lastUpdate)>this._minForceUpdateInterval),sb=false,tb=false;if(this._pollOnly){tb=jb-this._lastUpdate>this._heartbeatTimeout;}else sb=(jb-this._lastPull>this._pullTimeout);var ub=(rb&&this._doCustomUpdate)||sb||tb;if(!ub)return this._schedulePoll();if(rb)this._doCustomUpdate=false;this.update({pull:sb,fullpoll:tb,needcustomstory:rb});},_updatePollOnlyHeartbeatTimeout:function(){if(this._pollOnly&&this._heartbeatTimeout<this._maxHeartbeatTimeout)this._heartbeatTimeout=Math.min(this._heartbeatTimeout+5000,this._maxHeartbeatTimeout);},update:function(hb){this._updatePollOnlyHeartbeatTimeout();if(!this._pollOnly)return this._schedulePoll();var ib={newest:(hb.fullpoll||hb.cache_update)?this._newest:this._page_newest,storyids:this._storyIDs,friendcount:this._friendCount,priorityappid:this._priorityAppId,source:this._tickerSource,needcustomstory:this._nonCustomToCustomStoryRatio>0};if(!ib.newest||ib.newest==='0')throw new Error(sa('Trying to request new ticker stories with an invalid cursor %s, with'+' the settings fullpoll %s, cache_update %s, value coming from this.%s',typeof ib.newest==='string'?'"'+ib.newest+'"':ib.newest,hb.fullpoll,hb.cache_update,(hb.fullpoll||hb.cache_update)?'_newest':'_page_newest'));pa(ib,hb);new j().setURI(this._heartbeatEndpoint).setReadOnly(true).setOption('retries',0).setData(ib).setHandler(this._handleResponse.bind(this)).setFinallyHandler(this._poll.bind(this)).setAllowCrossPageTransition(true).send();this._lastUpdate=Date.now();if(ib.pull)this._lastPull=this._lastUpdate;this._storyIDs=[];},insertStory:function(hb,ib,jb){this._lastInsert=Date.now();window.LiveTimer&&u.addTimeStamps(hb);o.removeClass(hb,'queuedStory');o.removeClass(hb,'customStory');if(ib!==false){var kb=jb?this._fadeStoryIn:this._flyStoryIn;if(this._isUserScrolling()){var lb=function(){this._container.scrollTop=this._container.scrollTop+this._stories.firstChild.offsetHeight;this._scheduleScrollToTop();}.bind(this);this._fadeStoryIn(hb,lb);}else this._scrollToTop(kb.bind(this,hb));}else p.prependContent(this._stories,hb);if(this._storiesWithActions&&o.hasClass(hb,'tickerStoryWithButton'))this._storiesWithActions[hb.getAttribute('data-story-key')]=hb;this._removeOldStories();},_removeOldStories:function(){var hb=this._getInsertedStories();if(hb.length<=this._maxStoriesToKeep)return;var ib=this._minStoriesToKeep,jb=hb.slice(ib);jb.forEach(p.remove);if(this._storiesWithActions)for(var kb=0;kb<jb.length;kb++)delete this._storiesWithActions[jb[kb].getAttribute('data-story-key')];this._resetMorePager();},_resetMorePager:function(){var hb=this._getInsertedStories();if(!hb||!hb.length)return;var ib=hb[hb.length-1].getAttribute('data-ticker-timestamp'),jb=p.scry(this._root,'.tickerMorePager a')[0];if(!jb||!ib)return;var kb=new fa(jb.getAttribute('ajaxify'));kb.addQueryData({oldest:ib});jb.setAttribute('ajaxify',kb);},_setLocked:function(hb){this._locked=hb;},_isLocked:function(){return !!(this._locked||this._activeStory);},informAndRemoveStory:function(hb,ib,jb){var kb=this._getStoryFromNode(hb),lb=kb.getAttribute('data-story-key');p.setContent(kb,ib);o.addClass(kb,'highlightedStory');this._setTimeout(this.removeStory.bind(this,lb),jb||6000);},_getStoryByStoryKey:function(hb){var ib=this._getAllStories();for(var jb=0;jb<ib.length;jb++){var kb=ib[jb];if(kb.getAttribute('data-story-key')==hb)return kb;}return null;},removeStory:function(hb){this._removedStoryIDs[hb]=true;var ib=this._getStoryByStoryKey(hb);if(!ib)return;if(this._storiesWithActions)delete this._storiesWithActions[hb];if(ib==this._activeStory)this._deactivateStory();var jb=this._getStoryDialog(ib);jb&&jb.destroy();this._lastKStoriesRemove(ib);var kb=ib.getAttribute("data-dedupe-key");if(kb)delete this._dedupeKeys[kb];if(o.hasClass(ib,'queuedStory')){p.remove(ib);return;}this._animateStoryOut(ib);},_isScrolledToTop:function(){return this._container.scrollTop<=this._scrollTopThreshold;},_flyStoryIn:function(hb){var ib=p.create('div',{style:{marginTop:'-1000px'}},hb);ba.set(ib,'opacity',0);p.prependContent(this._stories,ib);var jb=ia.getElementDimensions(ib).y;ba.set(ib,'marginTop','-'+jb+'px');this._isInsertingStory=true;new h(ib).to('marginTop',0).ease(h.ease.end).checkpoint(.5).to('opacity',1).ondone(function(){p.replace(ib,hb);this._afterInsert(hb);this._isInsertingStory=false;}.bind(this)).go();},_fadeStoryIn:function(hb,ib){new h(this._stories).to('opacity',.5).ondone(function(){p.prependContent(this._stories,hb);if(ib)ib();new h(this._stories).to('opacity',1).ondone(function(){this._afterInsert(hb);}.bind(this)).go();}.bind(this)).go();},_animateStoryOut:function(hb){var ib=p.create('div',{style:{overflow:'hidden',position:'relative'}});p.insertBefore(hb,ib);p.appendContent(ib,hb);new h(ib).to('top',20).to('height',0).to('opacity',0).ease(h.ease.end).ondone(function(){p.remove(ib);i.inform('Ticker/animateOut');}.bind(this)).go();},_afterInsert:function(hb){i.inform('Ticker/afterInsert');},setPushChannel:function(hb){this._pushSubscription&&this._pushSubscription.unsubscribe();this._pushSubscription=i.subscribe(m.getArbiterType(hb),this._handleTickerPush.bind(this));d(['ChatConfig','ChannelConnection'],function(ib,jb){this._channelConnection=jb;this._checkChannelConnection();this._channelConnectionSubscription=this._channelConnection.subscribe([this._channelConnection.CONNECTED,this._channelConnection.RECONNECTING,this._channelConnection.SHUTDOWN,this._channelConnection.MUTE_WARNING,this._channelConnection.UNMUTE_WARNING],this._handleChannelConnection.bind(this));}.bind(this));},_checkChannelConnection:function(){o.conditionClass(this._root,'disconnected',this._channelConnection.disconnected());},setCurrentAppId:function(hb){this._priorityAppId=hb;},_handleTickerPush:function(hb,ib){var jb=ib.obj;if(jb.delete_id){this._storiesToRemove.push(jb.delete_id);return;}if(jb.fromups)if(jb.do_logging)this._logDarkLaunch(jb);var kb=jb.story_xhp;if(!kb)return;var lb=q(kb).getRootNode();if(!jb.story_time||jb.story_time==='0')throw new Error(sa('An invalid story time was pushed: %s, for ticker story: %s',typeof jb.story_time==='string'?'"'+jb.story_time+'"':jb.story_time,lb.getAttribute('data-flyoutdata')));this._newest=jb.story_time;this.queueStory(lb,jb.flyout_js_cmds);if(this._aggressiveRegulator&&jb.actor==this._newestStory.actorID){this.removeStory(this._newestStory.storyKey);new k('/common/ods_endpoint.php',{k:'ticker.aggr.remove'}).send();}this._newestStory={actorID:jb.actor,storyKey:lb.getAttribute('data-story-key')};},_handleComposerPublish:function(hb,ib){ib.tickerMarkup&&this.insertStory(ib.tickerMarkup);},_logDarkLaunch:function(hb){var ib={actor:hb.actor,story_time:hb.story_time,key:hb.story_obj_id,dark:1};new j().setURI('/alite/push/log.php').setData({msg:JSON.stringify(ib)}).send();},_logRender:function(){if(this._loggedRender)return;var hb=this._tickerInSidebarMode;if(hb||w.byClass(this._content,'home_right_column')){new k('/ajax/log_ticker_render.php',{sidebar_mode:hb}).send();this._loggedRender=true;}},_isTickerVisible:function(){var hb=(gb._activeInstance==this);hb&&this._logRender();return hb;},_handleResponse:function(hb){var ib=hb.getPayload();if(ib.newest)this._newest=this._page_newest=ib.newest;if(ib.content)if(ib.content instanceof Array){for(var jb=0;jb<ib.content.length;jb++)this.queueStoryMarkup(ib.content[jb]);}else this.queueStoryMarkup(ib.content);if(ib.custom_stories&&ib.custom_stories.length){this._queueCustomStories(ib.custom_stories);this._doCustomUpdate=true;}},queueStoryMarkup:function(hb){var ib=q(hb).getRootNode();this.queueStory(ib);},dedupeStory:function(hb){var ib=hb.getAttribute('data-story-key'),jb=ib&&(!!this._objectIDs[ib]||!!this._removedStoryIDs[ib]);jb=jb||!!this._lastKStories.actors[hb.getAttribute('data-actor')]||!!this._lastKStories.apps[hb.getAttribute('data-app')];var kb=hb.getAttribute('data-dedupe-key');jb=jb||kb&&this._dedupeKeys[kb];if(hb.getAttribute('data-force-push'))jb=false;ib&&(this._objectIDs[ib]=true);return jb;},queueStory:function(hb,ib){if(this.dedupeStory(hb))return;this._lastKStoriesInsert(hb);var jb=hb.getAttribute("data-dedupe-key");if(jb)this._dedupeKeys[jb]=true;o.addClass(hb,'queuedStory');p.appendContent(this._storyQueue,hb);var kb=ib&&ib.length;if(kb)ib.forEach(function(mb){new Function(mb).apply();});hb.setAttribute('id',hb.id+'_'+this._root.id);var lb=this._getQueuedStories();lb.slice(0,-this._maxQueueLength).forEach(p.remove);if(kb)this._fetchedStories[hb.id]=true;},_queueCustomStories:function(hb){while(hb.length){var ib=hb.shift();ib=q(ib).getRootNode();if(this.dedupeStory(ib))continue;o.addClass(ib,'customStory');p.appendContent(this._storyQueue,ib);}var jb=this._getQueuedCustomStories();jb.slice(0,-this._maxQueueLength).forEach(p.remove);},_cleanup:function(){gb._placeholders.pagelet_rhc_ticker=null;if(!w.byClass(this._content,'hasRightCol'))return;this._objectIDs=[];this._subscriptions.forEach(i.unsubscribe);this._channelConnectionSubscription&&this._channelConnection.unsubscribe(this._channelConnectionSubscription);this._pushSubscription&&this._pushSubscription.unsubscribe();for(var hb in this._listeners)this._listeners[hb]&&this._listeners[hb].remove();clearTimeout(this._pollToken);this._pollToken=null;this._cleanupInputFocusListener();this._cleanupContentResizeListener();i.inform('Ticker/cleanup');},_onNavHandler:function(hb,ib){var jb=ib.params.key;if(jb!='lf'&&jb!='h')this._cleanup();},registerStoryDialog:function(hb,ib){if(this._uaCurStoryIDFetch==hb.id){this._uaCurStoryIDFetch=null;this._logUserEvent('flyout','fetch_success');}if(this._uaCurStoryIDPrefetch==hb.id){this._uaCurStoryIDPrefetch=null;this._logUserEvent('flyout_prefetch','prefetch_success');}this._fetchedStories[hb.id]=true;this._fetchedStoriesDialog[hb.id]=ib;ib.setContext(hb);ib.subscribe('hide',this._deactivateStory.bind(this,true));ib.subscribe('success',this._focusStory.bind(this,hb));ib.subscribe('beforehide',function(){if(this._selecting){this._selecting=false;return false;}}.bind(this));if(this._popupOnHover){ib.subscribe('mouseenter',this._clearHoverTimeouts.bind(this));ib.subscribe('mouseleave',this._scheduleHide.bind(this));ib.subscribe('show',function(){setTimeout(this._highlightDialogScrollbar.bind(this,ib),0);var jb=g.listen(ib.getContent(),'mousedown',function(){this._selectStory(hb);jb.remove();}.bind(this));}.bind(this));}if(hb==this._activeStory){this._logUserEvent('flyout_loadtime','show_fetched');this._logUserEvent('flyout','show');this._openDialog(ib);}},_highlightDialogScrollbar:function(hb){var ib=p.scry(hb.getContent(),'.uiScrollableArea')[0];ib&&z.poke(ib);},_openStoryExternally:function(hb,event){var ib=hb.getAttribute('data-href');if(!ib||ib=='#')return;var jb=hb.getAttribute('data-story-rel');switch(jb){case 'theater':this._deactivateAndClearStory();l.loadModules(["PhotoViewer"],function(mb){mb.bootstrap(ib,hb);});return;case 'async':this._deactivateAndClearStory();j.bootstrap(ib,hb);return;}var kb=hb.getAttribute('data-target'),lb=(event.which!=1||event.getModifiers().any||kb=='_blank');lb?window.open(ib,'_blank'):wa(ib);},_deactivateAndClearStory:function(){this._clearHoverTimeouts();this._deactivateStory();},_focusStoryWillTriggerScroll:function(hb){var ib=this._container,jb=ib.clientHeight,kb=hb.offsetHeight,lb=ib.scrollTop,mb=lb+jb,nb=hb.offsetTop,ob=nb+kb;return nb<lb||ob>mb;},_focusStory:function(hb){if(this._focusStoryWillTriggerScroll(hb))this._preventScrollDismiss=true;var ib=new x(hb),jb=w.byClass(hb,'scrollable'),kb=ib.boundWithin(new x(jb)).getPositionVector(),lb=ib.getPositionVector().sub(kb);if(lb.y!==0)lb.scrollElementBy(jb);hb.focus();},_selectStory:function(hb){this._selectedStory=hb;o.addClass(hb,'tickerStorySelected');o.addClass(this._root,'tickerChildSelected');},_activateStory:function(hb,ib){this._clearHoverTimeouts();if(hb==this._activeStory||!this._storyCanOpenDialog(hb))return;this._deactivateStory();this._focusStory(hb);this._activeStory=hb;o.addClass(hb,'tickerStoryActive');window.Toggler&&da.hide();if(this._logFlyouts){ib=ib||'unknown';new k('/ajax/feed/ticker/flyout.php',{src:ib}).send();}ca.log(hb);var jb=this._getStoryDialog(hb);if(jb){this._logUserEvent('flyout_loadtime','show_prefetched');this._logUserEvent('flyout','show');if(this._storyDialogResources[hb.id])l.loadResources(this._storyDialogResources[hb.id]);this._openDialog(jb);ka.bumpEntityKey('ticker_stories','flyouts.open');return;}if(!(hb.id in this._fetchedStories)){this._uaCurStoryIDFetch=hb.id;this._logUserEvent('flyout','fetch');}this._fetchStory(hb);},handleRemoveStory:function(){this._deactivateStory(true);},_deactivateStory:function(hb){if(this._activeStory===this._deactivatingStory)return;this._deactivatingStory=this._activeStory;if(this._dialog){if(hb===true){this._dialog.enableBehavior(t);}else this._dialog.disableBehavior(t);this._dialog.hide();this._logUserEvent('flyout','close');}if(this._activeStory){o.removeClass(this._activeStory,'tickerStoryActive');o.removeClass(this._activeStory,'tickerStorySelected');o.removeClass(this._root,'tickerChildSelected');}this._dialog=this._selectedStory=this._activeStory=null;this._cleanupInputFocusListener();this._cleanupContentResizeListener();this._deactivatingStory=null;},_logUserAction:function(hb,ib,event){ma(ib,hb,event,'FORCE');ya('ticker',hb,event).uai(ib);},_logUserEvent:function(hb,event){if(this._ua[hb])this._ua[hb].add_event(event);},_fetchStory:function(hb){clearTimeout(this._fetchToken);var ib=[],jb=this._getInsertedStories(),kb=jb.indexOf(hb);[-1,0,1].forEach(function(lb){var mb=jb[kb+lb];mb&&ib.push(mb);},this);this._fetchToken=setTimeout(this._fetchStories.bind(this,ib),100);},_fetchStories:function(hb){var ib=[],jb,kb=function(lb){clearTimeout(jb);hb.forEach(function(mb){o.conditionClass(mb,'tickerStoryFetching',lb);});};hb=hb.filter(function(lb){if(lb.id in this._fetchedStories)return false;this._fetchedStories[lb.id]=true;var mb=this._getStoryDialogParams(lb);if(!mb)return false;mb.uniq_id=lb.getAttribute('id');mb.referrer=this._tickerSource;ib.push(mb);return true;},this);if(!ib.length)return;jb=this._setTimeout(kb.bind(null,true),500);new j('/ajax/feed/ticker/multi_story').setInitialHandler(this._handleDialogResponse.bind(this,ib)).setFinallyHandler(kb.bind(null,false)).setErrorHandler(ta).setData({stories:ib}).setAllowCrossPageTransition(this._tickerInSidebarMode).send();},_handleDialogResponse:function(hb,ib){if(ib&&ib.resource_map){var jb=[];for(var kb in ib.resource_map){var lb=ib.resource_map[kb];if(lb.type==='css'&&!lb.permanent)jb.push(kb);}if(jb.length>0)for(var mb=0;mb<hb.length;mb++)this._storyDialogResources[hb[mb].uniq_id]=jb;}},_tickerDeClicker:function(event){var hb=event.getTarget(),ib=w.byTag(hb,'a'),jb=this._getStoryFromNode(hb),kb=this._getButtonFromNode(hb);if(jb&&ib&&!kb&&o.hasClass(jb,'tickerStoryClickable')&&!o.hasClass(ib,'tickerStoryAllowClick')&&!this._storyIsHidden(jb))ib.setAttribute('rel','ignore');var lb=(event.button==2),mb=(event.type==='keydown'),nb=jb&&this._getActionButtonFromStory(jb);if(!lb&&nb&&!mb)this._setClickedStory(jb);},_handleMouseup:function(event){this._clearClickedStory();},_setClickedStory:function(hb){this._clearClickedStory();o.addClass(hb,'tickerStoryClicked');this._clickedStory=hb;},_clearClickedStory:function(){if(this._clickedStory){o.removeClass(this._clickedStory,'tickerStoryClicked');this._clickedStory=null;}},_initInfiniteScrollListener:function(){var hb=this._getInsertedStories();if(this._storiesWithActions)for(var ib=0;ib<hb.length;ib++){var jb=hb[ib];if(o.hasClass(jb,'tickerStoryWithButton'))this._storiesWithActions[jb.getAttribute('data-story-key')]=jb;}var kb=Math.max(0,hb.length-this._autoloadStoryIndex);this._infiniteScrollStory=hb[kb];this._checkInfiniteScroll();},_checkInfiniteScroll:function(){if(this._infiniteScrollStory){var hb=ia.getElementPosition(this._infiniteScrollStory).y,ib=ia.getElementPosition(this._container).y+ia.getElementDimensions(this._container).y;if(hb<ib){var jb=p.scry(this._root,'.tickerMorePager a')[0];if(jb){var kb=w.byClass(jb,'stat_elem')||jb;new j(jb.getAttribute('ajaxify')).setReadOnly(true).setRelativeTo(jb).setStatusElement(kb).setAllowCrossPageTransition(true).send();this._logUserEvent('stream','scroll');}this._infiniteScrollStory=null;this._autoloadStoryIndex=5;}}},_setFixed:function(hb){if(!this._selectedStory)return;var ib=this._getStoryDialog(this._selectedStory);if(ib){ib.setFixed&&ib.setFixed(hb);ib.updatePosition();}},_setTimeout:function(hb,ib){return setTimeout(hb,ib,!this._tickerInSidebarMode);},_scrollDialogToBottom:function(){var hb=this._dialog&&this._dialog.getContent(),ib=hb&&p.scry(hb,'.uiScrollableAreaWrap')[0],jb=ib&&z.getInstance(ib);jb&&jb.scrollToBottom();},_redrawFlyout:function(hb,ib){if(this._hasUFIUpdated)return;var jb=this._dialog;if(jb&&jb.isShown()&&oa(jb.getContent(),ib.form)){this._hasUFIUpdated=true;this._updateDialogPosition();}},_openDialog:function(hb){if(!this._tickerInSidebarMode)o.addClass(hb.getRoot(),'tickerStoryOverlayOnTop');this._hasUFIUpdated=false;var ib=ja.getScrollPosition();this._dialog=hb.show();window.scrollTo(ib.x,ib.y);this._updateDialogPosition();this._writeSwfFrame(hb);setTimeout(this._initCommentFocusListener.bind(this),0);setTimeout(this._initContentResizeListener.bind(this),0);this._stupidIE7VideoResizeHack(hb);},_stupidIE7VideoResizeHack:function(hb){if(ha.ie()===7){var ib=p.scry(hb.getContent(),'.uiVideoThumb .img');ib.forEach(function(jb){ba.set(jb,'width','');});}},_updateDialogPosition:function(){var hb=this._tickerInSidebarMode||!!w.byClass(this._root,'fixed_elem');this._dialog.setFixed&&this._dialog.setFixed(hb);this._adjustFlyoutContentHeight();this._dialog.updatePosition();},_writeSwfFrame:function(hb){var ib=this._dialog&&this._dialog.getContent(),jb=p.scry(ib,'.swfObject')[0];if(!jb)return;var kb=jb.getAttribute('data-swfid');if(kb&&window[kb]){var lb=window[kb];lb.write(jb);}},_initCommentFocusListener:function(){var hb=this._dialog&&this._dialog.getContent(),ib=hb&&p.scry(hb,'.tickerDialogFooter textarea')[0];if(!ib)return;this._listeners.inputFocus=g.listen(ib,'focus',this._scrollDialogToBottom.bind(this));},_cleanupInputFocusListener:function(){if(this._listeners.inputFocus){this._listeners.inputFocus.remove();this._listeners.inputFocus=null;}},_initContentResizeListener:function(){var hb=this._dialog&&this._dialog.getContent();if(!hb)return;this._listeners.contentResize=g.listen(hb,'click',function(){setTimeout(this._dialog.updatePosition.bind(this._dialog),0);}.bind(this));},_cleanupContentResizeListener:function(){if(this._listeners.contentResize){this._listeners.contentResize.remove();this._listeners.contentResize=null;}},_adjustFlyoutContentHeight:function(){var hb=this._dialog&&this._dialog.getContent(),ib=hb&&p.scry(hb,'.uiScrollableAreaWrap')[0];if(!ib)return;var jb=ia.getElementDimensions(ib),kb=ia.getElementPosition(ib),lb=p.scry(ib,'.uiUfi .uiUfiComment'),mb=p.scry(ib,"._12tg")[0],nb=this.FLYOUT_MAX_HEIGHT;if(mb){var ob=ia.getElementPosition(mb);nb=Math.max(nb,this.FLYOUT_TARGET_HEIGHT_OFFSET+this.FLYOUT_ACTION_FOOTER_PADDING+ib.scrollTop+ob.y+mb.offsetHeight-kb.y);}var pb=ia.getViewportDimensions().y-this.FLYOUT_VIEWPORT_PADDING;nb=Math.min(nb,pb);var qb=nb-this.FLYOUT_TARGET_HEIGHT_OFFSET;for(var rb=0;rb<lb.length;rb++){var sb=lb[rb],tb=ia.getElementPosition(sb),ub=tb.y-kb.y;if(Math.abs(ub-qb)<=this.FLYOUT_OFFSET_THRESHOLD){qb=ub+this.FLYOUT_COMMENT_OFFSET;break;}}if(jb.y>=qb){ba.set(ib,'height',qb+'px');ba.set(ib,'max-height',null);}else{ba.set(ib,'max-height',nb+'px');ba.set(ib,'height',null);}},_initObjectIDs:function(){var hb=this._getAllStories();for(var ib=hb.length-1;ib>=0;ib--){var jb=hb[ib].getAttribute('data-story-key');if(jb){this._objectIDs[jb]=true;this._lastKStoriesInsert(hb[ib]);var kb=hb[ib].getAttribute("data-dedupe-key");if(kb)this._dedupeKeys[kb]=true;}}},_handleChatOpened:function(){this._deactivateStory(true);},_handleChannelConnection:function(){this._checkChannelConnection();},getNewest:function(){return this._newest;}});e.exports=gb;},null);
__d("TickerRightColumnController",["Arbiter","CSS","DOM","Event","NavigationMessage","Run","Style","SubscriptionsHandler","TickerController","Vector","ge","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s;function t(){var y=q('pagelet_rhc_ticker');y&&o.show(y,v);}function u(){var y=q('pagelet_rhc_ticker');y&&o.hide(y);}function v(){var y=q('pagelet_rhc_ticker'),z=i.scry(y,'.ticker_container')[0],aa=i.scry(y,'.ticker_stream')[0],ba=q('rightCol');if(!y||!z||!aa||!ba)return;m.set(z,'height','0');var ca=75,da=p.getViewportDimensions().y,ea=p.getElementDimensions(ba).y,fa=da-ea-ca,ga=p.getElementDimensions(aa).y,ha=Math.max(Math.min(fa,ga,s.tickerMaxHeight||425),s.tickerMinHeight||225);m.set(z,'height',ha+'px');}function w(y){var z=q('pagelet_reminders'),aa=q('pagelet_rhc_ticker'),ba=z&&i.scry(z,'div.tickerToggleWrapper')[0],ca=aa&&i.scry(aa,'div.tickerToggleWrapper')[0];ba&&h.conditionClass(ba,'displayedTickerToggleWrapper',!y);ca&&h.conditionClass(ca,'displayedTickerToggleWrapper',y);aa&&h.conditionClass(aa,'hidden_rhc_ticker',!y);if(y){v();var da=q('fbTickerClosedEd');da&&h.hide(da);}}var x={init:function(y){s=y;var z=new n();if(s.enableSidebar)z.addSubscriptions(g.subscribe('sidebar/hide',t),g.subscribe('sidebar/show',u),g.subscribe('minisidebar/show',t),g.subscribe('LitestandClassicRHC/loaded',v),j.listen(window,'scroll',r(function(){var ba=i.scry(q('pagelet_rhc_ticker'),'.fbFeedTicker')[0],ca=ba&&o.getInstance(ba);ca&&ca.handleRemoveStory();})));if(!h.hasClass(document.documentElement,'sidebarMode')){t();}else if(s.enableSidebar)h.hasClass(document.documentElement,'miniSidebar')?t():u();var aa=function(){z.release();};g.subscribeOnce(k.NAVIGATION_BEGIN,aa);l.onLeave(aa);},initRHCTickerHider:function(y){j.listen(y,'click',this.hideRHCTicker);},showRHCTicker:function(){w(true);},hideRHCTicker:function(){w(false);}};e.exports=x;},null);