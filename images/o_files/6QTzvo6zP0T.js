/*!CK:2871462980!*//*1422428524,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["TlUj\/"]); }

__d("BrowseFacebarHighlighter",["copyProperties","CSS","csx","NodeHighlighter"],function(a,b,c,d,e,f,g,h,i,j){var k={};g(k,j,{getHighlightCandidates:function(){return ["._53ad"];},isDiscardNode:function(l){return h.hasClass(l,'DefaultText');},createSegmentedRegex:function(l){l=this.escapeAndAddBidirectionalCharsToTokens(l);return '(^|\\s|\\b)('+l.join('|')+')';}});e.exports=k;},null);
__d("getElementChildren",["toArray","isElementNode"],function(a,b,c,d,e,f,g,h){function i(j){return g(j.children||j.childNodes).filter(h);}e.exports=i;},null);
__d("HashtagParser",["URLMatcher","getHashtagRegex"],function(a,b,c,d,e,f,g,h){var i=100,j=30,k=/@\[([0-9]+):([0-9]+):((?:[^\\\]]*(?:\\.)*)*)\]/g;function l(da){var ea=y(da),fa=0,ga=0;return n(da).map(function(ha){while(fa<ea.length){var ia=ea[fa],ja=ia.offset-ga;if(ja<ha.offset){ga+=ia.token.length-ia.name.length;fa++;}else break;}return {marker:ha.marker,tag:ha.hashtag,rawOffset:ha.offset+ga,offset:ha.offset};});}function m(da){return o(da,t(da));}function n(da){var ea=aa(da);return o(ea,p(da,ea));}function o(da,ea){return r(da).slice(0,j).filter(function(fa){var ga=v(fa.offset,fa.hashtag.length,ea);return !ga&&fa.hashtag.length<=i;});}function p(da,ea){return u(s(da),t(ea));}var q=h();function r(da){var ea=[];da.replace(q,function(fa,ga,ha,ia,ja){ea.push({marker:ha,hashtag:ia,offset:ja+ga.length});});return ea;}function s(da){return ba(da).map(function(ea){return [ea.offset,ea.name.length];});}function t(da){var ea=[],fa,ga=0;while((fa=g.permissiveMatch(da))){var ha=da.indexOf(fa);ea.push([ga+ha,fa.length]);da=da.substring(ha+fa.length);ga+=ha+fa.length;}return ea;}function u(da,ea){var fa=[],ga=0,ha=0,ia=0;while(ga<da.length&&ha<ea.length)if(da[ga][0]>ea[ha][0]){fa[ia++]=ea[ha++];}else fa[ia++]=da[ga++];return fa.concat(da.slice(ga),ea.slice(ha));}function v(da,ea,fa){if(!fa)return false;var ga=x(fa,da);return w(da,ea,fa,ga)||w(da,ea,fa,ga+1);}function w(da,ea,fa,ga){if(!fa[ga])return false;var ha=fa[ga][0],ia=fa[ga][1];return !((da+ea-1<ha)||(da>ha+ia-1));}function x(da,ea){var fa=0,ga=da.length-1;while(fa<=ga){var ha=Math.floor((fa+ga)/2),ia=da[ha][0];if(ia==ea){return ha;}else if(ia<ea){fa=ha+1;}else ga=ha-1;}return ga;}function y(da){var ea=[];da.replace(k,function(fa,ga,ha,ia,ja){ea.push({token:fa,id:ga,type:ha,name:ia,offset:ja});});return ea;}function z(da){return da?da.replace(/\\([^\\])/g,'$1').replace(/\\\\/g,'\\'):null;}function aa(da){return da.replace(k,function(ea,fa,ga,ha,ia){return z(ha);});}function ba(da){var ea=0,fa=0;return y(da).map(function(ga){var ha=da.indexOf(ga.token,fa);fa=ha+1;ha-=ea;var ia=z(ga.name);ea+=ga.token.length-ia.length;if(ha>=0)return {id:ga.id,name:ia,type:ga.type,offset:ha};});}var ca={};ca.parse=l;ca.parseWithoutMentions=m;e.exports=ca;},null);
__d("StaticContainer.react",["React","onlyChild"],function(a,b,c,d,e,f,g,h){var i=g.createClass({displayName:"StaticContainer",shouldComponentUpdate:function(j){return !!j.shouldUpdate;},render:function(){return h(this.props.children);}});e.exports=i;},null);
__d("TypeaheadFacepileX.react",["React","joinClasses"],function(a,b,c,d,e,f,g,h){var i=g.createClass({displayName:"TypeaheadFacepile",renderPic:function(j,k){var l=("url("+this.props.photos[j]+")");return (g.createElement("span",{className:h('splitpic',k),key:j,style:{backgroundImage:l}}));},renderPics:function(){var j=this.props.size;if(j>=3){return [this.renderPic(0,'leftpic'),this.renderPic(1,'toppic'),this.renderPic(2,'bottompic')];}else return [this.renderPic(0,'leftpic'),this.renderPic(1)];},render:function(){return (g.createElement("span",g.__spread({},this.props,{className:h(this.props.className,"splitpics clearfix")}),this.renderPics()));}});e.exports=i;},null);
__d("FacebarResultStoreUtils",["FacebarGlobalOptions"],function(a,b,c,d,e,f,g){var h={getQueryFeatures:function(i){var j={};if(g.enableBootstrapRanking){if(i.raw_text)j.FEATURE_QUERY_LENGTH=i.raw_text.length;if(i.tokens){j.FEATURE_QUERY_TOKENS=i.tokens.length;j.FEATURE_QUERY_TOKEN_LENGTH_SUM=0;for(var k=0;k<i.tokens.length;k++)j.FEATURE_QUERY_TOKEN_LENGTH_SUM+=i.tokens[k].length;}}return j;},addFeatures:function(i,j,k,l,m,n){if(!i.features)return;i.features={FEATURE_QUERY_LENGTH:l.FEATURE_QUERY_LENGTH,FEATURE_QUERY_TOKENS:l.FEATURE_QUERY_TOKENS,FEATURE_QUERY_TOKEN_LENGTH_SUM:l.FEATURE_QUERY_TOKEN_LENGTH_SUM};i.features.FEATURE_IS_EXACT_NAME_MATCH=m;i.features.FEATURE_IS_STOP_WORD_MATCH=n;if(j&&j.length>0){var o=j.split(' ').length,p=0;for(var q=0;q<i.termMatches.length;++q)if(j.search(i.termMatches[q])>=0)p++;i.features.FEATURE_TITLE_TOKEN_MATCH_FRACTION=p/o;}if(k.tokens&&k.tokens.length>0){var r=j.search(k.tokens[0]);i.features.FEATURE_FIRST_TERM_MATCH_POSITION=r;i.features.FEATURE_FIRST_TERM_MATCH_TOKEN=j.substring(0,r+k.tokens[0].length).split(' ').length;i.termMatches.some(function(s){if(s.search(k.tokens[0])===0){i.features.FEATURE_FIRST_TERM_MATCH_TOKEN_FRACTION=k.tokens[0].length/s.length;return true;}return false;});i.features.FEATURE_IN_ORDER_MATCH=1;if(k.tokens.length>1){r=j.search(k.tokens[1]);i.features.FEATURE_SECOND_TERM_MATCH_POSITION=r;i.features.FEATURE_SECOND_TERM_MATCH_TOKEN=j.substring(0,r+k.tokens[1].length).split(' ').length;i.termMatches.some(function(s){if(s.search(k.tokens[1])===0){i.features.FEATURE_FIRST_TERM_MATCH_TOKEN_FRACTION=k.tokens[0].length/s.length;return true;}return false;});if(i.features.FEATURE_SECOND_TERM_MATCH_TOKEN<i.features.FEATURE_FIRST_TERM_MATCH_POSITION)i.features.FEATURE_IN_ORDER_MATCH=0;}}return i;},processEntityResult:function(i,j,k,l,m,n,o,p,q){var r={semantic:j.toString(),structure:[{type:'ent:'+i,text:k,uid:j}],type:i,cost:l,cache_id_length:0,features:[]};r.tuid=JSON.stringify({semantic:r.semantic,structure:r.structure});if(g.enableBootstrapRanking){r.termMatches=o[j.toString()];r=this.addFeatures(r,k.toLowerCase(),m,n,p,q);}return r;},getRawTextFromStructured:function(i){var j=i.map(function(k){return k.getText();});return j.join('');},getTextFromResult:function(i){var j=i.structure,k='';j.forEach(function(l){k+=l.text;});return k;}};e.exports=h;},null);
__d("HashtagSearchResultUtils",["FacebarResultStoreUtils","HashtagParser","HashtagSearchResultConfig","URI","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){var l={getHashtagFromQuery:function(m){var n=h.parse(m);if(n&&n.length===1&&n[0].offset===0)return n[0].tag;return false;},makeTypeaheadResult:function(m){var n="Hashtag";return {category:n,path:j('/hashtag/'+m).toString(),photo:i.image_url,rankType:null,replace_results:i.boost_result?true:false,scaled_score:1,score:0,text:'#'+m,type:'hashtag_exact',uid:'hashtag:'+m};},makeFacebarEntry:function(m){var n="Hashtag";return {category:n,path:j('/hashtag/'+m).toString(),photo:i.image_url,replace_results:i.boost_result?true:false,text:'#'+m,type:'hashtag_exact',uid:'hashtag:'+m};},makeFacebarResult:function(m){var n=g.processEntityResult('hashtag_exact','hashtag:'+m,'#'+m,i.hashtag_cost);n.parse={display:[{type:'ent:hashtag_exact',uid:'hashtag:'+m}],remTokens:[],suffix:''};n.tags={hashtag:'hashtag'};return n;}};e.exports=l;},null);
__d("FacebarURI",["FacebarJSConstants","FacebarSemanticQuery","URI","WWWBase"],function(a,b,c,d,e,f,g,h,i,j){var k={event:{ref:g.eventLinkRef},user:{fref:'ts'}},l={getSearchRawPrefix:function(){return 'search';},getSearchPath:function(){return '/'+this.getSearchRawPrefix()+'/';},getURI:function(m,n){var o=null,p=!n.song&&!n.isExtendedResult&&n.path;if(p){o=new i(p);if(n.type in k)o.addQueryData(k[n.type]);}else{var q=new h(m,n.semantic);if(q&&q.isImplemented())o=q.getURI();}return o&&l.getQualifiedURI(o);},getQualifiedURI:function(m){var n=new i(m);if(!n.getDomain()){var o=i(j.uri);n.setProtocol(o.getProtocol()).setDomain(o.getDomain()).setPort(o.getPort());}return n;}};e.exports=l;},null);
__d("FacebarKeywordSearchUtils",["FacebarURI","FacebarStructuredText","KeywordsSearchResultConfig","URI"],function(a,b,c,d,e,f,g,h,i,j){var k=function(m){var n=0;while(n<m.length)if(m[n].exactMatchKeyword){m.splice(n,1);}else ++n;},l={addExactMatch:function(m,n,o){if(!n.length)return;var p,q;for(var r=0,s=n.length;r<s;r++){q=n[r];if(q.type==='grammar')continue;p=true;break;}if(!p)return;var t=this.getExactMatchKeywordResult(m);if(!t)return;var u=Math.min(n.length,o),v=u;for(r=0;r<u;r++){q=n[r];if(q.exactMatchKeyword)return;if(q.cost>i.default_cost)--v;if(q.type!==i.result_type)continue;t.backendCost=q.cost+i.exact_match_cost_delta_from_best;t.cost=q.backendCost;k(n);n.splice(r,0,t);return;}k(n);n.splice(Math.min(Math.min(u,o-1),v),0,t);},getExactMatchKeywordResult:function(m){if(!m||m.is_empty||!m.raw_text)return;var n=m.raw_text.toLowerCase().replace(/\s{2,}/g,' ').trim(),o=i.query_prefix_blacklist;for(var p=0;p<o.length;p++)if(n.startsWith(o[p]))return;var q=this.makeFacebarEntry(n);return this._makeFacebarResult(q,m.cache_id.length);},makeFacebarEntry:function(m){var n=null,o=null;if(i.gsv2_results_page){o='str/'+encodeURIComponent(m)+'/'+i.gsv2_browse_edge;n=g.getQualifiedURI(j('/search/'+o));}else{n=g.getQualifiedURI(j(i.results_page_url).addQueryData('q',m));o=i.shortcut+'('+n.toString()+')';}return {semantic:o,text:m,type:i.result_type,resultsSetType:i.result_set_type,uid:i.uid_prefix+m,iconClass:i.icon_class,uri:n,structure:h.fromString(m)};},_makeFacebarResult:function(m,n){var o={semantic:m.semantic,structure:[{type:'grammar',text:m.text,uid:m.semantic}],type:m.type,resultsSetType:m.resultsSetType,cost:i.default_cost,cache_id_length:n,parse:{display:[{type:'grammar',uid:i.uid_prefix+m.text}],remTokens:[],suffix:''},iconClass:m.iconClass,exactMatchKeyword:true};o.tuid=JSON.stringify({semantic:o.semantic,structure:o.structure});return o;}};e.exports=l;},null);
__d("FacebarSemanticUtils",[],function(a,b,c,d,e,f){var g={_semanticForestConversionSub:function(h){var i=[],j=arguments.callee;h.forEach(function(k){if(typeof k==='string'){i.push(k);return;}var l=null;for(var m in k)l=m;if(!l)return;var n=l+'('+j(k[l])+')';i.push(n);});return i.join(',');},semanticForestConversion:function(h){if(!h)return '';var i=JSON.parse(h);return this._semanticForestConversionSub(i);},isEntity:function(h){if(!h)return false;return (/^\d+$/).test(h);}};e.exports=g;},null);
__d("FacebarResultStore",["FacebarGlobalOptions","FacebarJSConstants","FacebarKeywordSearchUtils","FacebarResultStoreUtils","FacebarSemanticUtils","FacebarStructuredText","KeywordsSearchResultConfig","TokenizeUtil","UnicodeMatch","concatMap","copyProperties","merge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(t,u,v,w){"use strict";this.facebarConfig=t;this.facebarConfig.grammar_stop_words_penalty=this.facebarConfig.grammar_stop_words_penalty||2;this.facebarConfig.grammar_stop_words=this.facebarConfig.grammar_stop_words||{};this.facebarConfig.options=w;this.tokenize=u;this.getEntry=v;this.typeaheadTypeMap=this.facebarConfig.mapped_types;this.facebarConfig.typeahead_types.forEach(function(x){this.typeaheadTypeMap[x]=x;},this);this.unicodeMatch=new o({prefix_hangul_conjoining_jamo:true});this.resetCaches();}s.prototype.transformStructured=function(t){"use strict";var u=[],v=[],w='',x='';t.forEach(function(aa,ba){if(aa.isType('text')){w+=aa.getText();x=(x==null)?null:x+aa.getText();}else{var ca=w.match(/\"/g);if(ca&&ca.length%2)w=w.replace(/\s+$/,'')+'"';if(w.length){Array.prototype.push.apply(u,this.tokenize(w));v.push(w);w='';}u.push(aa.toStruct());v.push({uid:String(aa.getUID()),type:this._getFBObjectType(aa.getTypePart(1)),text:aa.getText()});x=null;}},this);if(w.length){if(w[w.length-1]=='\'')w=w.substr(0,w.length-1);Array.prototype.push.apply(u,this.tokenize(w));v.push(w);if(w[w.length-1]==' ')u.push('');}var y=JSON.stringify(v),z=y.replace(/\]$/,'').replace(/\"$/,'');z=z.replace(/\s{2,}/g,' ');return {tokens:u,text_form:y,is_empty:!!y.match(/^\[(\"\s*\")?\]$/),raw_text:x,cache_id:z};};s.prototype.resetCaches=function(){"use strict";this.bootstrapCache={};this.queryCache={'':{tokens:[],results:[]}};};s.prototype.setNullState=function(t){"use strict";this.facebarConfig.null_state=t.map(this._extractStructure,this);};s.prototype.addEntryToNullState=function(t){"use strict";if(this.facebarConfig.null_state){var u=this.facebarConfig.entity_cost+t.grammar_costs['{'+t.type+'}'],v=j.processEntityResult(t.type,t.uid,t.text,u);this.facebarConfig.null_state.unshift(v);}};s.prototype.addRecentEntryToNullState=function(t){"use strict";if(!this.facebarConfig.null_state)return;for(var u=0;u<this.facebarConfig.null_state.length;u++){var v=this.facebarConfig.null_state[u];if(v.semantic===t.semantic){this.facebarConfig.null_state.splice(u,1);break;}}var w=r(t,{isRecent:true,isNullState:true,type:h.keywordType,structure:l.fromString(t.text),tuid:JSON.stringify({semantic:t.semantic,structure:t.structure})});if(t.icon_class)w.iconClass=t.icon_class;if(t.results_set_type)w.resultsSetType=t.results_set_type;this.facebarConfig.null_state.unshift(w);};s.prototype.clearRecentSearches=function(){"use strict";if(!this.facebarConfig.null_state)return;this.facebarConfig.null_state=this.facebarConfig.null_state.filter(function(t){return !t.isRecent;});};s.prototype.setSortFunction=function(t){"use strict";this._sortFunction=t;};s.prototype.addBootstrap=function(t){"use strict";var u=this.bootstrapCache;t.forEach(function(v){var w=this.getEntry(v);w.bootstrapped=true;var x=this.tokenize(w.textToIndex,true);if(w.tokens)Array.prototype.push.apply(x,w.tokens.split(' '));Array.prototype.push.apply(x,this.getExtraTokensToIndex(w));x.forEach(function(y){if(!u.hasOwnProperty(y))u[y]={};u[y][v]=true;});},this);};s.prototype.getExtraTokensToIndex=function(t){"use strict";var u=[];if(t.alias!=null)u.push(t.alias.toLowerCase());return u;};s.prototype.addNullStateToQueryCache=function(t,u){"use strict";this.saveResults(this.facebarConfig.null_state,t,true);if(g.includeInitialTypeNamedX)this.saveResults(u,t,true);};s.prototype.extendResult=function(t,u){"use strict";var v=t.cache_id.substr(u.cache_id_length);if((v.indexOf("\"")>=0||u.tokens.length===0)&&!u.isTypeNamedXBootstrap)return null;var w;if(!!u.isTypeNamedXBootstrap){if(t.raw_text!==null){w=u.ext_text+v;}else if(t.tokens.length!==0&&t.tokens[0].text){w=t.tokens[0].text;}else return null;}else if(u.tokens[u.tokens.length-1].length!==0){w=u.ext_text+v;}else w=u.ext_text+" "+v;if(w.length===0)return null;u.ext_node.text=w;u.parse.entTokens=[w];u.parse.suffix="";this._extractStructure(u);if(!this._punctRegexp)this._punctRegexp=new RegExp(n.getPunctuation(),'g');u.semantic=u.ext_semantic.replace('(ext_string)','('+w.replace(this._punctRegexp,"")+')');u.isExtendedResult=true;return u;};s.prototype.getResults=function(t,u){"use strict";if(t.tokens.length===0||(t.tokens.length==1&&t.tokens[0]===''))return {results:this.facebarConfig.null_state||[],null_state:true};var v=this._getBestQueryCache(t.cache_id),w=v.results.filter(function(ea){return !ea.isRecent;}),x={},y=this._getBootstrapMatchByType(t.tokens,x),z=this._addMatchingBootstrapResults(t,y[0]||{},x);if(g.limitBootstrapResult)z=z.slice(0,g.limitBootstrapResultNum);Array.prototype.push.apply(z,p(this._getResultsFromCache.bind(this,y,t),w));var aa={},ba=[],ca=false,da=0;z.sort(this._sortFunction);if(!g.graphSearchV2&&g.keywordSearchEnabled)i.addExactMatch(t,z,u);z.forEach(function(ea){var fa=l.fromStruct(ea.structure);if(fa.hasType('blank')){ba.push(ea);return;}ea.semantic=ea.semantic.toLowerCase();if(!ea.termMatches)ea.termMatches=x[ea.semantic];var ga=s.getUniqueSemantic(ea.semantic),ha=s.getUniqueSemantic(ea.alternateSemantic);if(!ga)return;var ia=aa[ga]||(ha&&aa[ha]);if(ia){if(ea.isJSBootstrapMatch){ia.isJSBootstrapMatch=true;ia.bootstrapCost=ea.bootstrapCost;}else if(ia.isJSBootstrapMatch&&ea.backendCost!==(void 0)&&ia.backendCost===(void 0))ia.backendCost=ea.backendCost;if(!!ea.tags)q(ia.tags,ea.tags);return;}if(ca&&ea.blankFilled)return;if(ea.type.indexOf('browse_type')>=0){da+=1;if(this.facebarConfig.maxGrammarResults!==(void 0)&&da>this.facebarConfig.maxGrammarResults)return;}ca=ca||!!ea.blankFilled;aa[ga]=ea;if(ha)aa[ha]=ea;ba.push(ea);},this);return {results:ba};};s.prototype.saveResults=function(t,u,v,w,x){"use strict";t=t.map(this._processBackendResult,this);var y=[],z={},aa={};t.forEach(function(ca){aa[ca.semantic]=true;ca.parse&&ca.parse.disambiguation&&ca.parse.disambiguation.forEach(function(da){var ea=k.semanticForestConversion(da);z[ea]=true;});});var ba=this._getBestQueryCache(u.cache_id);ba.results.forEach(function(ca){if(ca.type==='websuggestion')return;if(ca.exactMatchKeyword)return;if(ca.isExtendedResult)return;if(ca.semantic in z)return;var da=this._getDifferenceArrayTokens(ca.tokens,u.tokens),ea=this._getNumTokensMatching(da,ca);ea=this._tryMatchingFinalInsertedEntity(da,ea,ca);if((ea>0&&ea==da.length)||(ca.type==="shortcut"&&ca.termMatches.indexOf(u.tokens[u.tokens.length-1]))){ca.cacheOnlyResult=!aa[ca.semantic];y.push(ca);}},this);t.forEach(function(ca){ca.tokens=u.tokens;ca.cache_id_length=u.cache_id.length;if(!!ca.isTypeNamedXBootstrap)++ca.cache_id_length;y.push(ca);},this);if(x)Array.prototype.push.apply(y,x);if(this.queryCache[u.cache_id]===(void 0))this.queryCache[u.cache_id]={};q(this.queryCache[u.cache_id],{tokens:u.tokens,results:y,incomplete:v});q(this.queryCache[u.cache_id],w);};s.prototype.alreadyKnown=function(t){"use strict";return !!this.queryCache[t]&&!this.queryCache[t].incomplete;};s.prototype.stripBrackets=function(t){"use strict";return t.replace(/^[\[\{]/,'').replace(/[\]\}]$/,'');};s.prototype._extractStructure=function(t){"use strict";function u(x,y,z){return {type:x==='ent:extend_string'?'text':x,text:y,uid:z||null};}function v(x,y){x.split(' ').forEach(function(z){if(z!==''){if(y)t.chunks.push(t.structure.length);t.structure.push(u('text',z));}t.structure.push(u('text',' '));});t.structure.pop();}function w(x){if(t.structure.length!==0||h.nonGrammarTypes[t.type])return x;return x.charAt(0).toUpperCase()+x.substr(1);}t.structure=[];t.chunks=[];t.parse.display.forEach(function(x){if(typeof x==='string'){v(w(x),true);}else if(x.type==='ent:extend_string'){v(x.text,true);}else if(x.uid){var y=this.getEntry(x.uid,x.fetchType);t.chunks.push(t.structure.length);if(y==null)throw new Error('No entry found for uid \"'+x.uid+'\", type \"'+x.fetchType+'\" and piece text \"'+x.text+'\"');if(y.grammar_like){v(w(y.text),false);}else{var z=x.type;if(x.fetchType)z+=':'+x.fetchType;t.structure.push(u(z,y.text,x.uid));}}else if(x.type=='blank'){t.chunks.push(t.structure.length);t.structure.push(u(x.type,'...'));}},this);return t;};s.prototype._getDifferenceArrayTokens=function(t,u){"use strict";if(!t.length)return [''].concat(u);var v=t.length-1,w=t[v];if(w==='')w=t[--v];var x='';if(typeof(w)=='string'&&v<u.length)x=u[v].substr(w.length);if(x===''&&v+1<u.length&&u[v+1]==='')return [''];return [x].concat(u.slice(v+1));};s.prototype._processBackendResult=function(t){"use strict";if(t.isTypeNamedXBootstrap&&t.cache_id_length)return t;t.semantic=t.semantic.toString();t.backendCost=t.cost;this._extractStructure(t);if(t.type.match(/^\{.*\}$/))t.useExtendedIndex=true;if(t.alternateSemantic)t.alternateSemantic=t.alternateSemantic.toLowerCase().replace(/\[(\d*)\]/g,'$1');if(t.parse.extendable){var u=null;t.parse.display.forEach(function(aa){if(aa.type!=="ent:extend_string")return;u=aa;},this);if(!u||t.semantic.match(/\[.*\]/).length!==1){t.parse.extendable=false;}else{t.ext_node=u;t.ext_semantic=t.semantic.replace(/\[(.*)\]/g,'ext_string');t.ext_text=u.text;}}if(t.semantic.match(/\[\d*\]/)){var v=t.parse,w=v.pos;if(w===(void 0)){t.semantic=t.semantic.replace(/\[(\d*)\]/g,'$1');}else{var x=v.remTokens[v.remTokens.length-1];if(v.remTokens.length&&t.structure[t.chunks[x]]&&t.structure[t.chunks[x]].uid){w=v.remTokens[v.remTokens.length-1];t.completed=true;}var y=t.structure[t.chunks[w]].uid;if(y===null){t.semantic=t.semantic.replace(/\[(\d*)\]/g,'$1');}else{var z=new RegExp('\\['+y+'\\]','g');t.unsubstituted_semantic=t.semantic;t.semantic=t.semantic.replace(z,y);if(v&&v.disambiguation&&v.disambiguation.length>0){v.disambiguation=v.disambiguation.filter(function(aa){return aa.indexOf('['+y+']')!==-1;});v.unsubstituted_disambiguation=v.disambiguation.splice(0);v.disambiguation=v.disambiguation.map(function(aa){return aa.replace(z,y);});}}}}t.semantic=t.semantic.replace(/\[(.*)\]/g,'$1');t.tuid=JSON.stringify({semantic:t.semantic,structure:t.structure});return t;};s.prototype._sortFunction=function(t,u){"use strict";return (t.cost||0)-(u.cost||0);};s.prototype._getResultsFromCache=function(t,u,v){"use strict";var w=u.tokens,x=this._getDifferenceArrayTokens(v.tokens,w),y=[],z=this._getNumTokensMatching(x,v),aa=this._tryMatchingFinalInsertedEntity(x,z,v);if(v.parse.extendable||v.isExtendedResult){var ba=this.extendResult(u,v);if(ba)y.push(ba);if(v.isExtendedResult)return y;}if(aa>0&&aa==x.length&&!(v.type===m.result_type&&x.length===1&&x[0]==='"'))y.push(v);if(v.type==="shortcut"&&v.termMatches.indexOf(u.tokens[w-1]))y.push(v);return y;};s.prototype._addMatchingBootstrapResults=function(t,u,v){"use strict";var w=t.tokens;return p(function(x){var y=u[x];if(y===(void 0))return [];var z=[],aa=j.getQueryFeatures(t);y.forEach(function(ba){var ca=this.getEntry(ba,x);if(!this._isTitleTermMatch(w,ca)&&!this._isAliasMatch(t.raw_text,ca))return;var da=(this._isExactNameMatch(w,ca)||this._isAliasMatch(t.raw_text,ca)),ea=da?0:this.facebarConfig.non_title_term_match_penalty,fa=this._isNonGrammarTermMatch(w,ca),ga=ca.grammar_costs['{'+x+'}']+ea+this.facebarConfig.entity_cost+this.facebarConfig.grammar_stop_words_penalty*!fa,ha=j.processEntityResult(x,ba,ca.text,ga,t,aa,v,da,!fa);ha.bootstrapCost=ga;ha.isJSBootstrapMatch=true;z.push(ha);},this);return z;}.bind(this),this.facebarConfig.bootstrap_types);};s.prototype._isTitleTermMatch=function(t,u){"use strict";var v=t[0]||{};if(typeof(v)=='object')return false;var w=u.titleToIndex;return t.length===1?this._isTokenizePrefixMatch(v,w):n.isExactMatch(v,w);};s.prototype._isExactNameMatch=function(t,u){"use strict";var v=t[0]||{};if(typeof(v)=='object')return false;var w=u.text;for(var x=0;x<t.length-1;++x)if(t[x]!==''&&!n.isExactMatch(t[x],w))return false;return t.length>0&&this._isTokenizePrefixMatch(t[t.length-1],w);};s.prototype._isAliasMatch=function(t,u){"use strict";return (u.alias!=null&&t!=null&&n.isExactMatch(u.alias,t));};s.prototype._isNonGrammarTermMatch=function(t,u){"use strict";var v=n.parse(u.titleToIndex.toLowerCase()),w=v.tokens.filter(function(z){return z!==''&&!this.facebarConfig.grammar_stop_words[z];},this);w=w.join(' ');for(var x=0;x<t.length;++x){if(typeof(t[x])=='object')return true;var y=x===t.length-1?this._isTokenizePrefixMatch(t[x],w):n.isQueryMatch(t[x],w);if(y)return true;}return false;};s.prototype._getBootstrapMatchByType=function(t,u){"use strict";if(t.length===0)return [];var v=t.map(function(){return {};}),w=(t[t.length-1]===''),x={},y,z=(w?t.length-1:t.length),aa=t[z-1];if(z&&aa.uid){this._pushBootstrapEntryAtPosition(v,z-1,aa.uid);return v;}for(var ba in this.bootstrapCache)if(z&&this.unicodeMatch.prefixMatch(ba,aa)&&(!w||ba===aa))for(y in this.bootstrapCache[ba])if(!x[y]){x[y]=1;this._addMatchedTerm(y,ba,u);this._pushBootstrapEntryAtPosition(v,z-1,y);}for(var ca=z-2;ca>=0;ca--){if(typeof(t[ca])=='object')break;if(t[ca].length&&t[ca][0]=='"')break;for(y in this.bootstrapCache[t[ca]]){if(!x[y])x[y]=0;if(x[y]+ca==z-1){++x[y];this._addMatchedTerm(y,t[ca],u);this._pushBootstrapEntryAtPosition(v,ca,y);}}}return v;};s.prototype._addMatchedTerm=function(t,u,v){"use strict";(v[t]=v[t]||[]).push(u);return v;};s.prototype._pushBootstrapEntryAtPosition=function(t,u,v){"use strict";var w=this.getEntry(v);if(!w)return;for(var x in w.grammar_costs){var y=this.stripBrackets(x);if(t[u][y]===(void 0))t[u][y]=[];t[u][y].push(v);}};s.prototype._getNumTokensMatching=function(t,u){"use strict";var v=0,w=u.parse,x=t.length,y=null,z=null;if(w.pos!==(void 0)){var aa=u.structure[u.chunks[w.pos]];if(aa){y=aa.uid;z=aa.type.split(':')[2];}}u.outputTokensUsed=[];u.termMatches=[];if(y){v=this._prefixMatchEntity(t,w,y,u.outputTokensUsed,z,!!u.useExtendedIndex,u.termMatches);if(v===0||v===x)return v;}else if(w.suffix&&x==1&&w.suffix.indexOf(t[0])===0){return x;}else if(w.suffix==t[0]){++v;}else return 0;var ba=[];w.remTokens=w.remTokens||[];for(var ca=0;ca<w.remTokens.length;ca++){if(typeof(t[v])!='string'||u.chunks.length<=w.remTokens[ca]||u.structure.length<=u.chunks[w.remTokens[ca]]||u.structure[u.chunks[w.remTokens[ca]]].uid)break;var da=u.structure[u.chunks[w.remTokens[ca]]].text;ba.push(da.toLowerCase());}v=this._greedyMatchText(ba,t,v,w.remTokens,u.outputTokensUsed,u.isNullState);if(v==x-1&&t[v]==='')return x;return v;};s.prototype._prefixMatchEntity=function(t,u,v,w,x,y,z){"use strict";u.entTokens=u.entTokens||[];if(u.entTokens.length===0){if(t[0]!=='')return 0;if(u.possessive&&t.length>1&&t[1]=='\'s'){w.push([u.pos+1]);return 2;}else return 1;}var aa=false,ba=this.getEntry(v,x);if(typeof(x)!=='undefined'&&x!==ba.fetchType)return 0;var ca=this.tokenize(y?ba.textToIndex:ba.text,true),da=[];for(var ea=0;ea<t.length+u.entTokens.length-1;ea++)if(ea<u.entTokens.length-1){da.push(u.entTokens[ea]);}else if(ea==u.entTokens.length-1){da.push(u.entTokens[ea]+t[0]);}else da.push(t[ea-u.entTokens.length+1]);var fa=-u.entTokens.length+1;for(var ga=0;ga<da.length;++ga){var ha=da[ga];if(typeof(ha)!='string')break;if(ha===''){fa++;continue;}var ia=false;for(var ja=0;ja<ca.length;ja++)if(ca[ja]==ha||(ga===da.length-1&&ca[ja].indexOf(ha)===0)){if(z)z.push(ca[ja]);ca[ja]='';ia=true;++fa;break;}if(ia)continue;if(!u.possessive||ha.length<=2||ha.substr(ha.length-2)!='\'s')break;var ka=ha.substr(0,ha.length-2);for(ja=0;ja<ca.length;ja++)if(ca[ja]==ka){++fa;if(w)aa=true;break;}break;}if(fa>0){if(aa)w.push([u.pos+1]);return fa;}if(w===(void 0))return 0;var la=t[0],ma=la;if(u.possessive&&la.length>=2&&la.substr(la.length-2)=='\'s')ma=la.substr(0,la.length-2);u.suffix=u.suffix||'';if((t.length==1&&u.suffix.indexOf(la)===0)||u.suffix==ma||u.suffix==la){if(ma!=la&&u.suffix==ma)w.push([u.pos+1]);return 1;}return 0;};s.prototype._tryMatchingFinalInsertedEntity=function(t,u,v){"use strict";if(!v.completed||u<0)return u;var w=v.parse,x=w.remTokens[w.remTokens.length-1],y=v.structure[v.chunks[x]],z=this.getEntry(y.uid,y.type),aa=this.tokenize(z.text,true);u=this._greedyMatchText(aa,t,u);if(u==t.length-1&&t[u]==='')return t.length;return u;};s.prototype._greedyMatchText=function(t,u,v,w,x,y){"use strict";for(var z=0;z<t.length;z++){var aa=t[z];if(aa==u[v]){if(x!==(void 0))x.push(w[z]);++v;continue;}if(v===u.length-1&&aa.indexOf(u[v])===0){if(x!==(void 0))if(aa==u[v]){x.push([w[z]]);}else x.push([w[z],u[v].length]);return u.length;}if(y)break;}return v;};s.prototype._getBestQueryCache=function(t){"use strict";for(var u=t.length;u>=0;u--){var v=this.queryCache[t.slice(0,u)];if(v)return v;}};s.prototype._getFBObjectType=function(t){"use strict";if(this.typeaheadTypeMap[t]){return this.typeaheadTypeMap[t];}else return 'page';};s.prototype._isTokenizePrefixMatch=function(t,u){"use strict";return n.isPrefixMatch(this.unicodeMatch.prefixMatchPrepare(t),this.unicodeMatch.prefixMatchPrepare(u));};s.EPSILON=1e-05;s.getUniqueSemantic=function(t){if(!t)return;var u=[],v=[],w=[];t='('+t+')';var x=t,y=false;t.replace(/[\(\),]/g,function(z,aa){var ba;switch(z){case ',':var ca=w.length-1;ba=x.substr(w[ca],aa-w[ca]);u[ca].push(ba);w[ca]=aa+1;break;case '(':w.push(aa+1);u.push([]);v.push(aa+1);break;case ')':if(w.length===0)throw t+' is not a valid semantic string';var da=w.pop();ba=x.substr(da,aa-da);ba=decodeURI(ba.replace(/%/g,'%25').replace(/\s/g,'+').trim());var ea=u.pop();ea.push(ba);var fa=ea.sort();for(var ga=1;ga<fa.length;ga++)if(fa[ga]==fa[ga-1])y=true;var ha=fa.join(',');x=x.substr(0,v.pop())+ha+x.substr(aa);break;}return z;});if(y)return '';return x.replace(/\((.*)\)/,'$1');};e.exports=s;},null);
__d("FacebarTimerUtils",[],function(a,b,c,d,e,f){var g={getTimestamp:function(){return Date.now();}};e.exports=g;},null);
__d("FacebarTokenizer",["TokenizeUtil"],function(a,b,c,d,e,f,g){var h="[^\"]",i=["\\s's","'s","\""+h+"*\"?"],j=[[/\s+$/,''],[/\"\s+/,'"'],[/\s+\"/,'"'],[/\"\"/,''],[/^\"$/,''],[/\s+/,' ']],k={tokenize:function(l,m){var n=[],o=0;l=l.replace(/\s/g,' ').toLowerCase();l.replace(new RegExp(i.join('|'),'g'),function(q,r){if(r>o){var s=l.substr(o,r-o);Array.prototype.push.apply(n,g.parse(s).tokens.slice(0));}var t=q;for(var u=0;u<j.length;u++){var v=j[u];t=t.replace(v[0],v[1]);}if(n.length&&t=='\'s'){n[n.length-1]+=t;}else if(t!=='')n.push(t);if(m)Array.prototype.push.apply(n,g.parse(q).tokens);o=r+q.length;});if(o<l.length){var p=l.substr(o,l.length-o);Array.prototype.push.apply(n,g.parse(p).tokens.slice(0));}return n;}};e.exports=k;},null);
__d("FacebarTypeaheadTypeNamedX",[],function(a,b,c,d,e,f){var g={browse_type_user:'user',browse_type_page:'page',browse_type_place:'place',browse_type_group:'group',browse_type_application:'app'},h=1,i=2;function j(){"use strict";}j.addTypeNamedX=function(k,l,m,n){"use strict";var o=new j(),p=[],q=[];k.forEach(function(v){delete v.tags.hiddenSeeMore;if(v.isSeeMore){p.push(v);}else q.push(v);});if(!n.showTypeNamedX){p.forEach(function(v){v.tags.hiddenSeeMore=true;});return q;}var r=o.buildTypeNamedXBuckets(q,p,m,n),s=r[0],t=r[1];s.forEach(function(v){v.tags.displayedSeeMore=true;});var u=o.replaceResults(q,l,s);Array.prototype.push.apply(u,t);u.forEach(function(v){v.tags.hiddenSeeMore=true;});return q;};j.prototype.buildTypeNamedXBuckets=function(k,l,m,n){"use strict";var o={};n=n||{};k.forEach(function(s,t){var u=s.render_type||s.type;if(o[u]===(void 0))o[u]={index:t,matchCount:0};if(!n.alwaysDisplayTypeNamedX&&s.text.toLowerCase().indexOf(m.toLowerCase())<0)return;o[u].matchCount++;});var p=[],q=[];l.forEach(function(s){var t=g[s.results_set_type];if(o[t]!==(void 0)&&o[t].matchCount>=h){p.push([s,o[t].index]);}else q.push(s);});p.sort(function(s,t){return s[1]-t[1];});var r=p.map(function(s){return s[0];});Array.prototype.push.apply(q,r.slice(i));r.length=Math.min(r.length,i);return [r,q];};j.prototype.replaceResults=function(k,l,m){"use strict";var n=[],o=Math.min(0,k.length-l)+m.length;for(var p=0;p<o;++p){var q=-1;for(var r=0;r<Math.min(l-p,k.length);++r){var s=k[r];if(!s.exactMatchKeyword&&s.type!=='websuggestion')q=r;}if(q>=0){n.push(k[q]);k.splice(q,1);}}Array.prototype.unshift.apply(k,m);return n;};e.exports=j;},null);
__d("FacebarTypeaheadL2Terms",["FacebarJSConstants"],function(a,b,c,d,e,f,g){var h=3,i={addL2Terms:function(j,k,l,m){if(!m.suggestBackendL2Terms)return j;var n=[],o=[];j.forEach(function(q){if(q.exactMatchKeyword){q.tags.l2_suggestion=true;n.push(q);}else if(q.isKeywordL2){q.tags.l2_suggestion=true;q.type='l2suggestion';n.push(q);}else if(q.type!=='keywords')o.push(q);});var p=0;return o.map(function(q){if(g.entityTypes[q.type])if(p<h){p++;}else if(n.length)return n.pop();return q;});}};e.exports=i;},null);
__d("ResultsBucketizer",["copyProperties"],function(a,b,c,d,e,f,g){function h(i,j){"use strict";this.$ResultsBucketizer0=i;this.$ResultsBucketizer1=j;}h.trimResults=function(i,j,k){"use strict";var l=[];i.forEach(function(m,n){if(m.indexBeforeBuckets>j)l.push({index:n,originalIndex:m.indexBeforeBuckets});});l.sort(function(m,n){return m.originalIndex-n.originalIndex;}).slice(k).sort(function(m,n){return n.index-m.index;}).forEach(function(m){i.splice(m.index,1);});};h.mergeBuckets=function(i,j){"use strict";var k=[];for(var l in j)if(!j[l].rule.hidden&&(!j[l].rule.xor||!j[j[l].rule.xor]))k.push(j[l]);k.sort(function(m,n){var o=(m.rule.position||0)-(n.rule.position||0);if(o!==0)return o;return m.results[0].indexBeforeBuckets-n.results[0].indexBeforeBuckets;});i.length=0;k.forEach(function(m,n){if(m.rule.maxPromotions!=null&&n<k.length-1)h.trimResults(m.results,k[n+1].results[0].indexBeforeBuckets,m.rule.maxPromotions);Array.prototype.push.apply(i,m.results);}.bind(this));};h.prototype.$ResultsBucketizer2=function(i,j){"use strict";if(j.propertyName==null)return j.bucketName||'default';var k=this.$ResultsBucketizer1(i,j.propertyName);if(k==null||(j.propertyValue!=null&&(''+k)!==j.propertyValue))return false;return j.bucketName||(j.propertyName+'.'+k);};h.prototype.$ResultsBucketizer3=function(i,j){"use strict";var k={};i.forEach(function(l,m){j.some(function(n){var o=this.$ResultsBucketizer2(l,n);if(o===false)return false;if(k[o]==null)k[o]={results:[],rule:n};if(!!n.maxResults&&k[o].results.length>=n.maxResults)return true;l.bucketLineage.push({bucketName:o,bucketIndex:k[o].results.length});k[o].results.push(l);return true;}.bind(this));}.bind(this));return k;};h.prototype.$ResultsBucketizer4=function(i,j){"use strict";var k=this.$ResultsBucketizer0[j];if(!k)return {};var l=this.$ResultsBucketizer3(i,k);for(var m in l){var n=l[m].rule.subBucketRules;if(!!n)this.$ResultsBucketizer4(l[m].results,n);}h.mergeBuckets(i,l);return l;};h.prototype.$ResultsBucketizer5=function(i,j,k){"use strict";if(j.length<=k)return j.slice();var l=j.map(function(n){return n.indexBeforeBuckets;}),m=l.sort(function(n,o){return n-o;})[k];return j.filter(function(n){return n.indexBeforeBuckets<m;});};h.prototype.bucketize=function(i,j,k){"use strict";i.forEach(function(l,m){l.bucketLineage=[];l.indexBeforeBuckets=m;});k=k||{};g(k,this.$ResultsBucketizer4(i,'main'));return this.$ResultsBucketizer5(k,i,j);};e.exports=h;},null);
__d("SearchSingleState",["fbt"],function(a,b,c,d,e,f,g){function h(j,k,l,m){return {classNames:'grammar',groupIndex:0,indexInGroup:j,path:k,text:l,type:'grammar',uid:m};}var i={getSuggestions:function(j,k,l){if(l==='ent:user'){return this.getSuggestionsForUser(j,k);}else if(l==='ent:page'){return this.getSuggestionsForPage(j,k);}else if(l==='ent:app'){return this.getSuggestionsForApp(j,k);}else if(l==='ent:group')return this.getSuggestionsForGroup(j,k);},getSuggestionsForUser:function(j,k){return [h(0,'/search/'+j+'/photos-of',g._("photos of {full name}",[g.param("full name",k)]),'photos_of_user'),h(1,'/search/'+j+'/friends',g._("friends of {full name}",[g.param("full name",k)]),'friends_of_user'),h(2,'/search/'+j+'/pages-liked',g._("favorite pages of {full name}",[g.param("full name",k)]),'pages_liked_user'),h(3,'/search/str/'+k+'/users-named',g._("find all people named \"{full name}\"",[g.param("full name",k)]),'people_named_text')];},getSuggestionsForPage:function(j,k){return [h(0,'/search/'+j+'/photos-of',g._("photos of {name of page}",[g.param("name of page",k)]),'photos_of_page'),h(1,'/search/'+j+'/likers',g._("people who like {name of page}",[g.param("name of page",k)]),'page_likers'),h(2,'/search/str/'+k+'/pages-named',g._("find all pages named \"{name of page}\"",[g.param("name of page",k)]),'pages_named_text')];},getSuggestionsForGroup:function(j,k){return [h(0,'/search/'+j+'/members',g._("{name of group} members",[g.param("name of group",k)]),'members_of_group'),h(1,'/search/'+j+'/photos-in',g._("photos in {name of groups}",[g.param("name of groups",k)]),'photos_in_group'),h(2,'/search/'+j+'/creators',g._("{name of group} creators",[g.param("name of group",k)]),'creators_of_group'),h(3,'/search/'+j+'/admins',g._("{name of group} administrators",[g.param("name of group",k)]),'admins_of_group')];},getSuggestionsForApp:function(j,k){return [h(0,'/search/'+j+'/apps-similar-to',g._("apps similar to {name of app}",[g.param("name of app",k)]),'similar_apps'),h(1,'/search/'+j+'/app-users',g._("people who use {name of app}",[g.param("name of app",k)]),'app_users'),h(2,'/search/str/'+k+'/pages-named',g._("find all apps named \"{name of page}\"",[g.param("name of page",k)]),'apps_named_text')];}};e.exports=i;},null);
__d("SearchDataSource",["Event","Arbiter","AsyncResponse","DataSource","HashtagSearchResultUtils","copyProperties","createArrayFromMixed","PageTransitions","SearchSingleState","UnicodeCJK"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q='/typeahead/search/facebar/nullstate/';for(var r in j)if(j.hasOwnProperty(r))t[r]=j[r];var s=j===null?null:j.prototype;t.prototype=Object.create(s);t.prototype.constructor=t;t.__superConstructor__=j;function t(u){"use strict";this._token=u.token||'';this._lazyonload=u.lazyonload===false?false:true;this._extraTypes=u.extraTypes;this._buckets=u.buckets;this._noMultiFetch=u.noMultiFetch||false;this._nullStateConfig=u.nullStateConfig||{};var v=u.maxResults||8;j.call(this,u);this._numResults={min:3,max:v};this.recordingRoute=u.recordingRoute||'non_banzai';this._enabledHashtag=u.enabledHashtag||false;this.logBackendQueriesWindow=u.logBackendQueriesWindow||25;this._genTime=u.genTime;this.cacheUnicodeMatch.setConfigs({prefix_hangul_conjoining_jamo:true,prefix_kana_drop_trailing_latin:u.cjkDropLatinInCjTokens,prefix_kana_hiragana_to_katakana:u.cjkUiCacheHiraganaToKatakana});this.backendUnicodeMatch.setConfigs({prefix_kana_drop_trailing_latin:u.cjkDropLatinInCjTokens});}t.prototype.init=function(){"use strict";s.init.call(this);this._leanPayload=null;this._bootstrapRequestsPending=0;this._criticalOnly=true;this._updateMaxResults();g.listen(window,'resize',this._updateMaxResults.bind(this));if(this._nullStateConfig.singleState){h.subscribe('page_transition',this.handlePageTransition.bind(this));h.subscribe('search/updateNullState',this.updateNullState.bind(this));}if(this._nullStateConfig.recent)h.subscribe('search/refreshRecentSearchesNullstate',this.refreshRecentSearches.bind(this));};t.prototype.refreshRecentSearches=function(){"use strict";this.nullStateData=null;};t.prototype.handlePageTransition=function(){"use strict";this.nullStateParams={};};t.prototype.updateNullState=function(event,u){"use strict";this.nullStateParams=u;this.fetchNullState();};t.prototype.fetchNullState=function(u){"use strict";if(!this._nullStateConfig.hasNullState)return;var v=null;if(this.nullStateParams&&this.nullStateParams.uid){this.nullStateParams.query=u||'';v=this._fetchDataForSingleState();}else v=this._fetchDataForNullState();if(v)this.inform('respond',{value:this.nullStateParams?this.nullStateParams.query:'',results:v,isAsync:false,nullState:true});};t.prototype._fetchDataForSingleState=function(){"use strict";if(this.nullStateDataWithProfile&&this.nullStateParams.uid===this.nullStateDataWithProfile.profileID)return this.nullStateDataWithProfile.data;if(this.nullStateParams.type==='ent:app'||this.nullStateParams.type==='ent:group'||this.nullStateParams.type==='ent:page'){this.fetch(q,{profile_id:this.nullStateParams.uid,ent_type:this.nullStateParams.type},{singleState:true});this.nullStateDataWithProfile={profileID:this.nullStateParams.uid};return;}var u=o.getSuggestions(this.nullStateParams.uid,this.nullStateParams.text,this.nullStateParams.type);if(!u)return this._fetchDataForNullState();this.nullStateDataWithProfile={data:u,profileID:this.nullStateParams.uid};return u;};t.prototype._shouldRefreshNullState=function(){"use strict";if(!this._nullStateConfig.recent)return false;var u=window.location.href;if(!u)return false;if(u.indexOf('allactivity')&&u.indexOf('log_filter=search'))return true;return false;};t.prototype._fetchDataForNullState=function(){"use strict";if(this.nullStateData&&!this._shouldRefreshNullState())return this.nullStateData;this.fetch(q,{value:""},{nullState:true,value:''});return null;};t.prototype.dirty=function(){"use strict";s.dirty.call(this);this._fetchOnUseRequests=[];};t.prototype.asyncErrorHandler=function(u){"use strict";if(window.Dialog&&window.Dialog.getCurrent()==null&&u.getError()==1400003)i.verboseErrorHandler(u);};t.prototype.fetch=function(u,v,w){"use strict";w=w||{};w.fetch_start=Date.now();var x=n.getMostRecentURI().path;v=l(v,{path:x});s.fetch.call(this,u,v,w);};t.prototype.fetchHandler=function(u,v){"use strict";if(v.nullState){this.nullStateData=u.getPayload().entries;this.inform('respond',{value:'',results:u.getPayload().entries,isAsync:true,nullState:true});return;}if(v.singleState){this.nullStateDataWithProfile.data=u.getPayload().entries;this.inform('respond',{results:u.getPayload().entries,isAsync:true,value:this.nullStateParams?this.nullStateParams.query:'',nullState:true});return;}var w=u.getPayload(),x=l({fetch_end:Date.now()},v),y=x.value?h.BEHAVIOR_EVENT:h.BEHAVIOR_PERSISTENT;this.inform('beginFetchHandler',{response:u});if(v.type=='lean'){this._leanPayload=w;this._processLean();}else{if(w.coeff2_ts)x.coeff2_ts=w.coeff2_ts;s.fetchHandler.call(this,u,v);if(v.bootstrap&&!u.getRequest().getData().no_cache)x.browserCacheHit=(w.timestamp<this._genTime);if(v.bootstrap&&!w.no_data&&this._bootstrapRequestsPending>0){v.bootstrap=false;--this._bootstrapRequestsPending;!this._bootstrapRequestsPending&&this._bootstrapPostProcess();}if(w.no_data||w.stale||w.token!==this._token){var z=l({},u.getRequest().getData());if(z.lazy){delete z.lazy;z.token=this._token;this._fetchOnUse(z,v);}}}this.inform('endpointStats',x,y);if(v&&!!v.value)this.inform('completeFetch',{response:u,stats:x});};t.prototype.respond=function(u,v,w){"use strict";this.inform('respondValidUids',v);this.inform('reorderResults',v);var x=this.buildData(v,u);x.forEach(function(y,z){y.origIndex=z;});this.inform('respond',{value:u,results:x,isAsync:!!w});return x;};t.prototype.buildData=function(u,v){"use strict";if(!u||u.length===0)return [];var w=u.map(this.getEntry,this);w.length=Math.min(w.length,this._maxResults);return w;};t.prototype.fetchLean=function(){"use strict";this._fetchLean();};t.prototype._isQueryTooShort=function(u){"use strict";return u.length<this._minQueryLength&&!p.hasIdeoOrSyll(u);};t.prototype.shouldFetchMoreResults=function(u){"use strict";return u.length<this._maxResults;};t.prototype._bootstrapPostProcess=function(){"use strict";var u={time:Date.now()};this.inform('bootstrapped',u,h.BEHAVIOR_PERSISTENT);this._processLean();};t.prototype._processLean=function(){"use strict";if(this._leanPayload){var u,v=this._leanPayload.entries;for(var w in v){u=this.getEntry(w);u&&(u.index=v[w]);}this.setExclusions(this._leanPayload.blocked);this._leanPayload=null;}};t.prototype._updateMaxResults=function(){"use strict";var u=window.innerHeight||document.documentElement.clientHeight;this.setMaxResults(Math.max(this._numResults.min,Math.min(this._numResults.max,Math.ceil(2+((u-370)/56)))));};t.prototype._bootstrapFetch=function(u,v){"use strict";var w=l(v,this.bootstrapData);if(this._criticalOnly&&this._lazyonload)w.lazy=1;this.fetch(this.bootstrapEndpoint,w,{bootstrap:true,type:u});++this._bootstrapRequestsPending;};t.prototype._fetchOnUse=function(u,v){"use strict";for(var w in this.bootstrapData)!u.hasOwnProperty(w)&&(u[w]=this.bootstrapData[w]);if(this._criticalOnly){this._fetchOnUseRequests.push({args:u,ctx:v});}else this.fetch(this.bootstrapEndpoint,u,v);};t.prototype._fetchLean=function(){"use strict";var u={no_cache:1};u.options=m(u.options);u.options.push('lean');this._fetchOnUse(u,{type:'lean'});};t.prototype.bootstrap=function(u){"use strict";if(!u){this._criticalOnly=false;this._flushFetchOnUseRequests();}if(this._bootstrapped)return;var v={filter:['event'],no_cache:1};this._fetchOnUse(v,{type:'event'});var w=['app','page','group','friendlist'];w=w.concat(this._extraTypes||[]);if(this._noMultiFetch){w.push('user');this._bootstrapFetch('user',{filter:w});}else{this._bootstrapFetch('other',{filter:w});if(this._buckets){for(var x=0;x<this._buckets.length;++x){var y={filter:['user'],buckets:this._buckets[x]};this._bootstrapFetch('user',y);}}else this._bootstrapFetch('user',{filter:['user']});}this._fetchLean();this._bootstrapped=true;};t.prototype._flushFetchOnUseRequests=function(){"use strict";var u=this._fetchOnUseRequests.length;for(var v=0;v<u;++v){var w=this._fetchOnUseRequests[v];this.fetch(this.bootstrapEndpoint,w.args,w.ctx);}if(u>0)this.inform('extra_bootstrap',{time:Date.now()},h.BEHAVIOR_PERSISTENT);this._fetchOnUseRequests=[];};t.prototype.onLoad=function(u,v){"use strict";this.inform('onload',{time:Date.now()},h.BEHAVIOR_PERSISTENT);if(u)setTimeout(this.bootstrap.bind(this,v),0);};t.prototype.mergeUids=function(u,v,w,x){"use strict";var y=this.getDynamicHashtagResult(x);if(x&&y&&v.indexOf(y)<=0)v.unshift(y);var z=w[0]?this.getEntry(w[0]):null,aa=v[0]?this.getEntry(v[0]):null,ba=(z&&z.replace_results)?z:null;ba=(!ba&&aa&&aa.replace_results)?aa:ba;var ca=s.mergeUids.call(this,u,v,w,x);if(ba){this.inform('backend_topreplace',{});return this.deduplicateByKey([ba.uid].concat(ca));}return ca;};t.prototype.getTextToIndexFromFields=function(u,v){"use strict";var w=[],x=u.tokenVersion==="v2";for(var y=0;y<v.length;++y){if(x&&(v[y]==="text"||v[y]==="alias"))continue;var z=u[v[y]];if(z)w.push(z.join?z.join(' '):z);}return w.join(' ');};t.prototype.getDynamicHashtagResult=function(u){"use strict";if(!u||!this._enabledHashtag)return;var v=k.getHashtagFromQuery(u);if(!v)return;var w='hashtag:'+v,x=this.getEntry(w);if(!x)this.processEntries([k.makeTypeaheadResult(v)],u);return w;};e.exports=t;},null);
__d("FacebarDataSource",["Arbiter","AsyncRequest","FacebarGlobalOptions","FacebarJSConstants","FacebarResultStore","FacebarResultStoreUtils","FacebarStructuredText","FacebarTimerUtils","FacebarSemanticUtils","FacebarTokenizer","FacebarTypeaheadTypeNamedX","FacebarTypeNamedXBootstrap","FacebarTypeaheadL2Terms","FacebarTypeNamedXTokenOptions","FacebarURI","ResultsBucketizer","ResultsBucketizerConfig","SearchDataSource","Vector","ViewportBounds","copyProperties","throttle","invariant","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da){for(var ea in x)if(x.hasOwnProperty(ea))ga[ea]=x[ea];var fa=x===null?null:x.prototype;ga.prototype=Object.create(fa);ga.prototype.constructor=ga;ga.__superConstructor__=x;function ga(ha){"use strict";x.call(this,ha);this._fetched_null_state=null;this._initialQueryData=null;this._curQueryId=-1;this._maxRemoteQueryId=-1;this._single_state=true;this._waitingQueries=0;this.mixGrammarAndEntity=ha.mixGrammarAndEntity!==(void 0)?ha.mixGrammarAndEntity:true;this.grammarVersion=ha.grammarVersion||'';if(!ha.grammarOptions)ha.grammarOptions={};this.recordingRoute=ha.grammarOptions.recordingRoute||'banzai_vital';this._maxGrammarResults=ha.grammarOptions.maxGrammarResults;this.nullStateEndpoint=ha.nullStateEndpoint||'/ajax/browse/null_state.php';this.setNullStateData(ha.nullStateData||{},true);this._minQueryLength=ha.minQueryLength||-1;this._fixProcessLean=ha.grammarOptions.fixProcessLean||false;this.throttleExecuteQuery();this.throttleSendRemoteQuery();this.throttleRenderResults();this.resultStoreOptions=ha.grammarOptions||{};this.resultStoreOptions.useNewExactNameMatch=(ha.grammarOptions.useNewExactNameMatch==="true");this.defaultQuery=null;this._bypassBucketizer=false;this._resultsBucketizer=new v(w.rules,function(ia,ja){switch(ja){case 'isSeeMore':return ia.isSeeMore;case 'objectType':return ia.type;case 'resultSetType':return ia.results_set_type;case 'renderType':return ia.render_type||ia.type;case 'cacheOnlyResult':return ia.cacheOnlyResult;case 'closeEntity':return ia.bootstrapped||(!!ia.tags?ia.tags[ja]:(void 0));default:return !!ia.tags?ia.tags[ja]:(void 0);}});this.fetchNullState();this.initWithConfig(i.grammarConfig);}ga.prototype.initWithConfig=function(ha){"use strict";this.facebarConfig=ha;this.createResultStore();this.blockees={};if(this._fetched_null_state){this.setNullState(this._fetched_null_state);this._fetched_null_state=null;}};ga.prototype.throttleExecuteQuery=function(){"use strict";var ha=i.executeQueryThrottleTime;this.executeQueryThrottled=ba.withBlocking(this.executeQuery,ha,this);};ga.prototype.throttleSendRemoteQuery=function(){"use strict";var ha=i.sendRemoteQueryThrottleTime;if(ha===0){this.sendRemoteQueryThrottled=this.sendRemoteQuery;}else if(i.lazyThrottleRemoteQuery){var ia=Date.now(),ja=i.enableSendRemoteQueryDelay,ka=i.sendRemoteQueryDelayTime;this.sendRemoteQueryThrottled=function(){for(var la=[],ma=0,na=arguments.length;ma<na;ma++)la.push(arguments[ma]);var oa=Date.now();if(ia+ha<oa){ia=oa;if(ja){da(function(){this.sendRemoteQuery.apply(this,la);}.bind(this),ka);}else this.sendRemoteQuery.apply(this,la);}}.bind(this);}else this.sendRemoteQueryThrottled=ba.withBlocking(this.sendRemoteQuery,ha,this);};ga.prototype.throttleRenderResults=function(){"use strict";var ha=i.renderThrottleTime;if(ha===0){this.renderResultsThrottled=this.renderResults;return;}var ia=Date.now();this.renderResultsThrottled=function(ja,ka,la,ma){var na=Date.now();if(la||ia+ha<na){ia=na;this.renderResults(ja,ka,la,ma);}}.bind(this);};ga.prototype.createResultStore=function(){"use strict";this.facebarConfig.maxGrammarResults=this._maxGrammarResults;this.resultStore=new k(this.facebarConfig,p.tokenize,this.getEntry.bind(this),this.resultStoreOptions);if(this._fixProcessLean)this._processLean();this.subscribe('setSortFunction',function(ha,ia){this.resultStore.setSortFunction(ia);}.bind(this));};ga.prototype.dirty=function(){"use strict";this._nullStateFetched=false;this.resultStore.resetCaches();fa.dirty.call(this);};ga.prototype.addEntries=function(ha){"use strict";this.resultStore.addBootstrap(this.processEntries(ha));};ga.prototype._processLean=function(){"use strict";if(this._fixProcessLean){if(this._leanPayload&&this.resultStore){var ha,ia=this._leanPayload.entries;for(var ja in ia){ha=this.getEntry(ja);if(!ha)continue;for(var ka in ia[ja]){if(!ha.grammar_costs)ha.grammar_costs={};ha.grammar_costs['{'+ka+'}']=ia[ja][ka];}}this.setExclusions(this._leanPayload.blocked);this._leanPayload=null;}}else fa._processLean.call(this);};ga.prototype.setNullStateData=function(ha,ia){"use strict";if(ia)this.nullStateData={grammar_version:this.grammarVersion};aa(this.nullStateData,ha);return this;};ga.prototype.setNullState=function(ha){"use strict";this._null_state=ha;this.processEntries(this._null_state.entities);this.resultStore.setNullState(this._null_state.queries);var ia=r.typeNamedX;ia.forEach(function(ja){ja.parse.extendable=true;ja.qid=this._curQueryId;ja.isTypeNamedXBootstrap=true;},this);this.resultStore.addNullStateToQueryCache(this.getRawStructure(m.fromString('')),ia);this._typeNamedXResults={};ia.forEach(function(ja){this._typeNamedXResults[j.grammarToEntityTypes[ja.resultsSetType]]=ja;},this);};ga.prototype.getNullStateTrending=function(){"use strict";return this._null_state.trending;};ga.prototype.setSingleState=function(ha){"use strict";this._single_state=ha;};ga.prototype.overrideNullState=function(ha){"use strict";ca(this._null_state!=null);this._original_null_state=this._original_null_state||this._null_state;this.setNullState(ha);};ga.prototype.restoreNullState=function(){"use strict";if(this._original_null_state)this.setNullState(this._original_null_state);};ga.prototype.fetchNullState=function(){"use strict";if(this._nullStateFetched||!i.allowGrammar){this.activityStart();setTimeout(this.activityEnd.bind(this),0);return;}var ha=new h().setURI(this.nullStateEndpoint).setData(this.nullStateData).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler(function(ia){if(this.resultStore){this.setNullState(ia.payload);this.inform('nullstateReady',true);}else this._fetched_null_state=ia.payload;this._nullStateFetched=true;}.bind(this)).setFinallyHandler(this.activityEnd.bind(this));this.activityStart();ha.send();};ga.prototype.fetchNUXResults=function(ha){"use strict";if(!i.allowGrammar)return;ha=ha||{};var ia=new h().setURI(ha.URI).setData(this.nullStateData).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler(function(ja){if(this.resultStore){this.overrideNullState(ja.payload);ha.success&&ha.success();}}.bind(this)).setFinallyHandler(this.activityEnd.bind(this));this.activityStart();ia.send();};ga.prototype.toTypeaheadEntryUid=function(ha){"use strict";var ia,ja=m.fromStruct(ha.structure),ka=ja.getFragment(0);if(ja.getCount()==1&&ka.isType('ent')){var la=ka.getType().split(':')[2];ia=this.getEntry(ka.getUID(),la);ia.type=this.resultStore.stripBrackets(ha.type);}else{ia=this.getEntry(ha.tuid);if(!ia){ia={dynamic_cost:ha.dynamic_cost,extra_uri_params:ha.extra_uri_params,icon_class:ha.iconClass,memcache:ha.fromMemcache,photo:ha.photo,results_set_type:ha.resultsSetType,tuid:ha.tuid,type:ha.type,uid:ha.tuid,tags:ha.tags,is_redirect:ha.isRedirect};this.processEntries([ia]);ia=this.getEntry(ha.tuid);}}if(ia.is_redirect)ia.path=ha.path;ia.error_info=ha.errorInfo;ia.logInfo=ha.logInfo;ia.structure=ja;ia.text=ia.structure.toString();ia.queryTypeText=ha.queryTypeText;ia.semantic=ha.semantic;ia.alternateSemantic=ha.alternateSemantic;ia.tree=ha.tree;ia.cost=ha.cost;ia.isSeeMore=!!ha.isSeeMore;ia.isNullState=!!ha.isNullState;ia.isSingleState=!!ha.isSingleState;ia.isTrending=!!ha.isTrending;ia.isRecent=!!ha.isRecent;ia.entityInfo=ha.entityInfo;ia.cacheOnlyResult=ha.cacheOnlyResult||false;ia.isExtendedResult=ha.isExtendedResult||false;if(ha.isExtendedResult){ia.uri=u.getURI(this.facebarConfig,ia);}else ia.uri=ia.uri||u.getURI(this.facebarConfig,ia);ia.semanticForest=ha.semanticForest;ia.parse=ha.parse;ia.tags=ha.tags||{};ia.isKeywordL2=ha.isKeywordL2||false;ia.exactMatchKeyword=ha.exactMatchKeyword||false;ia.qid=ha.qid;ia.templateID=ha.templateID;if(ha.isJSBootstrapMatch){ia.isJSBootstrapMatch=ha.isJSBootstrapMatch;ia.backendCost=ha.backendCost;ia.bootstrapCost=ha.bootstrapCost;}this._replaceCategoryWithTermMatches(ia,ha);return ia.tuid;};ga.prototype._replaceCategoryWithTermMatches=function(ha,ia){"use strict";if(ha.type!=="user"||!ha.term_to_subtitle||!ia.termMatches)return;var ja=[];ia.termMatches.forEach(function(la){if(ha.term_to_subtitle[la])ja.push(ha.term_to_subtitle[la]);},this);if(ha.category===(void 0))ha.category="";var ka=ha.category.split(" \xB7 ");ka.unshift.apply(ka,ja);ka=ka.filter(function(la,ma,na){return ma==na.indexOf(la);});ha.category=ka.splice(0,2).join(" \xB7 ");};ga.prototype.getRawStructure=function(ha){"use strict";if(typeof ha=='string')ha=m.fromString(ha);if(this.resultStore)return this.resultStore.transformStructured(ha.toArray());};ga.prototype.saveResult=function(ha){"use strict";this._initialQueryData=this.getUID(ha.uid,ha.fetchType);};ga.prototype.isDefaultKeywordQuery=function(ha){"use strict";return (ha.type==='keyword')&&(l.getTextFromResult(ha).toLowerCase()===this.value.getHash().trim().toLowerCase());};ga.prototype.buildUids=function(ha){"use strict";if(!ha||!this.resultStore)return [];if(typeof ha==='string')ha=m.fromString(ha);var ia=this.getRawStructure(ha),ja=this.resultStore.getResults(ia,this.getMaxResults()),ka=ja.results;if(typeof ka==='undefined')return [];var la=ja.null_state===true,ma=0;ka=ka.filter(function(ra,sa){if(!i.allowGrammar&&ra.type=='grammar')return false;return ra.semantic!='<blank>'&&(ra.type!='unimplemented'||ma++===0);},this);var na=ka.slice(),oa=[],pa=[],qa=[];ka.forEach(function(ra){if(ra.forcedPosition>0){qa.push(ra);}else if(ra.isSeeMore){oa.push(ra);}else pa.push(ra);});if(la){ka=this.orderNullState(ka,this.getMaxResults());}else ka=pa;this.inform('decorateSeeMoreSuggestions',{structured:ha,allResults:na,selectedResults:ka,seeMoreResults:oa});if(qa.length>0){qa.sort(function(ra,sa){return ra.forcedPosition-sa.forcedPosition;});qa.forEach(function(ra){ka.splice(ra.forcedPosition,0,ra);});}if(oa.length>0)ka.push.apply(ka,oa);return ka.map(this.toTypeaheadEntryUid,this);};ga.prototype.orderNullState=function(ha,ia){"use strict";var ja={top:[],bottom:[],middle:[]},ka=function(na){var oa=na.null_state_position;return ja.hasOwnProperty(oa)?oa:'middle';},la=function(na,oa){return na.original_cost-oa.original_cost;};ha&&ha.forEach(function(na){ja[ka(na)].push(na);},this);for(var ma in ja){ja[ma]=ja[ma].sort(la).slice(0,ia);ia-=ja[ma].length;}return [].concat(ja.top,ja.middle,ja.bottom);};ga.prototype.handleResponse=function(ha,ia){"use strict";if(!(ha.payload.errors)){this.processEntries(ha.payload.entities);if(ha.payload.blockees)ha.payload.blockees.forEach(function(la){if(!(this.blockees.hasOwnProperty(la)))this.blockees[la.toLocaleLowerCase()]=la;}.bind(this));ha.payload.results.forEach(function(la){la.qid=ha.queryId;if(!la.parse)la.parse={};la.parse.entTokens=la.parse.entTokens||[];la.parse.remTokens=la.parse.remTokens||[];la.parse.suffix=la.parse.suffix||'';if(o.isEntity(la.semantic))la=this._buildCommonEntityFields(la,ia.tokens);}.bind(this));var ja={},ka=[];if(ha.payload.seemore&&this._typeNamedXResults)ha.payload.seemore.forEach(function(la){ka.push(this._typeNamedXResults[la]);},this);this.resultStore.saveResults(ha.payload.results,ia,ha.payload.incomplete,ja,ka);}};ga.prototype.processEntries=function(ha){"use strict";return ha.map(function(ia,ja){var ka=(ia.uid=ia.uid+'');ia.textToIndex=this.getTitleTerms(ia);ia.titleToIndex=this.getTitleTerms(ia);ka=this.getUID(ka,ia.fetchType);var la=this.getEntry(ka);if(!la){this.setEntry(ka,{});la=this.getEntry(ka);}else{delete ia.photo;if(!i.facebarUpdateSnippets){delete ia.category;delete ia.subtext;}}aa(la,ia);la.tuid=ka;la.index===(void 0)&&(la.index=ja);return ka;},this);};ga.prototype.getUID=function(ha,ia){"use strict";ha=ha+'';if(ia!==(void 0)){ia=/([^:]+:)?([^:]+)(:.*)?/.exec(ia)[2];return JSON.stringify([ha,ia]);}return ha;};ga.prototype.getEntry=function(ha,ia){"use strict";var ja;ha=''+ha;ja=ia!=null?fa.getEntry.call(this,this.getUID(ha,ia))||fa.getEntry.call(this,ha):fa.getEntry.call(this,ha);return ja;};ga.prototype.getEntryForFragment=function(ha){"use strict";return this.getEntry(ha.getUID(),ha.getTypePart(2));};ga.prototype.getMaxResults=function(){"use strict";return this._numResults.max;};ga.prototype.query=function(ha,ia,ja){"use strict";this.executeQueryThrottled(ha,this._initialQueryData,{keyPress:n.getTimestamp()});this._initialQueryData=null;};ga.prototype.executeQuery=function(ha,ia,ja){"use strict";this._curQueryId++;ja.queryId=this._curQueryId;ja.startCacheQuery=n.getTimestamp();var ka=(this.getMaxResults()+t.additionalResultsToFetch);this.setQueryData({qid:this._curQueryId,max_results:ka});this.inform('beforeQuery',{value:ha,queryId:this._curQueryId});this.value=ha;var la=this.buildUids(ha,[]);ja.endCacheQuery=n.getTimestamp();if(ia&&la.length===0)la.push(ia);if(i.sendExistingIDs){var ma=[];la.forEach(function(na){var oa=this.getEntry(na);if(oa&&oa.type in j.entityTypes)ma.push(oa.uid);},this);if(ma.length>0)this.setQueryData({qid:this._curQueryID,existing_ids:JSON.stringify(ma),max_results:ka});}this.inform('query',{value:ha,results:la,queryId:this._curQueryId});if(this.resultStore)this.respond(ha,la,false,false,ja);};ga.prototype.shouldFetchMore=function(ha,ia){"use strict";if(ha.is_empty)return false;if(this.resultStore.alreadyKnown(ha.cache_id))return false;if(ha.raw_text&&this._isQueryTooShort(ha.raw_text))return false;if(i.alwaysFetchMore)return true;if(ia.length<this.getMaxResults())return true;return this.countValidResults(ia)<this.getMaxResults();};ga.prototype.countValidResults=function(ha){"use strict";var ia=0;ha.forEach(function(ja){if(ja&&!ja.isNullState&&!ja.isSeeMore)ia++;},this);return ia;};ga.prototype.sendRemoteQuery=function(ha,ia,ja){"use strict";var ka=this._single_state,la=new h().setURI(this.queryEndpoint).setData(this.getQueryData(ha.text_form)).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler(function(ma,na){na.queryId=ma;na.inputQuery=ha.text_form;na.payload.results.forEach(function(oa){oa.isSingleState=ka;});ja.endRemoteQuery=n.getTimestamp();this.inform('response_received',na);this.handleResponse(na,ha);this.respond(ia,[],true,na.payload&&(!na.payload.results||na.payload.results.length===0),ja);this.inform('backend_response',na);}.bind(this,ja.queryId)).setFinallyHandler(this.activityEnd.bind(this));this.inform('sending_request',la);this._maxRemoteQueryId=ja.queryId;ja.waitingQueries=this._waitingQueries;ja.inflightRequests=h.getInflightCount();ja.startRemoteQuery=n.getTimestamp();la.send();this.activityStart();};ga.prototype.activityStart=function(){"use strict";if(!this._waitingQueries)this.inform('activity',{activity:true},g.BEHAVIOR_STATE);this._waitingQueries++;};ga.prototype.activityEnd=function(){"use strict";this._waitingQueries--;if(!this._waitingQueries)this.inform('activity',{activity:false},g.BEHAVIOR_STATE);};ga.prototype._bucketizeResults=function(ha,ia){"use strict";ia=this._tagKeywordsSuggestions(ia);ia=s.addL2Terms(ia,this.getMaxResults(),ha.toString(),i);ia=q.addTypeNamedX(ia,this.getMaxResults(),ha.toString(),i);var ja=Math.min(ia.length,this.getMaxResults());return this._resultsBucketizer.bucketize(ia,ja);};ga.prototype._tagKeywordsSuggestions=function(ha){"use strict";if(!ha||ha.length===0)return ha;var ia=ha[0];if(ia.bootstrapped)return ha;if(ia.type==='grammar'||(ia.cost<i.closeEntityThreshold&&ia.type==='user'))return ha;return ha.map(function(ja){if(ja.type!==j.keywordType)return ja;ja=aa(null,ja);ja.tags.topBucket=true;return ja;});};ga.prototype._buildCommonEntityFields=function(ha,ia){"use strict";if(ha.queryTypeText)return ha;if(i.unbreakParseDisplay){ha.parse.display=[{type:'ent:'+ha.type,uid:ha.semantic}];}else ha.parse.display=[{type:'ent:'+ha.type,uid:parseInt(ha.semantic,10)}];if(ha.parse.fetchType)ha.parse.display[0].fetchType=ha.parse.fetchType;ha.parse.entTokens=ia;ha.parse.pos=0;ha.resultsSetType='{'+ha.type+'}';ha.queryTypeText=j.defaultQueryTypeText;return ha;};ga.prototype.setBypassBucketizer=function(ha){"use strict";this._bypassBucketizer=ha;};ga.prototype.respond=function(ha,ia,ja,ka,la){"use strict";if(ja&&this.value){if(typeof this.value==='string')this.value=m.fromString(this.value);this.inform('remote_query_match',{isMatch:this.value.matches(ha),queryId:la?la.queryId:0});ha=this.value;ia=this.buildUids(ha);}this.inform('reorderResults',ia);this.inform('respondValidUids',ia);var ma=ia.map(this.getEntry,this);if(!ja){var na=this.getRawStructure(ha);if(this.shouldFetchMore(na,ma)){if(la!=null)la.dispatchRemoteQuery=n.getTimestamp();this.sendRemoteQueryThrottled(na,ha,la);}}if(!ja||!la||la.queryId===this._maxRemoteQueryId)this.renderResultsThrottled(ha,ma,ja,ka);if(la!=null)this.logLatencies(ja,la);};ga.prototype.renderResults=function(ha,ia,ja,ka){"use strict";if(!!ha&&(ha instanceof m&&!ha.isEmptyOrWhitespace())&&!this._bypassBucketizer)ia=this._bucketizeResults(ha,ia);ia.length=Math.min(ia.length,this.getMaxResults());ka=ja&&ia.length===0;this.inform('respond',{value:ha,results:ia,isAsync:!!ja,isEmptyResults:ka});};ga.prototype.logLatencies=function(ha,ia){"use strict";var ja=n.getTimestamp();if(ha){this.inform('remote_query_latency',{queryId:ia.queryId,latencies:{queryStart:Math.max(ia.startRemoteQuery-ia.dispatchRemoteQuery,0),queryEnd:Math.max(ia.endRemoteQuery-ia.startRemoteQuery,0),keyPressToQueryDispatch:Math.max(ia.dispatchRemoteQuery-ia.keyPress,0),keyPressToQueryStart:Math.max(ia.startRemoteQuery-ia.keyPress,0),keyPressToQueryEnd:Math.max(ia.endRemoteQuery-ia.keyPress,0),render:Math.max(ja-ia.endRemoteQuery,0),inflightRequests:ia.inflightRequests,waitingQueries:ia.waitingQueries,keyPressToRender:Math.max(ja-ia.keyPress,0)}});}else this.inform('cache_query_latency',{queryId:ia.queryId,latencies:{queryStart:Math.max(ia.startCacheQuery-ia.keyPress,0),queryEnd:Math.max(ia.endCacheQuery-ia.startCacheQuery,0),keyPressToQueryEnd:Math.max(ia.endCacheQuery-ia.keyPress,0),render:Math.max(ja-ia.endCacheQuery,0),keyPressToRender:Math.max(ja-ia.keyPress,0)}});};ga.prototype._updateMaxResults=function(){"use strict";var ha=y.getViewportDimensions().y,ia=z.getTop()||42,ja=56,ka=48;this._maxResults=Math.max(this._numResults.min,Math.min(this._numResults.max,Math.floor((ha-ia-ka-25)/ja)-1));this.value&&this.query(this.value);};ga.prototype.getCurQueryId=function(){"use strict";return this._curQueryId;};ga.prototype.setTypenamedXOption=function(ha){"use strict";i.showTypeNamedX=ha;};ga.prototype.setMinQueryLength=function(ha){"use strict";this._minQueryLength=ha;};ga.prototype.setGrammarOption=function(ha){"use strict";i.allowGrammar=ha;};aa(ga.prototype,{events:['query','respond','bootstrapped','activity','ready']});e.exports=ga;},null);
__d("FacebarTypeaheadDiffText.react",["React","ReactPropTypes","cx"],function(a,b,c,d,e,f,g,h,i){var j=g.createClass({displayName:"FacebarTypeaheadDiffText",propTypes:{prefix:h.string,text:h.string},renderDiff:function(k,l){return (g.createElement("span",{className:"diffNode _5td3",key:l},k));},renderParts:function(){var k=this.props.prefix,l=this.props.text;if(k==null)return this.renderDiff(l,0);var m=l.toLowerCase().indexOf((k.toLowerCase()));k=k.trim();if(m===0)l=l.slice(k.length);var n=l.split(/\b/).map(this.renderDiff);if(m===0)n.unshift(k);return n;},render:function(){return (g.createElement("span",g.__spread({},this.props),this.renderParts()));}});j.generatePrefixes=function(k,l){var m=[],n,o;for(var p=0,q=l.length;p<q;p++){o=l[p].getText();n=k.slice(0,Math.min(k.length,o.length));if(n==='')return m;if(o.toLowerCase().indexOf(n.toLowerCase())===0){m.push(n);k=k.slice(n.length);}else return m;}return m;};e.exports=j;},null);
__d("FacebarTypeaheadHighlightedText.react",["BrowseFacebarHighlighter","React","ReactPropTypes"],function(a,b,c,d,e,f,g,h,i){var j=h.createClass({displayName:"FacebarTypeaheadHighlightedText",propTypes:{text:i.string,tokens:i.array},renderHighlight:function(k,l){if((l+1)%3===0){return h.createElement("span",{className:"highlightNode",key:l},k);}else if(k)return k;},renderParts:function(){var k=this.props.text,l=this.props.tokens;if(l&&k){var m=g.createRegex(l),n=k.split(m);return n.map(this.renderHighlight);}else return k;},render:function(){return (h.createElement("span",h.__spread({},this.props),this.renderParts()));}});e.exports=j;},null);
__d("FacebarTypeaheadToken.react",["FacebarTypeaheadHighlightedText.react","ReactPropTypes","React","cx"],function(a,b,c,d,e,f,g,h,i,j){var k=' \u00B7 ',l=i.createClass({displayName:"FacebarTypeaheadToken",propTypes:{text:h.array.isRequired,highlight:h.array,limit:h.number,innerClass:h.string,leadingMiddot:h.bool,savedContext:h.string},render:function(){var m=null;if(this.props.savedContext)m=i.createElement("span",{className:"_10j2"},this.props.savedContext);var n=this.props.text;if(this.props.limit)n.splice(this.props.limit);n.forEach(function(r,s){if(s!==0||this.props.leadingMiddot||m)n[s]=k+r;}.bind(this));var o=i.createElement(g,{tokens:this.props.highlight,text:n.shift()}),p=n.length?i.createElement(g,{tokens:this.props.highlight,className:"_53ab",text:n.join('')}):null,q=this.props.innerClass||"_53aa";return (i.createElement("span",{className:"_53a9"},i.createElement("span",{className:q},m,o,p)));}});e.exports=l;},null);
__d("FacebarTypeaheadTokenText",["HTML","getElementText"],function(a,b,c,d,e,f,g,h){var i='\u00B7';function j(n){if(typeof n==='object'){return h(g(n).getRootNode());}else return n||'';}function k(n){return j(n).split(i).map(function(o){return o.trim();});}function l(n){var o={};return n.filter(function(p){var q=!o[p];o[p]=true;return q&&p;});}var m={textForEntity:function(n,o){var p=n.category||o[n.type]||'',q=n.subtext||'',r=k(p).concat(k(q));return l(r);},text:function(n){return l(k(n));}};e.exports=m;},null);
__d("FacebarTypeaheadEntityItem.react",["React","FacebarTypeaheadItem.react","FacebarTypeaheadToken.react","FacebarTypeaheadTokenText","TypeaheadFacepileX.react","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=g.createClass({displayName:"FacebarTypeaheadEntityItem",renderToken:function(){return (g.createElement(i,{highlight:this.getHighlightTokens(),text:j.textForEntity(this.props.result,{}),savedContext:this.props.result.saved_context}));},renderIcon:function(){if(this.props.result.size>1&&this.props.result.photos){return (g.createElement(k,{className:"_51l_",photos:this.props.result.photos,size:this.props.result.size}));}else if(this.props.result.photo)return (g.createElement("img",{className:"_20h",alt:"",src:this.props.result.photo}));},getHighlightTokens:function(){if(this.props.result.original_query){var n=this.props.result.original_query.toString().trim(),o=n.split(' '),p=o.length>1?[n].concat(o):[n];return p.filter(function(q){return (q!=='');});}},render:function(){return (g.createElement(h,g.__spread({},this.props,{icon:this.renderIcon(),token:this.renderToken(),highlight:this.getHighlightTokens(),valign:true})));}});e.exports=m;},null);
__d("FacebarDisambiguationDialog",["Event","BrowseLogger","CSS","cx","Dialog","DOM","FacebarStructuredText","FacebarTypeaheadEntityItem.react","React","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=650;function r(s,t,u,v,w){"use strict";this._sets=s;this._path=t;this._ondone=u;this._oncancel=v;this._selection=[];this._typeaheadSID=w;}r.prototype.show=function(){"use strict";new k().setTitle("Which of these did you mean?").setBody(this._createBody()).setContentWidth(q).setModal(true).setButtons([k.CONFIRM,k.CANCEL]).setHandler(this._handleDone.bind(this)).setCancelHandler(this._handleCancel.bind(this)).show();this._sets.forEach(function(s){var t=[];s.forEach(function(v){t.push(v.uid);});var u=s[0];h.logDisambiguationImpression(u.text,u.type,this._path,t.join(','),this._typeaheadSID);}.bind(this));};r.prototype._createBody=function(){"use strict";var s=[];this._sets.forEach(function(t,u){s.length&&s.push(l.create('li',{className:"_200"}));t.forEach(function(v){var w=this._createItem(v,u);this._selection[u]||this._selectItem(w);s.push(w.root);}.bind(this));}.bind(this));return l.create('ul',{className:'viewList disambiguationList'},s);};r.prototype._createItem=function(s,t){"use strict";var u={uri:null,subtext:s.subtext,category:s.category,photo:s.photo,type:s.type,structure:m.fromStruct([{text:s.text,type:'ent:'+s.type,uid:s.uid}])},v=l.create('div',{className:"_201"}),w=o.createElement(n,{result:u}),x=l.create('div');o.render(w,x);var y=x.firstChild;i.addClass(y,"_6i3");l.appendContent(y,i.hide(v));var z={setId:t,result:s,root:y,check:v};g.listen(y,'mouseover',this._toggleHover.bind(this,z,true));g.listen(y,'mouseout',this._toggleHover.bind(this,z,false));g.listen(y,'click',function(event){this._selectItem(z);return event.kill();}.bind(this));return z;};r.prototype._toggleHover=function(s,t){"use strict";i.conditionClass(s.root,'selected',t);};r.prototype._toggleCheck=function(s,t){"use strict";i.conditionShow(s.check,t);};r.prototype._selectItem=function(s){"use strict";var t=this._selection[s.setId];this._selection[s.setId]=s;t&&this._toggleCheck(t,false);this._toggleCheck(s,true);};r.prototype._handleDone=function(s){"use strict";this._ondone(s==k.CONFIRM?this._selection.map(function(t){var u=t.result;h.logDisambiguationClick(u.text,u.type,this._path,u.index,u.uid,this._typeaheadSID);return u;}.bind(this)):null);};r.prototype._handleCancel=function(){"use strict";this._oncancel();};e.exports=r;},null);
__d("FacebarTypeahead",["Arbiter","Typeahead","copyProperties","emptyFunction","FacebarGlobalOptions","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l){for(var m in h)if(h.hasOwnProperty(m))o[m]=h[m];var n=h===null?null:h.prototype;o.prototype=Object.create(n);o.prototype.constructor=o;o.__superConstructor__=h;function o(p,q,r,s,t,u){"use strict";h.call(this,p,q,r,s);this.getCore();this.proxyEvents();this.initBehaviors(t||[]);var v=this.core.subscribe('focus',function(){if(u)u.init(this);this.core.unsubscribe(v);this.data.bootstrap(false);this.core.input.focus();if(k.fetchLeanOnFocus){var w=k.fetchLeanOnFocusThrottleTime;this.core.subscribe('focus',l(this.data.fetchLean,w,this.data));}}.bind(this));this.data.bootstrap(true);this.inform('init',this,g.BEHAVIOR_PERSISTENT);g.inform('Facebar/init',this,g.BEHAVIOR_PERSISTENT);}o.prototype.proxyEvents=function(){"use strict";var p,q=[],r=null,s=(function(){while(p=q.shift())this.inform(p[0],p[1]);r=null;}).bind(this);[this.data,this.view,this.core].forEach(function(t){t.subscribe(t.events,function(u,v){q.push([u,v]);r=r||setTimeout(s,0);}.bind(this));},this);};i(o.prototype,{init:j});e.exports=o;},null);
__d("StructuredInputDOM",["createArrayFromMixed","CSS","cx","DOM","FacebarGlobalOptions","getElementText"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=function(){return k.graphSearchV2?"_4v1s":"_586o";},n={ENTITY_CLASS:m(),encodeText:function(o){return o.replace(/ /g,'\u00a0');},decodeText:function(o){return o.replace(/\u00a0/g,' ');},createIconNode:function(o){if(o&&typeof o=='object'){var p=j.create('i',{className:o.className,style:o.uri&&{backgroundImage:'url("'+o.uri+'")'}});p.setAttribute('data-select','ignore');return p;}},createTextNode:function(o){return j.create('span',{'data-si':true},n.encodeText(o||""));},createEntityNode:function(o,p){var q=n.encodeText(o.text),r=n.createIconNode(p.icon),s=j.create('span',{},r?[r,q]:q),t=(p.className||'').split(/\s+/);t.push(n.ENTITY_CLASS);t.forEach(h.addClass.bind(h,s));var u={si:true,uid:o.uid,type:o.type,text:q,fulltext:q,group:p.group,select:p.select,icon:JSON.stringify(p.icon||null)};for(var v in u)if(u[v]!=null)s.setAttribute('data-'+v,u[v]);return s;},convertToTextNode:function(o){o.className='';o.setAttribute('data-type','text');o.removeAttribute('data-group');o.removeAttribute('data-select');o.removeAttribute('data-icon');o.removeAttribute('data-uid');for(var p=o.firstChild;p;p=p.nextSibling)if(!j.isTextNode(p))j.remove(p);},isEntityNode:function(o){return j.isElementNode(o)&&h.hasClass(o,n.ENTITY_CLASS);},containsOnlyText:function(o,p){p=g(p);for(var q=o.firstChild;q;q=q.nextSibling)if(!(j.isTextNode(q)||o.nodeName in p))return false;return true;},getText:function(o){return l(o).replace(/ /g,'\u00a0');},getDecodedText:function(o){return n.decodeText(l(o));},getLength:function(o){return l(o).length;},getMarker:function(o,p,q){var r=o.firstChild;while(r){var s=n.getLength(r);if(s>p||!r.nextSibling){if(j.isTextNode(r)||!q){return {node:r,offset:Math.min(p,s)};}else return n.getMarker(r,p);}else p-=s;r=r.nextSibling;}}};e.exports=n;},null);
__d("StructuredInputUtil",["StructuredInputDOM"],function(a,b,c,d,e,f,g){function h(n,o,p){var q=n.substr(0,o).lastIndexOf(p);return q!==-1?q+1:0;}function i(n,o,p){var q=n.indexOf(p,o);return q!==-1?q:n.length;}function j(n,o,p){return (o===0||o===n.length||n.substr(o,p.length)==p);}function k(n,o,p,q){switch(o){case 'none':return p;case 'all':return q?n.length:0;case 'word':if(j(n,p,'\u00a0')){return p;}else if(q){return i(n,p,'\u00a0');}else return h(n,p,'\u00a0');}}function l(n,o){return o&&g.isEntityNode(n)&&!g.isEntityNode(o);}var m={getMarkerAtOffset:function(n,o){var p=n.firstChild,q=0,r=0;while(p){q+=r;r=g.getLength(p);if(q+r>o){break;}else p=p.nextSibling;}return {node:p||n.lastChild,offset:o-q};},validateEntityText:function(n){var o=g.getText(n),p=n.getAttribute('data-fulltext'),q=n.getAttribute('data-group');if(q=='hashtag'){var r=o.match(/#[^\s]+/);p=r&&r[0];}var s=o.indexOf(p),t={prefix:null,entity:null,suffix:null};switch(q){case 'none':t.entity=o;break;case 'hashtag':case 'all':if(s!=-1){t.prefix=o.substr(0,s);t.entity=o.substr(s,p.length);t.suffix=o.substr(s+p.length);}else t.suffix=o;break;case 'word':if(s!=-1){t.prefix=o.substr(0,s);o=o.substr(s);}var u=0,v=0;while(u<p.length){v=i(p,u+1,'\u00a0');if(o.substr(0,v)!=p.substr(0,v)){break;}else u=v;}t.entity=o.substr(0,u)||null;t.suffix=o.substr(u)||null;}return t;},getGrouping:function(n,o){var p=n.getAttribute('data-group'),q=n.getAttribute('data-select');if(o=='select'){return q=='group'?p:'none';}else return p;},snapMarkerToText:function(n,o){var p=n.node;if(g.isEntityNode(p)){var q=n.offset,r=m.getGrouping(p,o);if(r!='none')if(q===0){var s=p.previousSibling;if(l(p,s))return {node:s,offset:g.getLength(s)};}else if(q==g.getLength(p)){var t=p.nextSibling;if(l(p,t))return {node:t,offset:0};}}return n;},nextMarkerBoundary:function(n,o,p){var q=n.node;if(g.isEntityNode(q)&&(!o||n.offset!==0)){var r=m.getGrouping(q,p);if(r!='none')return {node:n.node,offset:k(g.getText(q),r,n.offset,o)};}return n;}};e.exports=m;},null);
__d("StructuredInputCleaner",["DOM","createArrayFromMixed","copyProperties","StructuredInputUtil","StructuredInputDOM","UserAgent_DEPRECATED","getElementText"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(o,p,q){"use strict";this._node=o;this._selection=p;this._wrapText=q;}n.prototype._cleanEntityNode=function(o){"use strict";var p=o.getAttribute('data-text'),q=k.getText(o);o.style.cssText='';if(p==q&&k.containsOnlyText(o,{I:true}))return null;var r=[],s=j.validateEntityText(o),t=k.createIconNode(JSON.parse(o.getAttribute('data-icon')));if(!s.entity&&((s.suffix&&!s.prefix)||(s.prefix&&!s.suffix))){k.convertToTextNode(o);o.setAttribute('data-text',q);return null;}if(s.prefix)r.push(this._createTextNode(s.prefix));if(s.entity){if(this._selection&&m(o)!==s.entity)this._selection.markDirty(o);g.setContent(o,t?[t,s.entity]:s.entity);o.setAttribute('data-text',s.entity);r.push(o);}if(s.suffix)r.push(this._createTextNode(s.suffix));return r;};n.prototype._removeSpecialNodes=function(){"use strict";var o=h(this._node.getElementsByTagName('script')),p=h(this._node.getElementsByTagName('style'));o.forEach(g.remove);p.forEach(g.remove);};n.prototype._collapseNodes=function(){"use strict";for(var o,p=this._node.firstChild;p;p=o){o=p.nextSibling;if(!g.isTextNode(p)&&!k.isEntityNode(p)&&!k.containsOnlyText(p))for(var q=p.lastChild;q;q=p.lastChild){this._node.insertBefore(q,o);o=q;}}};n.prototype._createTextNode=function(o){"use strict";if(this._wrapText){return k.createTextNode(o);}else return document.createTextNode(o);};n.prototype.replaceNodes=function(o,p){"use strict";if(p==null)return;var q=o.length?o[o.length-1].nextSibling:null;o.forEach(function(r){if(p.indexOf(r)===-1)g.remove(r);},this);p.reverse().forEach(function(r){if(o.indexOf(r)===-1)this._node.insertBefore(r,q);q=r;},this);};n.prototype.clean=function(){"use strict";this._removeSpecialNodes();this._collapseNodes();var o=[],p=function(){if(o.length){this.replaceNodes(o,this._cleanTextNodes(o));o.length=0;}}.bind(this);h(this._node.childNodes).forEach(function(q){if(k.isEntityNode(q)){this.replaceNodes([q],this._cleanEntityNode(q));p(o);}else o.push(q);}.bind(this));p();if(!this._node.firstChild&&l.firefox())this._node.appendChild(this._createTextNode());};n.prototype.endOnText=function(){"use strict";var o=function(p,q){if(k.isEntityNode(p))this._node.insertBefore(this._createTextNode(),q?p:null);}.bind(this);o(this._node.firstChild,true);o(this._node.lastChild,false);};i(n.prototype,{_cleanTextNodes:(function(){var o=function(q){return (q.nodeName==='BR'||q.nodeName==='SPAN'&&p(q));},p=function(q){return q.getAttribute('data-si')&&k.containsOnlyText(q)&&k.getLength(q)>0;};return function(q){if(q.length!=1||!o(q[0])){var r=q.map(k.getText).join('').replace(/\s+/g,' ');return r?[this._createTextNode(r)]:[];}else{q[0].style.cssText='';return;}};})()});e.exports=n;},null);
__d("DOMSelection",[],function(a,b,c,d,e,f){(function(){var g=this,h={isPreceding:function(n,o){return o.compareDocumentPosition(n)&2;},contains:function(n,o){if(n.compareDocumentPosition!=null){return n.compareDocumentPosition(o)&16;}else return n.contains(o);},isCursorPreceding:function(n,o,p,q){if(n===p)return o<=q;if(h.isText(n)&&h.isText(p))return h.isPreceding(n,p);if(h.isText(n)&&!h.isText(p))return !h.isCursorPreceding(p,q,n,o);if(!h.contains(n,p))return h.isPreceding(n,p);if(n.childNodes.length<=o)return false;if(n.childNodes[o]===p)return 0<=q;return h.isPreceding(n.childNodes[o],p);},isText:function(n){return (n!=null?n.nodeType==3:false);},getChildIndex:function(n){var o=0;while(n=n.previousSibling)o++;return o;}},i=g.Selection=(function(){function n(o){this.win=o;}n.prototype.hasSelection=function(){return n.hasSelection(this.win);};n.prototype.isBidirectional=function(){return n.isBidirectional(this.win);};n.prototype.getOrigin=function(){return n.getOrigin(this.win);};n.prototype.getFocus=function(){return n.getFocus(this.win);};n.prototype.getStart=function(){return n.getStart(this.win);};n.prototype.getEnd=function(){return n.getEnd(this.win);};n.prototype.trySelection=function(o,p,q,r){return n.trySelection(this.win,o,p,q,r);};n.prototype.setSelection=function(o,p,q,r){return n.setSelection(this.win,o,p,q,r);};n.prototype.clearSelection=function(){return n.clearSelection(this.win);};return n;})();function j(){if(g.document.selection&&/MSIE 9\./.test(navigator.userAgent)){return false;}else return !!g.getSelection;}if(j()){i.supported=true;i.hasSelection=function(n){var o;return (o=n.getSelection())&&(o.focusNode!=null)&&(o.anchorNode!=null);};i.isBidirectional=function(n){return true;};i.getOrigin=function(n){var o;if(!((o=n.getSelection())&&(o.anchorNode!=null)))return null;return [o.anchorNode,o.anchorOffset];};i.getFocus=function(n){var o;if(!((o=n.getSelection())&&(o.focusNode!=null)))return null;return [o.focusNode,o.focusOffset];};i.getStart=function(n){var o,p,q,r,s,t;if(!i.hasSelection(n))return null;s=i.getOrigin(n),o=s[0],q=s[1];t=i.getFocus(n),p=t[0],r=t[1];if(h.isCursorPreceding(o,q,p,r))return [o,q];return [p,r];};i.getEnd=function(n){var o,p,q,r,s,t;if(!i.hasSelection(n))return null;s=i.getOrigin(n),o=s[0],q=s[1];t=i.getFocus(n),p=t[0],r=t[1];if(h.isCursorPreceding(o,q,p,r))return [p,r];return [o,q];};var k=function(n,o,p,q,s,t){var u=o.getSelection();if(!u)return;if(s==null)s=p;if(t==null)t=q;if(u.collapse&&u.extend){u.collapse(p,q);u.extend(s,t);}else{r=o.document.createRange();r.setStart(p,q);r.setEnd(s,t);if(n||!i.hasSelection(o)||(r.endContainer===s&&r.endOffset===t&&r.startContainer===p&&r.startOffset===q)){try{u.removeAllRanges();}catch(v){}u.addRange(r);}}};i.setSelection=k.bind(i,true);i.trySelection=k.bind(i,false);i.clearSelection=function(n){try{var p=n.getSelection();if(!p)return;p.removeAllRanges();}catch(o){}};i.getText=function(n){var o=n.getSelection();if(!o)return;return o.toString();};}else if(g.document.selection){var l=function(n,o,p){var q,r,s,t,u;r=n.createElement('a');q=o.duplicate();q.collapse(p);u=q.parentElement();while(true){u.insertBefore(r,r.previousSibling);q.moveToElementText(r);if(!(q.compareEndPoints((p?'StartToStart':'StartToEnd'),o)>0&&(r.previousSibling!=null)))break;}if(q.compareEndPoints((p?'StartToStart':'StartToEnd'),o)===-1&&r.nextSibling){q.setEndPoint((p?'EndToStart':'EndToEnd'),o);s=r.nextSibling;t=q.text.length;}else{s=r.parentNode;t=h.getChildIndex(r);}r.parentNode.removeChild(r);return [s,t];},m=function(n,o,p,q,r){var s,t,u,v,w;w=0;s=h.isText(q)?q:q.childNodes[r];t=h.isText(q)?q.parentNode:q;if(h.isText(q))w=r;v=n.createElement('a');t.insertBefore(v,s||null);u=n.body.createTextRange();u.moveToElementText(v);v.parentNode.removeChild(v);o.setEndPoint((p?'StartToStart':'EndToEnd'),u);return o[p?'moveStart':'moveEnd']('character',w);};i.supported=true;i.hasSelection=function(n){var o;if(!n.document.selection)return false;o=n.document.selection.createRange();return o&&o.parentElement().document===n.document;};i.getStart=function(n){var o;if(!i.hasSelection(n))return null;o=n.document.selection.createRange();return l(n.document,o,true);};i.getEnd=function(n){var o;if(!i.hasSelection(n))return null;o=n.document.selection.createRange();return l(n.document,o,false);};i.isBidirectional=function(n){return false;};i.getOrigin=function(n){return i.getStart(n);};i.getFocus=function(n){return i.getEnd(n);};var k=function(n,o,p,q,r,s){if(r==null)r=p;if(s==null)s=q;var t=o.document.body.createTextRange();m(o.document,t,false,r,s);m(o.document,t,true,p,q);return t.select();};i.setSelection=k.bind(i,true);i.trySelection=k.bind(i,false);i.clearSelection=function(n){return n.document.selection.empty();};i.getText=function(n){if(!i.hasSelection(n))return null;var o=n.document.selection.createRange();return o&&o.text;};}else i.supported=false;}).call(this);e.exports=Selection;},null);
__d("StructuredInputSelection",["DOM","DOMSelection","Vector","StructuredInputUtil","StructuredInputDOM"],function(a,b,c,d,e,f,g,h,i,j,k){function l(n){"use strict";var o=n.ownerDocument;this.window=o.defaultView||o.parentWindow;this.root=n;this.selection=false;this.start=new m(this,[]);this.end=new m(this,[]);this.update();}l.prototype.isSupported=function(){"use strict";return !!(h&&h.hasSelection);};l.prototype.update=function(){"use strict";this.selection=false;if(this.isSupported()&&this.root==document.activeElement)if(h.hasSelection(this.window)){var n=h.getStart(this.window),o=h.getEnd(this.window),p=h.getFocus(this.window);this.start=this.makeMarker(n);this.end=this.makeMarker(o);this.backward=n[0]==p[0]&&n[1]==p[1];this.selection=this.start.node&&this.end.node;}};l.prototype.makeMarker=function(n){"use strict";if(n[0]===this.root){return new m(this,[this.root.childNodes[n[1]],0]);}else return new m(this,n);};l.prototype.getFocus=function(){"use strict";return this.backward?this.start:this.end;};l.prototype.getOrigin=function(){"use strict";return this.backward?this.end:this.start;};l.prototype.move=function(n){"use strict";if(this.selection){this.start.move(n);this.start.snap();this.end.setPosition(this.start);return this.apply();}};l.prototype.expand=function(n){"use strict";if(this.selection){if(h.isBidirectional()){this.start.move(!n);this.start.snap();this.end.move(n);this.end.snap();}return this.apply();}};l.prototype.getText=function(){"use strict";if(this.selection&&this.isSupported()){var n=h.getText(this.window);return n;}};l.prototype.getOffset=function(){"use strict";if(this.selection)return this.start.rootOffset;};l.prototype.getLength=function(){"use strict";return (this.getText()||"").length;};l.prototype.setPosition=function(n,o){"use strict";this.backward=false;this.selection=true;this.start.setPosition(j.getMarkerAtOffset(this.root,n));this.start.snap();if(o>0){this.end.setPosition(j.getMarkerAtOffset(this.root,n+o));this.end.snap();}else this.end.setPosition(this.start);return this.apply();};l.prototype.hasRange=function(){"use strict";return this.selection&&(this.start.node!=this.end.node||this.start.offset!=this.end.offset);};l.prototype.scrollToFocus=function(){"use strict";var n=5,o=this.getFocus();if(o.node){var p=i.getElementDimensions(this.root).x,q=this.root.scrollLeft,r=o.node.offsetLeft+o.node.offsetWidth;if(r-q<n){this.root.scrollLeft=r-n;}else if(r-q>p-n)this.root.scrollLeft=r-p+n;}};l.prototype.apply=function(){"use strict";if(this.start.hasChanged()||this.end.hasChanged()){var n=this.getOrigin().getMarker(true),o=this.getFocus().getMarker(true);this.selection=this.selection&&n&&n.node&&o&&o.node;if(this.selection&&this.isSupported()){this.start.changed=false;this.end.changed=false;h.trySelection(this.window,n.node,n.offset,o.node,o.offset);return true;}}};l.prototype.markDirty=function(n){"use strict";if(g.contains(n,this.start.node,n))this.start.changed=true;if(g.contains(n,this.end.node,n))this.end.changed=true;};function m(n,o){"use strict";this.selection=n;this.node=o[0];this.offset=o[1];this.rootOffset=this.getRootOffset(o[0],o[1]);this.sibling=this.node&&this.node.previousSibling;this.changed=false;}m.prototype.hasChanged=function(){"use strict";return this.changed||!this.isNodeValid();};m.prototype.isNodeValid=function(){"use strict";if(k.getLength(this.node)>this.offset){var n=this.node;while(n=n.parentNode)if(n==this.selection.root)return true;}};m.prototype.getMarker=function(n){"use strict";if(this.isNodeValid()&&((n&&!this.node.firstChild)||(!n&&this.node.parentNode==this.selection.root))){return this;}else return k.getMarker(this.selection.root,this.rootOffset,n);};m.prototype.move=function(n){"use strict";this.node&&this.setPosition(j.nextMarkerBoundary(this.getMarker(false),n,'select'));};m.prototype.snap=function(){"use strict";this.node&&this.setPosition(j.snapMarkerToText(this.getMarker(false),'select'));};m.prototype.setPosition=function(n){"use strict";if(n.offset!=this.offset||n.node!=this.node){this.changed=true;this.node=n.node;this.offset=n.offset;this.rootOffset=this.getRootOffset(this.node,this.offset);}};m.prototype.getRootOffset=function(n,o){"use strict";var p=0,q=5;while(n&&p++<q)if(n===this.selection.root){return o;}else{var r=n;while(r=r.previousSibling)o+=k.getLength(r);n=n.parentNode;}};e.exports=l;},null);
__d("StructuredInput",["Arbiter","ArbiterMixin","CSS","DOM","DataStore","Event","Input","InputSelection","JSLogger","Keys","Locale","Parent","StructuredInputCleaner","StructuredInputDOM","StructuredInputSelection","StructuredInputUtil","Style","UserAgent_DEPRECATED","createArrayFromMixed","createObjectFrom","cx","csx","emptyFunction","getActiveElement","setTimeoutAcrossTransitions","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa){var ga=229,ha=z([p.UP,p.DOWN,p.LEFT,p.RIGHT,p.HOME,p.END]),ia=z([p.BACKSPACE,p.DELETE]),ja=z([p.SPACE,p.RETURN]),ka=z('IUB'.split('').map(function(sa){return sa.charCodeAt(0);})),la=x.firefox(),ma=x.ie(),na=x.webkit(),oa=fa(h);for(var pa in oa)if(oa.hasOwnProperty(pa))ra[pa]=oa[pa];var qa=oa===null?null:oa.prototype;ra.prototype=Object.create(qa);ra.prototype.constructor=ra;ra.__superConstructor__=oa;function ra(sa){"use strict";k.set(sa,'StructuredInput',this);this._root=sa;this._richInput=j.find(sa,"._586i");this._textInput=j.find(sa,"._586f");this._placeholderText=j.scry(sa,"._586j")[0];this._hintText=j.find(sa,"._586k");this._contentWidth=null;this._richWidth=null;this._hintNodes=[];g.subscribe(o.DUMP_EVENT,function(ta,ua){ua.structuredInputState={initInputsFinished:!!this._initInputsFinished,initEventsFinished:!!this._initEventsFinished,cleanInputPreTogglesFinished:!!this._cleanInputPreTogglesFinished,cleanInputFinished:!!this._cleanInputFinished,elements:{richInput:!!this._richInput,textInput:!!this._textInput,placeholderText:!!this._placeholderText,hintText:!!this._hintText}};}.bind(this));this.init();}ra.prototype.init=function(){"use strict";this.init=ca;this._initSelection();this._initCleaner();this._initInputs();this._initInputsFinished=true;this._initEvents();this._initEventsFinished=true;this._scheduledCleanInput=false;this._richChanged=false;this._textChanged=false;this._selectionChanged=false;this._selectionIgnore=false;this._imeMode=false;this.cleanInput();this.inform('init',null,g.BEHAVIOR_PERSISTENT);};ra.prototype._initInputs=function(){"use strict";this._richInput.contentEditable=true;this._richInput.spellcheck=false;this._richInput.tabIndex=1;this._textInput.tabIndex=-1;this._multiline=this._textInput.nodeName=='TEXTAREA';if(!i.shown(this._richInput)){var sa=n.get(this._textInput),ta=da()===this._textInput;j.setContent(this._richInput,t.encodeText(m.getValue(this._textInput)));i.hide(this._textInput);i.show(this._richInput);this.cleanInput();if(ta){this._richInput.focus();this.setSelection({offset:sa.start,length:sa.end-sa.start});}}this.togglePlaceholder();this._toggleHint();};ra.prototype._initEvents=function(){"use strict";var sa=null,ta=false,ua=function(){this._richChanged=true;ta||this.scheduleCleanInput(true);}.bind(this),va=function(){this._textChanged=true;ta||this.scheduleCleanInput(false);}.bind(this),wa=function(){this._selectionChanged=true;this.scheduleCleanInput(false);}.bind(this),xa=function(){this._imeMode=true;this._placeholderText&&i.hide(this._placeholderText);i.hide(this._hintText);}.bind(this),ya=function(){this._imeMode=false;this._richChanged=true;this.cleanInput();}.bind(this);l.listen(this._richInput,'keydown',function(za){sa=za.keyCode;if(za.ctrlKey&&za.keyCode in ka){return za.kill();}else if(za.keyCode in ha){wa();}else if(za.keyCode===p.BACKSPACE&&this._deleteTrailingChunk()){this._richChanged=true;this.cleanInput();return za.kill();}else if(za.keyCode in ia){ua();}else if(za.keyCode==ga)xa();}.bind(this));l.listen(this._richInput,'keypress',function(za){if(za.keyCode==p.RETURN){this._multiline&&this._insertText("\n");return za.kill();}else if(!this._selectionChanged&&this._selectionIsText()){va();}else ua();}.bind(this));if(!ta){l.listen(this._richInput,'keyup',function(za){if((this._imeMode||za.keyCode!=sa)&&za.keyCode in ja){ya();return za.kill();}else if(this._imeMode){this._textChanged=true;this.cleanInput();}}.bind(this));if(la)l.listen(this._richInput,'input',function(){this._textChanged=true;this.cleanInput();}.bind(this));}else{l.listen(this._richInput,'compositionstart',xa);l.listen(this._richInput,'compositionend',function(){setTimeout(ya,0);});l.listen(this._richInput,'input',function(){this._textChanged=true;if(!this._imeMode)if(!this._richChanged){this.cleanInput();}else this.scheduleCleanInput();}.bind(this));}l.listen(document,'selectionchange',function(){if(this._selectionIgnore){this._selectionIgnore=false;}else this._selectionChanged=true;}.bind(this));l.listen(this._richInput,'mousedown',function(){this._selectionChanged=true;this._selectionLength=0;this._selectionOffset=0;}.bind(this));l.listen(this._richInput,'mouseup',function(){this._selectionChanged=true;this.scheduleCleanInput();}.bind(this));l.listen(this._richInput,'cut',function(){this._richChanged=true;this.scheduleCleanInput(false);}.bind(this));l.listen(this._richInput,'paste',function(za){this._richChanged=true;this.scheduleCleanInput(true);}.bind(this));l.listen(this._richInput,'drop',function(za){this.focus();this.selectAll();this._insertClipboard(za&&za.dataTransfer);return za.kill();}.bind(this));l.listen(this._richInput,'dragover',function(za){za.dataTransfer.dropEffect='move';za.dataTransfer.effectAllowed='move';return za.kill();});l.listen(this._richInput,'focus',function(za){this._toggleHint();this.inform('focus');}.bind(this));l.listen(this._richInput,'blur',function(za){i.hide(this._hintText);this._imeMode=false;this._richChanged=true;this.scheduleCleanInput(false);this.inform('blur');}.bind(this));};ra.prototype._initCleaner=function(){"use strict";this._cleaner=new s(this._richInput,this._selection,true);};ra.prototype._initSelection=function(){"use strict";this._selection=new u(this._richInput);this._selectionLength=0;this._selectionOffset=0;};ra.prototype._insertClipboard=function(sa){"use strict";if(sa&&typeof sa.getData==='function'){var ta=sa.getData('Text');this._insertText(ta);}};ra.prototype._deleteTrailingChunk=function(sa){"use strict";var ta=this.getSelection();if(ta.length>0||ta.offset===0)return false;var ua=this.getSelection().offset-1,va=v.getMarkerAtOffset(this._richInput,ua);if(va&&t.isEntityNode(va.node)&&v.getGrouping(va.node,'select')!=='none'){j.remove(va.node);return true;}return false;};ra.prototype._selectionIsText=function(){"use strict";var sa=this._selection.start.node,ta=this._selection.end.node;return sa&&sa===ta&&!t.isEntityNode(sa)&&!t.isEntityNode(sa.parentNode);};ra.prototype._insertText=function(sa){"use strict";if(sa){var ta=j.create('div',{},sa);return this._insertNodes(ta);}};ra.prototype._insertHTML=function(sa){"use strict";if(sa){var ta=j.create('div'),ua=new s(ta,null,false);ta.innerHTML=sa;ua.clean();return this._insertNodes(ta);}};ra.prototype._insertNodes=function(sa){"use strict";if(document.selection){document.selection.createRange().pasteHTML(sa.innerHTML);}else document.execCommand('insertHTML',false,sa.innerHTML);this._richChanged=true;this.cleanInput();};ra.prototype.togglePlaceholder=function(sa){"use strict";if(!this._placeholderText)return;var ta=t.getLength(this._richInput)===0;if(sa&&ta){i.show(this._placeholderText);}else i.conditionShow(this._placeholderText,ta&&!this._imeMode);};ra.prototype._toggleHint=function(){"use strict";var sa=y(this._hintNodes),ta=null,ua='',va=t.getText(this._richInput).toLowerCase();if(!this.hasFocus())return;if(this._contentOverflows()){i.hide(this._hintText);return;}while(sa.length&&ua.length<va.length){ta=sa.shift();ua+=t.getText(ta);}if(va.length&&ua.substr(0,va.length).toLowerCase()==va.toLowerCase()){j.setContent(this._hintText,y(this._richInput.cloneNode(true).childNodes).filter(function(xa){return xa.tagName!=='BR';}));var wa=t.createTextNode(ua.substr(va.length));sa.unshift(wa);j.appendContent(this._hintText,j.create('span',{className:"_586h"},sa));i.show(this._hintText);i.hide(this._placeholderText);}else i.hide(this._hintText);};ra.prototype._contentOverflows=function(){"use strict";if(this._richWidth===null)this._richWidth=this._richInput.clientWidth;if(this._contentWidth===null){var sa=this._richInput.lastChild;this._contentWidth=j.isElementNode(sa)?sa.offsetLeft+sa.offsetWidth:0;}return this._contentWidth>this._richWidth;};ra.prototype._forceTop=function(){"use strict";if(!this._multiline)this._richInput.scrollTop=0;this._root.scrollTop=0;};ra.prototype._createStructureNodes=function(sa){"use strict";return sa.map(function(ta){return ta.uid||(ta.type&&ta.type!='text')?t.createEntityNode(ta,ta.display||{}):t.createTextNode(ta.text);}.bind(this));};ra.prototype._suppressInput=function(){"use strict";if(la||ma){if(this._richClean)return;this._richClean=this._richInput.cloneNode(true);this._richClean.contentEditable=false;this._root.insertBefore(this._richClean,this._richInput.nextSibling);this._richClean.scrollLeft=this._richInput.scrollLeft;w.set(this._richInput,'padding',0);w.set(this._richInput,'height',0);}};ra.prototype._revealInput=function(){"use strict";if(!this._richClean)return;w.set(this._richInput,'height','');w.set(this._richInput,'padding','');this._root.removeChild(this._richClean);this.focus();this._richClean=null;};ra.prototype._cleanInput=function(){"use strict";var sa;if(this._textChanged&&!this._richChanged){this._selection.update();sa='change';}else if(this._richChanged||this._selectionChanged){this._selection.update();if(this._richChanged){this._contentWidth=null;this._cleaner.clean();this._cleaner.endOnText();this._selection.apply();sa='change';}if(this._selectionChanged){this._cleanSelection();if(this._selectionLength||!this._richChanged)sa='select';}}this._revealInput();this._forceTop();this._cleanInputPreTogglesFinished=true;if(this._richChanged||this._textChanged){this.togglePlaceholder();this._toggleHint();}this._selectionIgnore=true;this._selectionChanged=false;this._richChanged=false;this._textChanged=false;this._cleanInputFinished=true;sa&&this.inform(sa);};ra.prototype._cleanSelection=function(){"use strict";var sa=this._selection.getLength(),ta=this._selection.getOffset();if(sa){this._selection.expand(sa>=this._selectionLength);sa=this._selection.getLength();ta=this._selection.getOffset();}this._selectionLength=sa;this._selectionOffset=ta;};ra.prototype.cleanInput=function(){"use strict";this._scheduledCleanInput||this._cleanInput();};ra.prototype.scheduleCleanInput=function(sa){"use strict";sa&&this._suppressInput();if(!this._scheduledCleanInput){this._scheduledCleanInput=true;ea(function(){this._cleanInput();this._scheduledCleanInput=false;}.bind(this),0);}};ra.prototype.setEnabled=function(sa){"use strict";this._textInput.disabled=!sa;this._richInput.contentEditable=sa;};ra.prototype.getRoot=function(){"use strict";return this._root;};ra.prototype.getRichInput=function(){"use strict";return this._richInput;};ra.prototype.getEnabled=function(){"use strict";return !this._textInput.disabled;};ra.prototype.getText=function(){"use strict";return t.getDecodedText(this._richInput);};ra.prototype.setText=function(sa){"use strict";j.setContent(this._richInput,t.createTextNode(sa));this._richChanged=false;this._selectionChanged=false;this.inform('change');};ra.prototype.setHint=function(sa){"use strict";this._hintNodes=this._createStructureNodes(sa);this._toggleHint();};ra.prototype.getStructure=function(){"use strict";var sa=[];y(this._richInput.childNodes).forEach(function(ta){var ua=!j.isTextNode(ta),va=t.getDecodedText(ta);va.length&&sa.push({text:va,uid:ua?ta.getAttribute('data-uid'):null,type:(ua&&ta.getAttribute('data-type'))||'text'});}.bind(this));return sa;};ra.prototype.setStructure=function(sa){"use strict";j.setContent(this._richInput,this._createStructureNodes(sa));this._cleaner.clean();this._cleaner.endOnText();this.togglePlaceholder();this._toggleHint();this._richChanged=false;this._selectionChanged=false;this.inform('change');};ra.prototype.getContentDimensions=function(){"use strict";var sa=this._richInput.lastChild;return {width:sa?sa.offsetLeft+sa.offsetWidth:0,height:sa?sa.offsetTop+sa.offsetHeight:0};};ra.prototype.getSelection=function(){"use strict";if(this._selection)return {offset:this._selection.getOffset(),length:this._selection.getLength()};};ra.prototype.setSelection=function(sa){"use strict";if(this.hasFocus()&&this._selection){this._selection.update();this._selection.setPosition(sa.offset,sa.length);this._selection.scrollToFocus();this._selectionChanged=false;this.inform('select');}};ra.prototype.moveSelectionToEnd=function(){"use strict";this.setSelection({length:0,offset:t.getLength(this._richInput)});};ra.prototype.isSelectionAtEnd=function(){"use strict";var sa=this.getSelection().offset,ta=t.getLength(this._richInput);return sa>=ta;};ra.prototype.selectAll=function(){"use strict";this.setSelection({offset:0,length:t.getLength(this._richInput)});};ra.prototype.hasFocus=function(){"use strict";return j.contains(this._root,document.activeElement);};ra.prototype.focus=function(){"use strict";this._richInput.focus();};ra.prototype.blur=function(){"use strict";var sa={position:'absolute',top:0,width:'1px',height:'1px'};if(q.isRTL()){sa.right='-100px';}else sa.left='-100px';var ta=j.create('input',{type:'text',tabIndex:-1,style:sa});j.appendContent(this._root,ta);var ua=function(){if(this.hasFocus()||(na&&document.activeElement===document.body)){ta.focus();ta.blur();}};this.blur=ua;this.blur();};ra.getInstance=function(sa){var ta=r.byClass(sa,"_586g");if(!ta)throw new Error('No DOMElement structured input found using '+sa);return k.get(ta,'StructuredInput')||new ra(ta);};e.exports=ra;},null);
__d("FacebarTypeaheadInput",["ArbiterMixin","csx","DOM","FacebarStructuredText","StructuredInput","Vector","copyProperties","Locale","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p={text:{className:"text",group:"all",select:"none"},ent:{className:"entity",group:"all",select:"group"},'ent:hashtag_exact':{className:"entity",group:"hashtag",select:"none"}};function q(v){return m(v.toStruct(),{display:p[v.getType()]||p[v.getTypePart(0)]});}var r=o(g);for(var s in r)if(r.hasOwnProperty(s))u[s]=r[s];var t=r===null?null:r.prototype;u.prototype=Object.create(t);u.prototype.constructor=u;u.__superConstructor__=r;function u(v){"use strict";this.root=v;this.input=k.getInstance(v);this.value=null;this.selection={offset:0,length:0};this.resetOnChange=true;this.initEvents();}u.prototype.initEvents=function(){"use strict";var v=function(w,x){this.inform(w,x);}.bind(this);this.input.subscribe('blur',v);this.input.subscribe('focus',v);this.input.subscribe('change',function(w,x){if(this.resetOnChange)this.value=null;this.inform('change',x);}.bind(this));};u.prototype.togglePlaceholder=function(v){"use strict";return this.input.togglePlaceholder(v);};u.prototype.focus=function(){"use strict";this.input.focus();};u.prototype.blur=function(){"use strict";this.input.blur();};u.prototype.getElement=function(){"use strict";return this.root;};u.prototype.getRawPlaceholderElement=function(){"use strict";return i.find(this.root,"._586j");};u.prototype.getRawInputElement=function(){"use strict";return i.scry(this.root,"._586i")[0];};u.prototype.getValue=function(){"use strict";if(this.value===null)this.value=j.fromStruct(this.input.getStructure());return this.value;};u.prototype.getLength=function(){"use strict";return this.getValue().getLength();};u.prototype.resetPlaceholder=function(){"use strict";this.input.resetPlaceholder();};u.prototype.setValue=function(v){"use strict";this.value=v;this.resetOnChange=false;var w=v.toArray().map(q);this.input.setStructure(w);this.input.setSelection({offset:v.getLength(),length:0});this.resetOnChange=true;};u.prototype.storeSelection=function(){"use strict";this.selection=this.input.getSelection();};u.prototype.restoreSelection=function(){"use strict";if(this.selection)this.input.setSelection(this.selection);};u.prototype.setHint=function(v){"use strict";var w=v&&!v.hasRTL()&&!n.isRTL()?v.toArray().map(q):[];this.input.setHint(w);};u.prototype.isSelectionAtEnd=function(){"use strict";return this.input.isSelectionAtEnd();};u.prototype.selectInput=function(v){"use strict";this.input.setSelection({offset:v||0,length:this.getLength()});};u.prototype.getEndOffset=function(){"use strict";var v=l.getElementDimensions(this.root),w=this.input.getContentDimensions();return Math.min(v.x,w.width);};m(u.prototype,{events:['change','focus','blur']});e.exports=u;},null);
__d("FacebarTypeaheadWebSearch",["FacebarStructuredFragment","FacebarStructuredText"],function(a,b,c,d,e,f,g,h){var i=new g({type:'ent:websuggestion',text:'Web Search: ',uid:null}),j=i.getText().toLowerCase().trim();function k(n,o){if(!n||n.type!=='websuggestion')return;var p=o.getValue().toArray();p.forEach(function(q){if(q.isType('ent')&&!q.isType('ent','user')&&q.getUID())if(n.extra_uri_params){n.extra_uri_params.qh=q.getUID();return;}});}function l(n){return n.getType()===i.getType();}function m(n){"use strict";this._core=n.getCore();this._view=n.getView();this._input=this._core.input;this._isEnabled=false;}m.prototype.enable=function(){"use strict";this._isEnabled=true;this.changeListener=this._input.subscribe('change',this._changeWebSearch.bind(this));this.lockListener=this._input.subscribe('shortcut',this._lockWebSearch.bind(this));this.beforeSelectListener=this._view.subscribe('beforeSelect',this._beforeSelect.bind(this));this.beforeRenderListener=this._view.subscribe('beforeRender',this._beforeRender.bind(this));};m.prototype._changeWebSearch=function(){"use strict";var n=this._input.getValue(),o=n.toArray(),p=o[0];if(p&&p.getType()==='text')if(p.getText().toLowerCase().startsWith(j)){o.splice(0,1,i,new g({text:p.getText().substr(j.length).replace(/^ /,'')}));this._replaceFragments(o);}else if(o.length>1&&o.some(l)){var q='';o.forEach(function(r){if(l(r))return;q+=r.getText();});this._input.storeSelection();this._input.setValue(h.fromString(q));this._input.restoreSelection();}};m.prototype._replaceFragments=function(n){"use strict";this._input.storeSelection();this._input.setValue(new h(n));this._input.restoreSelection();};m.prototype._beforeSelect=function(n,o){"use strict";k(o.selected,this._input);return true;};m.prototype._beforeRender=function(n,o){"use strict";var p=this._input.getValue().toArray()[0],q=p&&l(p);o.results.forEach(function(r){if(r.type==='websuggestion')r.isLockedWebSearchMode=q;});return true;};m.prototype._lockWebSearch=function(n,o){"use strict";if(o.shift){var p=this._input.getValue().toArray()[0];if(!p||!l(p))this._input.setValue(new h([i]));}};m.prototype.disable=function(){"use strict";this.beforeSelectListener.unsubscribe();this.changeListener.unsubscribe();this.lockListener.unsubscribe();this.beforeRenderListener.unsubscribe();this._isEnabled=false;};m.addPrefix=function(n){"use strict";var o=l(n.getFragment(0))||n.getFragment(0).getText().toLowerCase().startsWith(j);if(!o){var p=[i].concat(n.toArray());return new h(p);}else return n;};e.exports=m;},null);
__d("FacebarTypeaheadCore",["Animation","Arbiter","ArbiterMixin","Base64","DOM","Event","FacebarGlobalOptions","FacebarJSConstants","FacebarKeywordSearchUtils","FacebarResultStoreUtils","FacebarStructuredText","FacebarTypeaheadInput","FacebarTypeaheadWebSearch","Keys","KeywordsSearchResultConfig","Parent","Style","URI","arrayContains","copyProperties","cx","csx","getActiveElement","invariant","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea){var fa=ea(i);for(var ga in fa)if(fa.hasOwnProperty(ga))ia[ga]=fa[ga];var ha=fa===null?null:fa.prototype;ia.prototype=Object.create(ha);ia.prototype.constructor=ia;ia.__superConstructor__=fa;function ia(ja){"use strict";z(this,ja);}ia.prototype.init=function(ja,ka,la){"use strict";if(window.getSelection===null)throw new Error('Facebar: window.getSelection is null!');this.init=function(){};this.data=ja;this.view=ka;this.root=la;this.facebarRoot=v.byClass(la,"_585-");this.windowFocused=true;this.isFocused=false;this.hoverAnimation=null;this.stickyQuery=null;this.settedQuery=null;this.selectedQuery=null;this.currentQuery=null;this.initSubcomponents();this.initEvents();this.checkValue();};ia.prototype.initSubcomponents=function(){"use strict";var ja=k.find(this.root,"._5861");this.input=new r(ja);this.view.setInputElement(this.input.getRawInputElement());};ia.prototype.initEvents=function(){"use strict";l.listen(this.root,'keydown',this.keydown.bind(this));l.listen(this.root.parentNode,'mousedown',this.mousedown.bind(this));l.listen(this.view.getElement(),'mousedown',this.mousedown.bind(this));l.listen(window,'focus',this.focusWindow.bind(this));l.listen(window,'blur',this.blurWindow.bind(this));this.view.subscribe('select',this.selectView.bind(this));this.view.subscribe('highlight',this.highlightView.bind(this));this.view.subscribe('render',this.highlightView.bind(this));this.view.subscribe('hideHelp',this.performQuery.bind(this));this.input.subscribe('focus',this.focusInput.bind(this));this.input.subscribe('blur',this.blurInput.bind(this));this.input.subscribe('change',this.changeInput.bind(this));this.data.subscribe('activity',this.typeaheadActivity.bind(this));this.data.subscribe('respond',this.completeData.bind(this));this.data.subscribe('nullstateReady',this.performQueryIfVisible.bind(this));h.subscribe('FacebarTypeahead.clearRecentSearches',function(){return this.clearRecentSearches();}.bind(this));setTimeout(this.initFocus.bind(this),0);};ia.prototype.initFocus=function(){"use strict";if(!this.lazyFocused&&k.contains(this.input.root,ca())){this.lazyFocused=true;this.isFocused=true;this._newSession();this.inform('focus',{catchup:true});this.open();}};ia.prototype.cleanQuery=function(ja){"use strict";ja=z({},ja)||{};if(!ja.structure)ja.structure=new q();if(!m.allowGrammar||n.nonGrammarTypes[ja.type])ja.structure=q.fromString(ja.structure.toString());da(ja.structure instanceof q);if(ja.type=='websuggestion'&&m.allowGrammar&&m.webSearchLockedInMode)ja.structure=s.addPrefix(ja.structure);return ja;};ia.prototype._unlockQuery=function(){"use strict";var ja=this.input.getValue();if(ja.hasType('ent')&&ja.trim().getCount()===1){this.input.storeSelection();this.input.setValue(q.fromString(ja.toString()));this.input.restoreSelection();}};ia.prototype.setPageQuery=function(ja){"use strict";ja=this.cleanQuery(ja);var ka=this.input.getValue(),la=ja.structure,ma=!la.isEmptyOrWhitespace()&&(ka.isEmptyOrWhitespace()||ka.toString().trim()==la.toString().trim());return this.selectQuery(ja,ma);};ia.prototype.selectQuery=function(ja,ka){"use strict";ka=ka!==false;ja=this.cleanQuery(ja);if(ka||!this.selectedQuery){if(ka||this.getValue().isEmptyOrWhitespace())this.setQuery(ja);this.selectedQuery=ja;}return ja;};ia.prototype.completeSelection=function(){"use strict";var ja=this.view.getSelection();if(ja&&!ja.search){this.data.saveResult(ja);ja.structure=ja.structure.pad();this.setQuery(ja);return true;}};ia.prototype.setQuery=function(ja,ka){"use strict";ja=this.cleanQuery(ja);if(ja.structure.hasType('blank'))ja.structure=new q(ja.structure.toArray().filter(function(la){return la.getType()!='blank';}));this.input.setValue(ja.structure);this.settedQuery=ja;this.stickyQuery=ka===false?this.stickyQuery:ja;this.checkValue();};ia.prototype.checkValue=function(){"use strict";if(this.value&&this.value.getHash()==this.input.getValue().getHash())return;this.checkBlockedSearch();this.performQueryIfVisible();};ia.prototype.checkBlockedSearch=function(){"use strict";var ja=this.input.getValue().toString().toLocaleLowerCase();if(!this.data.blockees||!(this.data.blockees.hasOwnProperty(ja))){this.view.hideBlockNotification();}else this.view.showBlockNotification(this.data.blockees[ja]);};ia.prototype.isNullState=function(){"use strict";return (this.input.getValue().getHash()==='');};ia.prototype.performQueryIfVisible=function(){"use strict";if(!this.view.visible)return;this.value=this.nextQuery=this.getValue();this.performQuery();};ia.prototype.performQuery=function(){"use strict";if(m.graphSearchV2)this.view.resetIndex();this.data.query(this.nextQuery);this.currentQuery=this.nextQuery;};ia.prototype.requery=function(){"use strict";if(this.currentQuery)this.data.query(this.currentQuery);};ia.prototype.executeQuery=function(ja){"use strict";ja=this.cleanQuery(ja);var ka=this.inform('execute',ja),la=this.getSessionID();this.close();if(m.allowGrammar){this.selectQuery(ja);}else this.selectQuery();if(m.hasRecentSearchNullState&&ja.type!=='shortcut')this.data.resultStore.addRecentEntryToNullState(ja);if(!ka)this._navigateToQuery(ja,la);};ia.prototype.getSearchType=function(){"use strict";return 'facebar';};ia.prototype._newSession=function(){"use strict";if(this._sessionID!=null)return;this._sessionID=Math.random().toString();this.inform('session',this._sessionID,h.BEHAVIOR_STATE);};ia.prototype._closeSession=function(){"use strict";this._sessionID=null;this.inform('session',null,h.BEHAVIOR_STATE);};ia.prototype.getSessionID=function(){"use strict";return this._sessionID;};ia.prototype._navigateToQuery=function(ja,ka){"use strict";var la=this.data.facebarConfig;if(ja.uri){ja.uri.addQueryData(ja.extra_uri_params);ja.uri.addQueryData({ref:'br_tf'});if(ja.structure&&(ja.type=='websuggestion'||ja.type==u.result_type||(ja.type=='grammar'&&(!la||String(ja.uri.getPath()).startsWith(la.search_path))))){var ma=this.data.getRawStructure(ja.structure).text_form,na=j.encode(encodeURIComponent(ma)).replace(/\=+$/,''),oa={sid:ka,qs:na,gv:this.data.getQueryData().grammar_version},pa=j.encode(JSON.stringify(oa)).replace(/\=+$/,'');ja.uri.addQueryData({ref:pa});}ja.uri.go();return;}};ia.prototype.reset=function(){"use strict";this.selectQuery();this.inform('reset');};ia.prototype.animateInputValue=function(ja,ka,la){"use strict";this.hoverAnimation&&this.hoverAnimation.stop();var ma=new g(ka).from('opacity',1).to('opacity',0).duration(150).ondone(function(){this.input.setValue(la);this.hoverAnimation=na.go();}.bind(this)),na=new g(ja).from('opacity',0).to('opacity',1).duration(150).ondone(function(){this.hoverAnimation=null;w.set(ka,'opacity','');w.set(ja,'opacity','');}.bind(this));w.set(ja,'opacity',0);this.hoverAnimation=ma.go();};ia.prototype.open=function(){"use strict";this.inform('open');this.view.show(this.facebarRoot.offsetWidth);this.input.focus();this.checkValue();if(!this.isFocused){this.isFocused=true;this._newSession();this.inform('focus');}};ia.prototype.close=function(){"use strict";this._closeSession();if(this.inform('close')===false)return;if((!this.value||this.value.isEmptyOrWhitespace())&&this.selectedQuery){this.input.setValue(this.selectedQuery.structure);}else if(this.stickyQuery)this.input.setValue(this.stickyQuery.structure);this.input.blur();this.view.hide();this.view.setAutoSelect(false);this.inform('session',null,h.BEHAVIOR_STATE);if(this.isFocused){this.isFocused=false;setTimeout(this.inform.bind(this,'blur'),0);}};ia.prototype.getElement=function(){"use strict";return this.root;};ia.prototype.getValue=function(){"use strict";return this.input.getValue();};ia.prototype.getText=function(){"use strict";return this.getValue().toString();};ia.prototype.submitQuery=function(){"use strict";if(m.graphSearchV2&&this.view.index<0){var ja=this.input.getValue(),ka=this.data.getRawStructure(ja);if(ka&&!ka.is_empty){var la=!ka.raw_text?p.getRawTextFromStructured(ja.toArray()):ka.raw_text,ma=o.makeFacebarEntry(la);this.inform('magSearch',ma);this.executeQuery(ma);}}else this.view.select();};ia.prototype.keydown=function(event){"use strict";var ja=true,ka=l.getKeyCode(event);switch(ka){case t.ESC:this.close();break;case t.RIGHT:if(!m.disableLockingEntitiesOnRightArrow){ja=this.input.isSelectionAtEnd()&&this.completeSelection();}else ja=false;break;case t.TAB:var la=this.cleanQuery(this.view.getSelection()),ma=la.structure.hasType('blank');if(event.getModifiers().shift||(!this.completeSelection()&&!this.loading)){this.view.setAutoSelect(false);this.view.hide();ja=false;}else if(!ma&&!m.graphSearchV2)this.tabQueued=true;break;case t.UP:this.view.prev();break;case t.DOWN:this.view.next();break;case t.RETURN:this.submitQuery();break;case t.PAGE_UP:this.view.first();break;case 222:var na=this.input.value.trim();if(!event.getModifiers().shift&&na.endsOnType('ent'))this.input.setValue(na);ja=false;break;default:var oa=(ka<=46&&ka!==8),pa=(ka>=112&&ka<=126),qa=(ka===144||ka===145);if(!oa&&!pa&&!qa){if(m.unlockTextOnKeypress)this._unlockQuery();this.data.setSingleState(false);if(m.autohighlight)this.view.setAutoSelect(true);}this.stickyQuery=null;ja=false;break;}this.view.setPrevKey(ka);this.input.storeSelection();if(ja)return event.kill();};ia.prototype.mousedown=function(event){"use strict";if(m.autohighlight)this.view.setAutoSelect(true);this.input.storeSelection();if(v.byClass(event.target,"_50c9"))event.preventDefault();};ia.prototype.focusWindow=function(){"use strict";this.windowFocused=true;};ia.prototype.blurWindow=function(){"use strict";this.windowFocused=false;};ia.prototype.selectView=function(ja,ka){"use strict";if(!ka||!ka.selected)return;this.data.setSingleState(true);this.inform('select',ka);var la=this.cleanQuery(ka.selected);this.executeQuery(la);};ia.prototype.highlightView=function(){"use strict";var ja=this.view.getSelection();if(m.graphSearchV2){this.input.setHint(ja?ja.structure:null);}else ja&&this.input.setHint(ja.structure);};ia.prototype.blurInput=function(){"use strict";setTimeout((function(){if(this.windowFocused||x.getRequestURI().getSubdomain()==='apps'){this.input.togglePlaceholder();this.close();}}).bind(this),0);};ia.prototype.changeInput=function(){"use strict";this.inform('change');this.checkValue();this.inform('change_end');};ia.prototype.focusInput=function(){"use strict";this.open();this.input.togglePlaceholder(false);};ia.prototype.updateData=function(){"use strict";this.view.setLoading(this.loading);};ia.prototype.completeData=function(ja,ka){"use strict";this.checkBlockedSearch();if(ka.forceDisplay||(this.value&&this.value.matches(ka.value))){var la=m.graphSearchV2?!ka.results.length:(!ka.results.length&&!this.loading&&ka.isEmptyResults);this.view.render(ka.value,ka.results,ka.isAsync,la);if(this.tabQueued&&this.completeSelection())delete this.tabQueued;}};ia.prototype.typeaheadActivity=function(ja,ka){"use strict";this.fetching=ka.activity;if(this.loading!==this.fetching){this.loading=this.fetching;this.updateData();}};ia.prototype.getNameTextFromSelected=function(){"use strict";var ja=this.settedQuery&&this.settedQuery.semantic,ka=this.data.facebarConfig&&this.data.facebarConfig.name_functions,la=ja&&ka&&ja.match(/[a-z-]+\([^()]+\)/g);if(la)for(var ma=0;ma<la.length;ma++){var na=la[ma].match(/([a-z-]+)\(([^()]+)\)/);if(na&&y(ka,na[1]))return na[2];}return this.value.toString();};ia.prototype.clearRecentSearches=function(){"use strict";this.data.resultStore.clearRecentSearches();};ia.clearRecentSearches=function(){"use strict";h.inform('FacebarTypeahead.clearRecentSearches');};z(ia.prototype,{events:['session','focus','select','change','execute','blur']});e.exports=ia;},null);
__d("SearchTypeaheadRecorder",["AsyncRequest","Banzai","CurrentUser","Event","Keys","BanzaiScuba","TokenizeUtil","Vector","clickRefAction","copyProperties","ge","throttle","userAction","FacebarGlobalOptions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){function u(w){"use strict";this.init(w);this.initEvents();}u.prototype.init=function(w){"use strict";this.core=w.getCore();this.data=w.getData();this.view=w.getView();this.element=this.core.getElement();this.initTime=Date.now();this._onloadTime=0;this._extraRecorder=[];this.performanceTimings={};var x=q('search_first_focus');this.initStartTime=x&&x.value;this.bootstrapStats={bootstrapped:0};this.type="legacy_search";this._reset();};u.prototype._reset=function(){"use strict";this.stats={};this.avgStats={};this.appendStats={};this._backspacing=false;this.backendQueries=[];this._topreplace=false;this._inflightRequests={};var w=Math.random().toString();this.data.setQueryData({sid:w});this.view.setSid(w);this.recordStat('sid',w);this.recordStat('keypressed',0);};u.prototype.initEvents=function(){"use strict";this.core.subscribe('focus',function(event){if(!this.stats.session_start_time){this.recordStat('session_start_time',Date.now());var w=new Date(),x=w.getTimezoneOffset(),y=Date.now()-x*60*1000;this.recordStat('session_start_time_user_timezone',y);}}.bind(this));this.core.subscribe('blur',function(event){var w=Date.now();for(var x in this._inflightRequests){var y=this._inflightRequests[x],z=w-y;this.recordAvgStat('search_endpoint_ms_from_js',z);}this.recordStat('session_end_time',w);this.submit();}.bind(this));this.view.subscribe('select',function(w,x){this.recordSelectInfo(x);}.bind(this));this.view.subscribe('render',function(w,x){this.recordRender(x);}.bind(this));this.data.subscribe('logPerformanceTiming',function(w,x){this.performanceTimings[x.field]=x.value;}.bind(this));this.data.subscribe('activity',function(w,x){this.recordStat('pending_request',x.activity);}.bind(this));this.data.subscribe('respondValidUids',function(w,x){this.validUids=x.slice(0);}.bind(this));this.data.subscribe('beforeQuery',function(w,x){if(!x.value){this.query='';this.results=[];return;}if(!this.stats.first_query_time)this.recordStat('first_query_time',Date.now());this.query=x.value;this.recordCountStat('num_queries');}.bind(this));this.data.subscribe('queryEndpoint',function(w,x){this.recordCountStat('num_search_ajax_requests');this.recordAvgStat('endpoint_query_length',x.value.length);this._inflightRequests[x.value]=Date.now();}.bind(this));this.data.subscribe('onload',function(w,x){this._onloadTime=x.time;}.bind(this));this.data.subscribe('bootstrapped',function(w,x){this.bootstrapStats.endTime=x.time;this.bootstrapStats.bootstrapped=1;}.bind(this));this.core.subscribe('recordFunction',function(w,x){this._extraRecorder.push(x);}.bind(this));this.data.subscribe('endpointStats',function(w,x){var y=x.fetch_end-x.fetch_start;if(x.value){this.recordAvgStat('search_endpoint_ms_from_js',y);}else this.bootstrapStats[x.type]=y;if(x.coeff2_ts)this.bootstrapStats.coeff2_ts=x.coeff2_ts;if(typeof x.browserCacheHit!='undefined')this.recordCountStat(x.browserCacheHit?'bootstrap_cachehits':'bootstrap_cachemisses');if(this._inflightRequests[x.value])delete this._inflightRequests[x.value];}.bind(this));this.data.subscribe('query',function(w,x){this.recordAvgStat('num_results_from_cache',x.results.length);}.bind(this));this.data.subscribe('backend_topreplace',function(w,x){if(false===this._topreplace){this.recordStat("backend_topreplace",1);this._topreplace=true;}}.bind(this));this.data.subscribe('completeFetch',function(w,x){if(this.core.scubaInfo){var y=x.response,z={recv:x.stats.fetch_end-x.stats.fetch_start,render:Date.now()-x.stats.fetch_start,payload_size:JSON.stringify(y).length};if(!y.payload.entities)y.payload.entities=this.buildResults();this.logToScuba(y,z,this.core.scubaInfo,this.query,this.type);}}.bind(this));this.data.subscribe('completeCacheFetch',r(function(w,x){if(this.core.scubaInfo)this.logToScuba({},{},this.core.scubaInfo,this.query,this.type);}.bind(this),500));j.listen(this.element,'keydown',function(event){this.recordStat('keypressed',1);this.recordCountStat('count_keys_pressed');if(j.getKeyCode(event)==k.BACKSPACE){if(!this._backspacing&&this.query){this._backspacing=true;this.recordAppendStat('before_backspace_queries',this.query);}}else this._backspacing=false;}.bind(this));this.data.subscribe('beforeFetch',function(w,x){var y=x.request.data.value;if(!y)return;this.backendQueries.push(y);}.bind(this));};u.prototype.recordStat=function(w,x){"use strict";this.stats[w]=x;};u.prototype.recordCountStat=function(w){"use strict";var x=this.stats[w];this.stats[w]=x?x+1:1;};u.prototype.recordAvgStat=function(w,x){"use strict";if(this.avgStats[w]){this.avgStats[w][0]+=x;++this.avgStats[w][1];}else this.avgStats[w]=[x,1];};u.prototype.recordAppendStat=function(w,x){"use strict";if(!this.appendStats.hasOwnProperty(w))this.appendStats[w]=[];this.appendStats[w].push(x);};u.prototype.recordRender=function(w){"use strict";this.results=w.filter(function(y){return (y.uid!='search'&&y.type!='disabled_result'&&y.type!='header');}).map(function(y){return p(null,y);});var x=n.getViewportDimensions();this.recordStat('window_size_width',x.x);this.recordStat('window_size_height',x.y);if(this.results.length>0&&!this.stats.first_result_time)this.recordStat('first_result_time',Date.now());};u.prototype.recordSelectInfo=function(w){"use strict";var x=w.selected,y=w.index;if(x.groupIndex!==(void 0))y=w.index-x.groupIndex-1;var z={href:x.path},aa=x.dataGT?{gt:JSON.parse(x.dataGT)}:{};o('click',z,null,null,aa);s('search').uai('click');if(x.uid=='search'){this.recordStat('selected_search',1);}else if(x.uid=='invite'){this.recordStat('selected_invite',1);}else{var ba=x.log_type||x.rankType||x.render_type||x.type,ca=(ba=='friend'?'user':ba);this.recordStat('selected_'+ca,1);this.recordStat('selected_position',y);this.recordStat('selected_type',ba);this.recordStat('selected_name_length',x.text.length);this.recordStat('selected_id',x.uid);this.recordStat('selected_degree',x.bootstrapped?1:2);this.recordStat('selected_recent_search',x.recent_search);var da=m.parse(this.data.getTextToIndex(x)).tokens,ea=v(da,this.query);if(ea)this.recordStat('matched_terms',ea);}var fa={};this._extraRecorder.forEach(function(ga){ga(w,this.results,fa);}.bind(this));this.recordStat('extra_select_info',JSON.stringify(fa));if(x.type==='websuggestion'){this.recordStat('selected_memcached_websuggestion',x.fromMemcache);this.recordStat('selected_websuggestion_source',x.websuggestion_source);}this.recordStat('selected_with_mouse',w.clicked?1:0);};u.prototype._dataToSubmit=function(){"use strict";this.recordStat('candidate_results',this.buildResults());this.recordStat('query',this.query);this.recordStat('init_time',this.initTime);if(this.initStartTime){this.recordStat('init_start_time',this.initStartTime);this.recordStat('onload_time',this._onloadTime);this.initStartTime=0;}this.recordStat('bootstrapped',this.bootstrapStats.bootstrapped);if(this.bootstrapStats.endTime){this.recordStat('bootstrapped_time',this.bootstrapStats.endTime);this.recordStat('user_bootstrap_ms',this.bootstrapStats.user);this.recordStat('other_bootstrap_ms',this.bootstrapStats.other);this.bootstrapStats.endTime=0;}this.recordStat('coeff2_ts',this.bootstrapStats.coeff2_ts);this.recordStat('max_results',this.data._maxResults);if(this.backendQueries.length>0){if(this.backendQueries.length>this.data.logBackendQueriesWindow)this.backendQueries=this.backendQueries.slice(this.backendQueries.length-this.data.logBackendQueriesWindow);this.recordStat('backend_queries',this.backendQueries);}if(t.taSessionLoggingSample){var w=[];this.results.forEach(function(ba){w.push([ba.text||'',ba.category||'',ba.subtext||'']);});this.recordStat('raw_suggestions_text',w);}var x=this.stats;for(var y in this.avgStats){var z=this.avgStats[y];x[y]=z[0]/z[1];}for(var aa in this.appendStats)x[aa]=JSON.stringify(this.appendStats[aa]);return x;};u.prototype.buildResults=function(){"use strict";var w=(this.results||[]).map(function(x,y){var z=m.parse(this.data.getTextToIndex(x)).tokens,aa=x.rankType||x.render_type||x.type,ba=x.bootstrapped?1:0,ca=x.s_token||'',da=(typeof x.index=='undefined')?100:x.index,ea=v(z,this.query)||this.query,fa=x.index_rank,ga=x.match_type,ha=x.l_type,ia=x.vertical_type,ja=x.prefix_match,ka=x.prefix_length,la=x.text,ma=x.category,na=x.subtext;if(typeof x.groupIndex=='number')return [x.groupIndex,x.indexInGroup,x.uid,aa,ba,ca,ea,fa,ga,ja,ka,x.origIndex,ha,ia,la,ma,na,da];return [0,y,x.uid,aa,ba,ca,ea,fa,ga,ja,ka,x.origIndex,ha,ia,la,ma,na,da];}.bind(this));return JSON.stringify(w);};u.prototype.submit=function(){"use strict";var w=this._dataToSubmit();switch(this.data.recordingRoute){case 'double_recording':if(Math.random()>.5){w.recorded_first='legacy';setTimeout(this.submitThroughAsyncRequest.bind(this,w),0);h.post(this._banzaiRoute,w,{delay:0,retry:true});}else{w.recorded_first='banzai';h.post(this._banzaiRoute,w,{delay:0,retry:true});setTimeout(this.submitThroughAsyncRequest.bind(this,w),0);}break;case 'random_recording':if(Math.random()>.5){this.submitThroughAsyncRequest(w);}else h.post(this._banzaiRoute,w,{delay:0,retry:true});break;case 'banzai_basic':h.post(this._banzaiRoute,w);break;case 'banzai_vital':h.post(this._banzaiRoute,w,{delay:0,retry:true});break;default:this.submitThroughAsyncRequest(w);}this._reset();};u.prototype.addLatencyToSample=function(w,x,y){"use strict";w.addInteger(y+'query_start',x.queryStart);w.addInteger(y+'query_end',x.queryEnd);w.addInteger(y+'keypress_query_end',x.keyPressToQueryEnd);w.addInteger(y+'render',x.render);w.addInteger(y+'keypress_render',x.keyPressToRender);};u.prototype.logToScuba=function(w,x,y,z,aa){"use strict";var ba=new l('search_facebar_js',null,{addBrowserFields:true,addPredictedGeographyFields:true,addUser:true,addSearchVersion:true,addGatekeepers:{facebarGKs:true}});ba.addInteger('sample_rate',y.sample_rate);ba.addNormal('site',y.site);ba.addDenorm('query',z);var ca=w.payload||{};ca.entities&&ba.addInteger('num_entities',ca.entities.length);Object.keys(this.performanceTimings).forEach(function(da){ba.addInteger(da,this.performanceTimings[da]);}.bind(this),this);if(ca.results||ca.entries)ba.addInteger('num_results',(ca.results||ca.entries).length);if(ca.gzipped_payload_size!==(void 0))ba.addInteger('gzipped_payload_size',ca.gzipped_payload_size);if(x.recv&&x.render>x.recv){ba.addInteger('time_render',x.render-x.recv);ba.addInteger('time_js_async',x.recv);}if(x.payload_size)ba.addInteger('payload_size',x.payload_size);if(this.stats.time_render_null_state)ba.addInteger('time_render_null_state',this.stats.time_render_null_state);ba.addInteger('query_id',w.queryId);ba.addDenorm('user_id',i.getID());ba.addDenorm('session_id',this.stats.sid);ba.addNormal('typeahead_type',aa);if(x.remoteQueryLatencies){this.addLatencyToSample(ba,x.remoteQueryLatencies,'remote_');ba.addInteger('remote_keypress_query_dispatch',x.remoteQueryLatencies.keyPressToQueryDispatch);ba.addInteger('remote_keypress_query_start',x.remoteQueryLatencies.keyPressToQueryStart);ba.addNormal('inflight_requests',x.remoteQueryLatencies.inflightRequests);ba.addInteger('inflight_requests',x.remoteQueryLatencies.inflightRequests);ba.addNormal('waiting_queries',x.remoteQueryLatencies.waitingQueries);ba.addInteger('waiting_queries',x.remoteQueryLatencies.waitingQueries);}if(x.cacheQueryLatencies)this.addLatencyToSample(ba,x.cacheQueryLatencies,'cache_');ba.post();};u.prototype.submitThroughAsyncRequest=function(w){"use strict";if(Object.keys(w).length>0)new g().setURI(this._endPoint).setMethod('POST').setData({stats:w}).setOption('handleErrorAfterUnload',true).setErrorHandler(function(x){w.retry=true;new g().setURI(this._endPoint).setMethod('POST').setData({stats:w}).setOption('asynchronous',false).send();}.bind(this)).send();};var v=function(w,x){if(!w||!x)return;var y=m.parse(x);if(y.flatValue[y.flatValue.length-1]===' ')return y.flatValue;var z=y.tokens[y.tokens.length-1],aa={};w.forEach(function(fa){aa[fa]=(aa[fa]||0)+1;});var ba={},ca=y.tokens.slice(0,y.tokens.length-1);ca.forEach(function(fa){ba[fa]=(ba[fa]||0)+1;});for(var da=0;da<w.length;++da){var ea=w[da];if(ea.indexOf(z)===0&&(aa[ea]-(ba[ea]||0)>0)){ca.push(ea);return ca.join(' ');}}return (void 0);};p(u.prototype,{_endPoint:'/ajax/typeahead/record_metrics.php',_banzaiRoute:'search'});e.exports=u;},null);
__d("FacebarTypeaheadRecorder",["clickRefAction","copyProperties","Event","Keys","SearchTypeaheadRecorder","URI","userAction","Arbiter","FacebarTimerUtils","FacebarGlobalOptions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){for(var q in k)if(k.hasOwnProperty(q))s[q]=k[q];var r=k===null?null:k.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=k;function s(t){"use strict";this.typeahead=t;k.call(this,t);this.userText="";this.queryTimes={};this._sessionDisabled=false;this.type="facebar";this._maxQueryID=0;this._isQueryMatch=true;this._nullStartTime=null;}s.prototype.initEvents=function(){"use strict";this.typeahead.getCore().subscribe('session',function(t,u){if(u===null){this.sessionEnd();}else this.sessionStart(u);}.bind(this));this.typeahead.getCore().subscribe('select',function(t,u){this.recordSelectInfo(u);}.bind(this));this.typeahead.getCore().subscribe('magSearch',function(t,u){this.recordMagSearch(u);}.bind(this));this.typeahead.getCore().input.subscribe('shortcut',function(t,u){this.recordShortcut(u);}.bind(this));this.typeahead.getCore().subscribe('quickSelectRedirect',function(t,u){this.recordQuickSelectInfo(u);}.bind(this));this.typeahead.getView().subscribe('render',function(t,u){if(this.core.getText()==='')this.recordNullState();this.recordRender(u);}.bind(this));this.typeahead.getView().subscribe('logPerformanceTiming',function(t,u){this.performanceTimings[u.field]=u.value;}.bind(this));this.typeahead.getCore().subscribe('open',function(t,u){if(this.core.getText()==='')this._nullStartTime=Date.now();}.bind(this));this.typeahead.data.subscribe('query',function(t,u){if(!u.value.isEmpty())this.recordCountStat('num_queries');this.recordAvgStat('num_results_from_cache',u.results.length);this.queryTimes[u.queryId]={send:o.getTimestamp()};}.bind(this));this.typeahead.data.subscribe('sending_request',function(t,u){var v=u.data.value;if(!v)return;this.backendQueries.push(v);}.bind(this));this.typeahead.subscribe('navigation',function(t,u){if(u&&u.structure){this.recordStat('navigation_input',JSON.stringify(u.structure.toStruct()));this.recordStat('navigation_text',u.structure.toString());}}.bind(this));this.typeahead.data.subscribe('response_received',function(t,u,v){if(this.queryTimes[u.queryId]){var w=this.queryTimes[u.queryId];w.recv=o.getTimestamp()-w.send;if(u&&u.payload)w.payload_size=JSON.stringify(u.payload).length;}}.bind(this));this.typeahead.data.subscribe('remote_query_latency',function(t,u){if(this.queryTimes[u.queryId]){var v=this.queryTimes[u.queryId];v.remoteQueryLatencies=u.latencies;}}.bind(this));this.typeahead.data.subscribe('cache_query_latency',function(t,u){if(this.queryTimes[u.queryId]){var v=this.queryTimes[u.queryId];v.cacheQueryLatencies=u.latencies;}}.bind(this));this.typeahead.data.subscribe('backend_response',function(t,u){if(this.queryTimes[u.queryId]){var v=this.queryTimes[u.queryId];v.render=o.getTimestamp()-v.send;if(u.payload.incomplete)v.incomplete=true;v.backendInfo=u.payload.info;if(this.core.scubaInfo)this.logToScuba(u,v,this.core.scubaInfo,u.inputQuery,this.type);}}.bind(this));this.typeahead.data.subscribe('remote_query_match',function(t,u){if(this._maxQueryID<u.queryId){this._maxQueryID=u.queryId;this._isQueryMatch=u.isMatch;}}.bind(this));n.subscribe('BrowseNUX/typing',this.disableThisSession.bind(this));n.subscribe('TestConsole/typing',this.disableThisSession.bind(this));this.typeahead.getCore().subscribe('change',function(t,u){if(this.core.getText()==='')this._nullStartTime=Date.now();this.userInput(this.core.getText());}.bind(this));this.typeahead.subscribe('clear',function(){this.recordAppendStat('before_clear_queries',this.userText);}.bind(this));i.listen(this.element,'keydown',function(event){this.recordStat('keypressed',1);this.recordCountStat('count_keys_pressed');if(i.getKeyCode(event)==j.BACKSPACE){if(!this._backspacing){this._backspacing=true;this.recordAppendStat('before_backspace_queries',this.core.getText());}}else this._backspacing=false;}.bind(this));this.typeahead.subscribe('filter',function(t,u){this._unsupportedGrammarInfo=this.buildUnsupportedGrammarInfo(u);}.bind(this));this.typeahead.getCore().subscribe('recordFunction',function(t,u){this._extraRecorder.push(u);}.bind(this));};s.prototype._reset=function(t){"use strict";this.stats={};this.avgStats={};this.appendStats={};this._backspacing=false;this.backendQueries=[];this._topreplace=false;this._inflightRequests={};};s.prototype.sessionStart=function(t){"use strict";this._sessionEnded=false;this.data.setQueryData({sid:t});this.recordStat('sid',t);if(!this.stats.session_start_time){this.recordStat('session_start_time',o.getTimestamp());var u=new Date(),v=u.getTimezoneOffset(),w=Date.now()-v*60*1000;this.recordStat('session_start_time_user_timezone',w);}this.recordStat('keypressed',0);this.queryTimes={};};s.prototype.sessionEnd=function(){"use strict";if(this._sessionEnded||this._sessionDisabled){if(this._sessionDisabled){this.reset();this._sessionDisabled=false;this._sessionEnded=true;}return;}this._sessionEnded=true;this.recordStat('session_end_time',o.getTimestamp());this.recordStat('grammar_version',this.data.getQueryData().grammar_version);this.submit();};s.prototype.disableThisSession=function(){"use strict";this._sessionDisabled=true;};s.prototype.userInput=function(t){"use strict";this.userText=t;};s.prototype.buildUnsupportedGrammarInfo=function(t){"use strict";var u=t.results?t.results[0]:null;if(!u||u.results_set_type!=='unimplemented')return null;return {unsupported_grammar:{category:u.error_info.category||'unknown',edge:u.error_info.blamed_edge}};};s.prototype.buildTypeaheadRecord=function(t,u){"use strict";var v=t.rankType||t.render_type||t.type,w=0,x=u;if(typeof t.groupIndex=='number'){w=t.groupIndex;x=t.indexInGroup;}var y={group_index:w,index_in_group:x,cost:t.cost,s_value:t.s_value||0,semantic:t.semantic,text:t.structure.toString(),cache_only:(t.cacheOnlyResult?1:0),parse:t.parse,semantic_forest:t.semanticForest,category:t.category,type:v,source:t.bootstrapped,grammar_results_type:(t.results_set_type||'').replace(/[\[\{](.*)[\]\}]/,'$1'),result_from_memcache:t.memcache,websuggestion_source:t.websuggestion_source,dynamic_cost:t.dynamic_cost,is_js_bootstrap_match:t.isJSBootstrapMatch,backend_cost:t.backendCost,bootstrap_cost:t.bootstrapCost,match_type:t.match_type,l_type:t.l_type,vertical_type:t.vertical_type,prefix_match:t.prefix_match,prefix_length:t.prefix_length,index_before_buckets:t.indexBeforeBuckets,bucket_lineage:t.bucketLineage,nullstate:t.isNullState,singlestate:t.isSingleState,query_id:t.qid,template_id:t.templateID,coeff_cost:(typeof t.grammar_costs=='undefined')?-1:t.grammar_costs["{"+t.type+"}"]};if(t.logInfo)y.backend_log_info=t.logInfo;if(t.s_token)y.s_token=t.s_token;if(t.s_categories)y.s_categories=t.s_categories;return y;};s.prototype.buildListTypeaheadRecords=function(){"use strict";var t=[];this.results&&this.results.forEach(function(u,v){if(u.uid!=='search')t.push(this.buildTypeaheadRecord(u,v));}.bind(this));return t;};s.prototype.recordNullState=function(){"use strict";if(!this._nullStartTime)return null;this.recordStat('time_render_null_state',Date.now()-this._nullStartTime);if(this.core.scubaInfo)this.logToScuba({},{},this.core.scubaInfo,this.query,this.type);this._nullStartTime=null;};s.prototype.recordShortcut=function(t){"use strict";this.recordStat('shortcut',1);this.recordStat('shortcut_with_shift',t.shift);};s.prototype.recordStats=function(t,u){"use strict";for(var v in u)this.recordStat(t+'_'+v,u[v]);};s.prototype.getTypeaheadIndex=function(t,u){"use strict";var v=typeof t.groupIndex=='number'?t.groupIndex+1:0;return u-v;};s.prototype.recordQuickSelectInfo=function(t){"use strict";var u={input_query:t.input_query,semantic:t.semantic,type:t.type,position:t.position,with_mouse:t.with_mouse,text:t.text,quick_select:1};this.recordStats('selected',u);this.recordStat('quick_select',1);};s.prototype.recordMagSearch=function(t){"use strict";var u={};u.text=t.text;u.semantic=t.semantic;u.type=t.type;u.input_query=t.text;this.recordStats('selected',u);};s.prototype.recordSelectInfo=function(t){"use strict";var u=t.selected,v=this.getTypeaheadIndex(u,t.index),w={};if(u.uid=='search'){w.selected_search=1;}else{w=this.buildTypeaheadRecord(u);var x=(w.type=='friend'?'user':w.type);w.position=v;w[x]=1;}w.with_mouse=t.clicked?1:0;w.quick_select=0;w.input_query=this.userText;w.input_fragments=JSON.stringify(this.core.currentQuery.toStruct());var y=u.dataGT?{gt:JSON.parse(u.dataGT)}:{},z={href:u.path};g('click',z,null,null,y);m('search').uai('click');this.recordStats('selected',w);this.recordAppendStat('selection_history',{selected:w,candidate_results:this.buildListTypeaheadRecords(),timestamp:o.getTimestamp()});var aa={};this._extraRecorder.forEach(function(ba){ba(t,this.results,aa);}.bind(this));this.recordStat('extra_select_info',JSON.stringify(aa));this.recordStat('selected_with_mouse',t.clicked?1:0);};s.prototype._dataToSubmit=function(){"use strict";this.recordStat('max_results',this.data._maxResults);if(this.stats&&this.stats.selected_input_query){this.recordStat('input_query',this.stats.selected_input_query);}else this.recordStat('input_query',this.userText);this.recordStat('uri',l().toString());if(!this.stats.shortcut){this.recordStat('shortcut',0);this.recordStat('shortcut_with_shift',false);}var t=this.stats;for(var u in this.avgStats){var v=this.avgStats[u];t[u]=v[0]/v[1];}var w={candidate_results:this.buildListTypeaheadRecords(),timestamp:o.getTimestamp(),input_query:this.userText,remote_query_match:this._isQueryMatch};if(this._unsupportedGrammarInfo)h(w,this._unsupportedGrammarInfo);this.recordAppendStat('suggestions_at_end_of_session',w);this.recordAppendStat('query_times',this.queryTimes);if(this.backendQueries.length>0){if(this.backendQueries.length>this.data.logBackendQueriesWindow)this.backendQueries=this.backendQueries.slice(this.backendQueries.length-this.data.logBackendQueriesWindow);this.recordStat('backend_queries',this.backendQueries);}if(p.taSessionLoggingSample){var x=[];this.results.forEach(function(z){x.push([z.text||'',z.category||'',z.subtext||'']);});this.recordStat('raw_suggestions_text',x);}if(p.graphSearchV2){this.recordStat('experience_type','gsv2');}else this.recordStat('experience_type','facebar');for(var y in this.appendStats)t[y]=JSON.stringify(this.appendStats[y]);return t;};s.prototype.getDataToSubmit=function(){"use strict";return this._dataToSubmit();};s.prototype.reset=function(){"use strict";return this._reset();};s.prototype.submit=function(){"use strict";if(!this._sessionDisabled)r.submit.call(this);this.view.inform('feedback');this._reset();};h(s.prototype,{_endPoint:'/ajax/typeahead/search/record_metrics.php',_sessionEnded:true,_extraRecorder:[],_banzaiRoute:'facebar'});e.exports=s;},null);
__d("FacebarTypeaheadV2",["CSS","csx","cx","DOM","Event","Parent"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m={init:function(n){this._view=n.getView();this._root=l.byClass(n.getElement(),"_585-");this._button=j.find(this._root,"._4w98");this._core=n.getCore();k.listen(this._button,'mousedown',this.buttonDown.bind(this));k.listen(this._button,'mouseup',this.buttonUp.bind(this));this._core.subscribe('open',this.showButton.bind(this));this._core.subscribe('close',this.hideButton.bind(this));},showButton:function(){g.addClass(this._button,"_4w97");},hideButton:function(){if(g.hasClass(this._button,"_4w97"))g.removeClass(this._button,"_4w97");},buttonDown:function(event){event.preventDefault();},buttonUp:function(){if(!this._core.isFocused){this._core.focusInput();}else this._core.submitQuery();}};e.exports=m;},null);
__d("FacebarTypeaheadGrammarItem.react",["React","FacebarTypeaheadItem.react","FacebarTypeaheadToken.react","FacebarTypeaheadTokenText","cx","fbt","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n={user:"Person"},o=g.createClass({displayName:"FacebarTypeaheadGrammarItem",renderToken:function(){var p=this.props.result.decoration,q=this.props.result.ambiguity,r=q&&q.text,s=(p&&p.entity)||(q&&q.entity);if(this.props.result.isRecent){var t="Recent search";return (g.createElement(i,{text:[t],innerClass:"_53ab"}));}else if(r){return (g.createElement(i,{text:j.text(r)}));}else if(s)return (g.createElement(i,{text:j.textForEntity(s,n),limit:2,leadingMiddot:true}));},render:function(){var p=this.renderToken(),q=p&&!p.props.leadingMiddot;return (g.createElement(h,g.__spread({},this.props,{className:m(this.props.className,"_207"),valign:q,token:p})));}});e.exports=o;},null);
__d("FacebarTypeaheadKeywordItem.react",["FacebarTypeaheadItem.react","FacebarTypeaheadToken.react","React","cx","fbt","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=i.createClass({displayName:"FacebarTypeaheadKeywordItem",render:function(){var n=["Search"];if(this.props.result.isTrending){n.push("Trending");}else if(this.props.result.type=='related')n=["Related search"];var o=i.createElement(h,{text:n,innerClass:"_53ab"});return (i.createElement(g,i.__spread({},this.props,{className:l(this.props.className,"_207"),token:o,prefix:this.props.result.query_string.toLowerCase()})));}});e.exports=m;},null);
__d("FacebarTypeaheadTrendingItem.react",["FacebarTypeaheadItem.react","FacebarTypeaheadToken.react","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k){var l=i.createClass({displayName:"FacebarTypeaheadTrendingItem",render:function(){var m=this.props.result.articleTitle||'',n=i.createElement(h,{text:[m],innerClass:"_53ab",leadingMiddot:true});return (i.createElement(g,i.__spread({},this.props,{className:k(this.props.className,"_207"),token:n,valign:false})));}});e.exports=l;},null);
__d("FacebarTypeaheadNodeItem.react",["React","DOM"],function(a,b,c,d,e,f,g,h){var i=g.createClass({displayName:"FacebarTypeaheadNodeItem",render:function(){var j=this.props.result.node;return (g.createElement("li",g.__spread({},this.props),!h.isElementNode(j)?j:null));},attachNode:function(j){var k=this.props.result.node;if(h.isElementNode(k))h.setContent(j,k);},componentDidMount:function(){this.attachNode(this.getDOMNode());},componentDidUpdate:function(j,k,l){this.attachNode(this.getDOMNode());},shouldComponentUpdate:function(j){return this.props.result.node!==j.result.node;}});e.exports=i;},null);
__d("FacebarTypeaheadWebSuggestionItem.react",["FacebarTypeaheadItem.react","FacebarTypeaheadToken.react","React","cx","fbt","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m={EXACT_MATCH:1,BING:2,BING_POPULAR:3,WEBSUGGESTIONS_AS_KEYWORDS:4},n=i.createClass({displayName:"FacebarTypeaheadWebSuggestionItem",renderToken:function(){if(this.props.result.isLockedWebSearchMode)return;var o=this.props.result.websuggestion_source,p;if(o===m.WEBSUGGESTIONS_AS_KEYWORDS){p="Search";}else if(o===m.BING_POPULAR){p="Popular Web Search";}else p="Web Search";return (i.createElement(h,{innerClass:"_57q5",text:[p]}));},render:function(){this.props.result.icon_class="_6-a";return (i.createElement(g,i.__spread({},this.props,{className:l(this.props.className,"_207"),token:this.renderToken()})));}});e.exports=n;},null);
__d("FacebarTypeaheadList.react",["ARIA","React","ReactPropTypes","StaticContainer.react","FacebarTypeaheadEntityItem.react","FacebarTypeaheadGrammarItem.react","FacebarTypeaheadKeywordItem.react","FacebarTypeaheadTrendingItem.react","FacebarTypeaheadNodeItem.react","FacebarTypeaheadWebSuggestionItem.react","LoadingIndicator.react","FacebarJSConstants","FacebarGlobalOptions","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v={grammar:l,node:o,trending:n,related:m,websuggestion:p};v[r.browseTypes.keyword]=m;v[r.keywordType]=m;var w=h.createClass({displayName:"FacebarTypeaheadList",propTypes:{results:i.array,onRender:i.func,onSelect:i.func.isRequired,onHighlight:i.func.isRequired},getItemComponent:function(x,y){var z=x.type,aa;if(x.results_set_type===r.browseTypes.keyword)z=r.browseTypes.keyword;if(x.node)z='node';if(z==null)z='entity';aa=v[z];if(aa==null){aa=k;z='entity';}return {type:z,constructor:aa};},renderItem:function(x,y){var z=this.getItemComponent(x),aa=z.constructor;z=h.createElement(aa,{result:x,onClick:this.handleClick.bind(null,x),onMouseEnter:this.handleMouseEnter.bind(null,x)});var ba;if(x.type===r.keywordType){ba=h.createElement(j,{key:x.query_string+x.semantic},z);}else{var ca=x.semantic||x.uid||x.tuid;if(s.facebarUpdateSnippets)ca=ca+x.category+x.subtext;ba=h.createElement(j,{key:ca},z);}return ba;},renderFooter:function(){var x=(("_3su")+(!this.props.loading?' '+"hidden_elem":''));return (h.createElement("li",{className:x},h.createElement("div",{className:"_21f"},"Retrieving suggestions",h.createElement(q,{size:"medium",color:"white"}))));},componentDidMount:function(){var x=this.getDOMNode();g.owns(this.props.accessibilityElement,x);},render:function(){var x=this.props.results;return (h.createElement("ul",{id:"facebar_typeahead_view_list",className:"_21c",role:"listbox"},x&&x.map(this.renderItem),this.renderFooter()));},handleClick:function(x,y){if(!y.nativeEvent.isMiddleClick()&&!y.nativeEvent.getModifiers().any){this.props.onSelect(x);y.preventDefault();}},handleMouseEnter:function(x){this.props.onHighlight(x);},componentDidUpdate:function(x,y,z){this.props.onRender();},shouldComponentUpdate:function(x){return this.props.loading!==x.loading||this.props.results!==x.results;}});e.exports=w;},null);
__d("FacebarTypeaheadView",["Arbiter","CSS","ContextualLayer","DOM","FacebarGlobalOptions","FacebarJSConstants","FacebarStructuredText","FacebarTypeaheadList.react","FacebarKeywordSearchUtils","Keys","Parent","React","Style","TypeaheadView","copyProperties","performanceNow","csx","cx","fbt","URI","Link.react"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){var ba='unimplemented';function ca(ga){var ha=o.makeFacebarEntry(ga);return {type:'keyword',results_set_type:l.browseTypes.keyword,text:ga,id:ga,uid:ga,query_string:ga,icon_class:"_5b1w",exactMatchKeyword:true,structure:m.fromString(ga),semantic:ha.semantic,uri:ha.uri};}for(var da in t)if(t.hasOwnProperty(da))fa[da]=t[da];var ea=t===null?null:t.prototype;fa.prototype=Object.create(ea);fa.prototype.constructor=fa;fa.__superConstructor__=t;function fa(ga,ha){"use strict";t.call(this,ga,ha);this.element=ga;this.sid='';this.index=-1;this.prevKey=-1;this.warningShown=false;this.autoSelect=false;this.loading=false;this.handleRender=this.handleRender.bind(this);this.handleHighlight=this.handleHighlight.bind(this);this.handleSelect=this.handleSelect.bind(this);this.events=['highlight','render','filter'];}fa.prototype.init=function(){"use strict";this.initializeElements();};fa.prototype.initGSV2Elements=function(){"use strict";var ga=this.element;this.contentKeyword=j.find(ga,"._f7s");this.contentEntity=j.find(ga,"._f7t");this.contentRecent=j.find(ga,"._mn8");this.keywordResultsContainer=j.create('div');this.entityResultsContainer=j.create('div');this.keywordResults=[];this.entityResults=[];};fa.prototype.initGSV2Construct=function(){"use strict";this.currentKeywordContainer=this.contentKeyword;this.contentKeyword.appendChild(this.keywordResultsContainer);this.contentEntity.appendChild(this.entityResultsContainer);if(this.entityTop){this.resultsContainer.appendChild(this.contentEntity);this.resultsContainer.appendChild(this.contentKeyword);}else{this.resultsContainer.appendChild(this.contentKeyword);this.resultsContainer.appendChild(this.contentEntity);}};fa.prototype.initializeElements=function(){"use strict";var ga=this.element;this.isGSV2=k.graphSearchV2;this.dynamicRank=this.isGSV2;this.entityTop=false;this.content=j.find(ga,"._21r");this.warningNode=j.find(ga,"._553e");this.blockNotificationNode=j.find(ga,"._2hh");this.resultsContainer=j.create('div');if(this.isGSV2)this.initGSV2Elements();};fa.prototype.initializeList=function(){"use strict";this.renderTypeaheadList();this.content.appendChild(this.resultsContainer);if(this.isGSV2)this.initGSV2Construct();};fa.prototype.initializeLayer=function(){"use strict";this.layer=new i({context:q.byClass(this.causalElement,"_585-"),position:'below',causalElement:this.causalElement},this.element);var ga=this.layer.getContentRoot();this.root=j.find(ga,"._50c9");h.addClass(ga,"_5tlx");if(this.isGSV2)h.addClass(ga,"_5xzd");this.wrapper=ga;};fa.prototype.setInputElement=function(ga){"use strict";this.setAccessibilityControlElement(ga);this.causalElement=ga;this.initializeLayer();this.initializeList();};fa.prototype.setAutoSelect=function(ga){"use strict";this.autoSelect=ga;if(this.index===-1&&ga)this.first();};fa.prototype.getIndexOf=function(ga,ha){"use strict";for(var ia=0;ia<ha.length;ia++)if(ga.semantic===ha[ia].semantic)return ia;return -1;};fa.prototype.handleHighlight=function(ga){"use strict";this.highlight(this.getIndexOf(ga,this.results),false);};fa.prototype.handleSelect=function(ga){"use strict";this.handleHighlight(ga);this.select(true);};fa.prototype.show=function(ga){"use strict";if(!this.visible){this.inform('beforeShow',this.layer);s.set(this.wrapper,'minWidth',ga+'px');var ha=ea.show.call(this);this.first();this.layer.show();this.layer.updatePosition();this.inform('show');g.inform('layer_shown',{type:'FacebarTypeahead'});return ha;}};fa.prototype.hide=function(){"use strict";if(this.visible){this.layer.hide();ea.hide.call(this);this.inform('hide');g.inform('layer_hidden',{type:'FacebarTypeahead'});}return this;};fa.prototype.select=function(ga){"use strict";var ha=this.results&&this.results[this.index];if(!ha){this.inform('quickSelect');return;}var ia=this.inform('beforeSelect',{index:this.index,selected:ha});if(ia!==false)ea.select.call(this,ga);};fa.prototype.processGSV2Results=function(ga){"use strict";this.keywordResults=[];this.entityResults=[];ga.forEach(function(ia){if(ia.type===l.keywordType||ia.type===l.grammarType){this.keywordResults.push(ia);}else this.entityResults.push(ia);}.bind(this));var ha=this.normalizeValue(this.value);if(ha){this.keywordResults=this.keywordResults.filter(function(ia){return this.normalizeValue(ia.text)!==ha;}.bind(this));this.keywordResults.unshift(ca(ha));}if(this.entityTop)return this.entityResults.concat(this.keywordResults);return this.keywordResults.concat(this.entityResults);};fa.prototype.normalizeValue=function(ga){"use strict";if(!ga)return ga;return String(ga).trim().replace(/\s+/g,' ').replace(/[\u200E|\u200F|\u202a|\u202b|\u202c]/g,'').toLowerCase();};fa.prototype.reGenerateContainer=function(){"use strict";var ga=j.create('div');if(this.entityTop){ga.appendChild(this.contentEntity);ga.appendChild(this.currentKeywordContainer);}else{ga.appendChild(this.currentKeywordContainer);ga.appendChild(this.contentEntity);}return ga;};fa.prototype.buildResults=function(ga){"use strict";if(this.dynamicRank)if(ga.length>0)this.entityTop=ga[0].type!==l.keywordType;var ha=String(this.value);ga.forEach(function(ja){ja.query_string=ha;});this.results=ga;if(this.isGSV2)this.results=this.processGSV2Results(ga);var ia=v();this.renderTypeaheadList({results:this.results,loading:this.loading});this.inform('logPerformanceTiming',{field:'build_results_set_props_duration',value:v()-ia});if(this.dynamicRank)this.resultsContainer=this.reGenerateContainer();return this.resultsContainer;};fa.prototype.getGSV2Items=function(){"use strict";var ga=ea.getItems.call(this),ha,ia;if(this.entityTop){ia=ga.slice(0,this.entityResults.length);ha=ga.slice(this.entityResults.length+1,-1);ga=ia.concat(ha);}else{ha=ga.slice(0,this.keywordResults.length);ia=ga.slice(this.keywordResults.length+1,-1);ga=ha.concat(ia);}return ga;};fa.prototype.getItems=function(){"use strict";if(this.isGSV2)return this.getGSV2Items();return ea.getItems.call(this).slice(0,-1);};fa.prototype.handleRender=function(){"use strict";this.items=this.getItems();};fa.prototype.render=function(ga,ha,ia,ja){"use strict";this.inform('filter',{results:ha,value:ga});this.seeMoreResult=null;if(ha.length&&ga.getLength()){this.seeMoreResult=this.inform('seeMore',{value:ga,results:ha});if(!this.loading&&this.seeMoreResult)ha.push(this.seeMoreResult);}var ka=!ga||(ga instanceof m&&ga.isEmptyOrWhitespace());h.conditionClass(this.wrapper,"_5qz2",!ha.length&&ka&&!this.getMegaphone());var la=ha[0];if(ja&&!ka){if(!this.isGSV2){this.showWarning(y._("There are no results for '{query}'",[y.param("query",ga.toString())]));}else ha.push(ca(ga.toString()));}else if(la&&la.results_set_type===ba){if(!la.error_info.suppress)this.showWarning(la.error_info.errorMessage||"This search isn't currently supported.");}else this.hideWarning();if(this.inform('removeUnimplementedGrammar')!==false)ha=ha.filter(function(ma){return ma.results_set_type!==ba;}.bind(this));ea.render.call(this,ga,ha,ia);};fa.prototype.reset=function(){"use strict";this.index=-1;this.items=[];this.results=[];this.value='';this.buildResults([]);this.inform('reset');return this;};fa.prototype.resetIndex=function(){"use strict";this.index=-1;};fa.prototype.getMegaphone=function(){"use strict";return j.scry(this.element,'.megaphone_location_gsv2_typeahead')[0];};fa.prototype.showBlockNotification=function(ga){"use strict";var ha=z('https://www.facebook.com').setPath('/settings').addQueryData('tab','blocking'),ia=r.createElement("div",null,y._("You've blocked {fullName}. For more info on privacy and blocking, go to your {settings}.",[y.param("fullName",ga),y.param("settings",r.createElement(aa,{href:{url:ha}},"settings"))]));h.show(this.blockNotificationNode);r.render(ia,this.blockNotificationNode);};fa.prototype.hideBlockNotification=function(){"use strict";h.hide(this.blockNotificationNode);j.setContent(this.blockNotificationNode,'');};fa.prototype.showWarning=function(ga){"use strict";h.show(this.warningNode);j.setContent(this.warningNode,ga);this.warningShown=true;this.highlight(-1,false);};fa.prototype.hideWarning=function(){"use strict";h.hide(this.warningNode);this.warningShown=false;this.highlight(this.index,false);};fa.prototype.setLoading=function(ga){"use strict";if(this.loading!=ga){this.loading=ga;if(this.seeMoreResult){if(this.loading){this.results.splice(this.results.indexOf(this.seeMoreResult),1);}else this.results.push(this.seeMoreResult);this.buildResults(this.results);}else this.renderTypeaheadList({results:this.results,loading:ga});}};fa.prototype.first=function(){"use strict";this.index=this.autoSelect?0:-1;this.highlight(this.index);};fa.prototype.prev=function(){"use strict";var ga=this.getPrevKey();if(this.isGSV2&&this.index<=-1)if(!this.isCursorKey(ga)){this.index=this.items.length;}else return;if(!this.isGSV2&&this.index<=0)this.index=this.items.length;this.ignoreMouseover=true;ea.prev.call(this);};fa.prototype.next=function(){"use strict";if(this.isGSV2&&this.index>=this.items.length-1)return;if(!this.isGSV2&&this.index+1>=this.items.length)this.index=-1;this.ignoreMouseover=true;ea.next.call(this);};fa.prototype.isCursorKey=function(ga){"use strict";return (ga===p.UP||ga===p.DOWN);};fa.prototype.setPrevKey=function(ga){"use strict";this.prevKey=ga;};fa.prototype.getPrevKey=function(){"use strict";return this.prevKey;};fa.prototype.highlight=function(ga,ha){"use strict";ha=ha!==false&&(this.index!=ga);if(ga===-1)return;if(!ha||this.inform('beforeHighlight')!==false){var ia=this.warningShown||!this.autoSelect?-1:0;ea.highlight.call(this,Math.max(ia,ga),ha);}};fa.prototype.updateCurrentKeywordContainer=function(){"use strict";var ga=this.currentKeywordContainer,ha=!String(this.value).trim();if(ha&&k.hasRecentSearchNullState){this.currentKeywordContainer=this.contentRecent;}else this.currentKeywordContainer=this.contentKeyword;if(ga&&ga!==this.currentKeywordContainer){h.hide(ga);ga.removeChild(this.keywordResultsContainer);this.currentKeywordContainer.appendChild(this.keywordResultsContainer);}};fa.prototype.copyProps=function(ga){"use strict";return u({accessibilityElement:this.accessibilityElement,onRender:this.handleRender,onHighlight:this.handleHighlight,onSelect:this.handleSelect},ga);};fa.prototype.renderList=function(ga,ha){"use strict";r.render(r.createElement(n,r.__spread({},this.copyProps(ga))),ha);};fa.prototype.renderGSV2TypeaheadList=function(ga){"use strict";var ha=this.copyProps(ga),ia=this.copyProps(ga);ha.results=this.keywordResults;ia.results=this.entityResults;if(this.entityTop||ia.results.length===0){ia.loading=false;}else ha.loading=false;var ja=this.entityResults.length===0&&ha.loading&&this.keywordResults.length===1&&this.keywordResults[0].exactMatchKeyword;this.renderList(ha,this.keywordResultsContainer);this.renderList(ia,this.entityResultsContainer);this.updateCurrentKeywordContainer();h.conditionShow(this.currentKeywordContainer,!!this.keywordResults.length);h.conditionShow(this.contentEntity,!!this.entityResults.length);h.conditionClass(this.element,"_1z7e",ja);};fa.prototype.renderTypeaheadList=function(ga){"use strict";ga=ga||{};if(this.isGSV2){this.renderGSV2TypeaheadList(ga);}else this.renderList(ga,this.resultsContainer);};e.exports=fa;},null);
__d("FacebarTypeaheadDecorateEntities",["arrayContains","copyProperties","emptyFunction"],function(a,b,c,d,e,f,g,h,i){function j(n){var o=[];n.forEach(function(p){if(p.isType('ent'))o.push(p.getUID());});return o;}function k(n,o){var p=null;n.structure.forEach(function(q){if(q.isType('ent')&&!g(o,q.getUID()))p=q;});return p;}function l(n,o,p){n.forEach(function(q){var r=k(q,o);q.decoration={entity:r&&p.getEntryForFragment(r)};});}function m(n){"use strict";this._typeahead=n;}m.prototype.enable=function(){"use strict";this._typeahead.view.subscribe('filter',function(n,o){l(o.results,j(this._typeahead.core.getValue()),this._typeahead.data);}.bind(this));};h(m.prototype,{disable:i});e.exports=m;},null);
__d("FacebarTypeaheadDisambiguateResults",["FacebarDisambiguationDialog","FacebarStructuredFragment","FacebarStructuredText","URI","copyProperties","emptyFunction","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(w,x){var y={};w.forEach(function(ba){if(ba.type=='grammar'){var ca=x(ba.structure).toLowerCase();y[ca]=y[ca]||[];y[ca].push(ba);}});var z=[];for(var aa in y)if(y[aa].length>1)z.push(y[aa]);return z;}function o(w){var x=[];w.toArray().forEach(function(y,z){if(y.isType('ent'))x.push(z);});return x;}function p(w,x,y){var z={},aa={},ba={};x.forEach(function(da){var ea=w[0].structure.getFragment(da),fa=ea.getHash();aa[fa]=aa[fa]||[];ba[da]=aa[fa];w.forEach(function(ga){var ha=ga.structure.getFragment(da),ia=ha&&ha.getUID();if(ia&&!z.hasOwnProperty(ia)){aa[fa].push(y.getEntryForFragment(ha));z[ia]=true;}});});for(var ca in ba)if(ba[ca].length<=1)delete ba[ca];return ba;}function q(w,x){var y={},z=[];w.forEach(function(aa){var ba=aa.structure.getFragment(x).getUID();if(!y.hasOwnProperty(ba)){y[ba]=z.length;z.push([]);}z[y[ba]].push(aa);});return z;}function r(w,x,y){var z=w.shift();z.ambiguity.entities=x;y.push.apply(y,w);return z;}function s(w,x){var y=[],z=[],aa=false;w.forEach(function(ca){ca.ambiguity={fragment:null,entities:null,text:null};});n(w,function(ca){return ca.getHash();}).forEach(function(ca){var da=ca[0].structure,ea=o(da),fa=p(ca,ea,x);if(aa){r(ca,fa,y);return;}var ga=ea.pop();if(typeof ga=='number'){var ha=q(ca,ga);aa=ha.length>1;if(aa)delete fa[ga];ha.forEach(function(ia){var ja=r(ia,fa,y);if(aa){var ka=ja.structure.getFragment(ga).getUID();ja.ambiguity.entity=x.getEntry(ka);z.push(ja);}});}});y.forEach(function(ca){var da=w.indexOf(ca);da!=-1&&w.splice(da,1);});n(w,function(ca){return ca.toString();}).forEach(function(ca){ca.forEach(function(da){if(!da.ambiguity.entities)da.ambiguity.text=da.queryTypeText;});});var ba=w.indexOf(z[0]);z.slice(1).forEach(function(ca){var da=w.indexOf(ca);if(da!=-1&&da!=++ba){w.splice(da,1);w.splice(ba,0,ca);}});}function t(w,x){var y=w&&w.ambiguity&&w.ambiguity.entities,z=y&&Object.keys(y).map(Number),aa=x.core.input;if(!z||z.length===0)return false;var ba=function(ea){x.core.executeQuery(u(w,z,ea));},ca=function(){aa.focus();aa.input.moveSelectionToEnd();};y=y?m(y):[];var da=new g(y,w.uri.getPath(),ba,ca,x.getCore().getSessionID());aa.blur();da.show();return true;}function u(w,x,y){var z=w.structure.toArray(),aa=j(w.uri),ba=aa.getPath().split('/');x.forEach(function(ca){var da=z[ca],ea=y.shift(),fa=ba.indexOf(String(da.getUID()));if(fa!=-1)ba[fa]=ea.uid;z[ca]=new h({uid:ea.uid,text:ea.text,type:'ent:'+ea.type});});return {uri:aa.setPath(ba.join('/')),structure:new i(z)};}function v(w){"use strict";this._typeahead=w;}v.prototype.enable=function(){"use strict";this._typeahead.view.subscribe('filter',function(w,x){s(x.results,this._typeahead.data);}.bind(this));this._typeahead.view.subscribe('beforeSelect',function(w,x){return !t(x.selected,this._typeahead);}.bind(this));};k(v.prototype,{disable:l});e.exports=v;},null);
__d("FacebarTypeaheadNavigation",["Arbiter","FacebarNavigation","copyProperties","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j){function k(l){"use strict";this._core=l.core;this._preserveQuery=false;this._typeahead=l;}k.prototype.enable=function(){"use strict";h.registerBehavior(this);this._core.subscribe('execute',this.executedUserQuery.bind(this));};k.prototype.executedUserQuery=function(l,m){"use strict";this._preserveQuery=true;};k.prototype.pageTransition=function(){"use strict";if(!this._preserveQuery){this._core.close();this._core.reset();}else this._preserveQuery=false;};k.prototype.setPageQuery=function(l){"use strict";l=this._core.setPageQuery(l);this._typeahead.inform('navigation',l,g.BEHAVIOR_PERSISTENT);};i(k.prototype,{disable:j});e.exports=k;},null);
__d("FacebarTypeaheadPrefixLengthOrderedCache",["copyProperties","emptyFunction","Arbiter"],function(a,b,c,d,e,f,g,h,i){function j(k){"use strict";this._typeahead=k;}j.prototype.enable=function(){"use strict";this._typeahead.data.inform('setSortFunction',function(k,l){if(k.cache_id_length!==l.cache_id_length)return k.cache_id_length-l.cache_id_length;var m=(k.cost||0)-(l.cost||0);if(m!==0)return m;return (k.semantic||'').localeCompare(l.semantic||'');},i.BEHAVIOR_STATE);};g(j.prototype,{disable:h});e.exports=j;},null);
__d("FacebarTypeaheadQuickSelect",["FacebarStructuredText","URI"],function(a,b,c,d,e,f,g,h){var i='/search/web/direct_search.php';function j(k){"use strict";this._core=k.getCore();this._view=k.getView();this._input=this._core.input;this._beforeSelectListener=null;this._quickSelectListener=null;}j.prototype.enable=function(){"use strict";this._beforeSelectListener=this._view.subscribe('beforeSelect',this._quickSelect.bind(this));this._quickSelectListener=this._view.subscribe('quickSelect',this._quickSelect.bind(this));};j.prototype._quickSelect=function(k,l){"use strict";if(l&&l.selected)return true;var m=this._input.getValue().toArray(),n=new g(m),o=n.toString();if(!o)return true;var p=h(i).addQueryData('q',o),q={input_query:o,type:'quickselect',text:o,position:0,with_mouse:0,semantic:'quickselect('+p.toString()+')',extra_uri_params:{source:'quickselect',sid:this._core.getSessionID()},uri:p};this._core.inform('quickSelectRedirect',q);this._core.executeQuery(q);return false;};j.prototype.disable=function(){"use strict";this._beforeSelectListener&&this._view.unsubscribe(this._beforeSelectListener);this._quickSelectListener&&this._view.unsubscribe(this._quickSelectListener);};e.exports=j;},null);
__d("FacebarTypeaheadRecorderBasic",["FacebarTypeaheadRecorder","copyProperties"],function(a,b,c,d,e,f,g,h){function i(j){"use strict";this._typeahead=j;}i.prototype.enable=function(){"use strict";var j=this._typeahead;this._recorder=new g(j);};i.prototype.disable=function(){"use strict";this._typeahead.unsubscribe(this._subscription);this._recorder=null;this._subscription=null;};h(i.prototype,{_subscription:null});e.exports=i;},null);
__d("FacebarTypeaheadSelectAll",["requestAnimationFrame"],function(a,b,c,d,e,f,g){function h(i){"use strict";this._core=i.getCore();this._listener=null;}h.prototype.enable=function(){"use strict";var i=this._core.input;this._listener=this._core.subscribe('focus',function(j,k){var l=k&&k.catchup;l||g(function(){i.selectInput();});});};h.prototype.disable=function(){"use strict";this._listener&&this._core.unsubscribe(this._listener);};e.exports=h;},null);
__d("FacebarTypeaheadShortcut",["FacebarTypeaheadShortcutConfig","KeyEventController","Run","copyProperties","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m){"use strict";this._input=m.core.input;this._view=m.view;this._listener=null;}l.prototype.enable=function(){"use strict";this._registerListener();};l.prototype._registerListener=function(){"use strict";h.registerKey('SLASH',this._handleKeydown.bind(this));i.onLeave(function(){setTimeout(this._registerListener.bind(this),0);}.bind(this));};l.prototype._handleKeydown=function(m){"use strict";var n=m.getModifiers().shift;if(n&&!g.gkWebShortcut)return;this._view.setAutoSelect(true);this._input.focus();this._input.selectInput();this._input.inform('shortcut',{shift:n});return false;};j(l.prototype,{disable:k});e.exports=l;},null);
__d("FacebarTypeaheadSizeAdjuster",["copyProperties","getElementChildren","confine","emptyFunction","isTextNode","Style","Vector"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=12,o=20,p=50,q=200,r=5;function s(u){if(k(u))return 0;return m.getElementDimensions(u).x;}function t(u){"use strict";this._core=u.getCore();this._view=this._core.view;this._input=this._core.input;this._cachedSizes={};this._appliedSize=null;this._defaultSize=this.getDefaultFontSize();this._calculatedSize=this._defaultSize;this._containerWidth=this.getContainerWidth();}t.prototype.enable=function(){"use strict";this._input.subscribe('change',this.adjustFontSize.bind(this));this.adjustFontSize();};t.prototype.getContainerWidth=function(){"use strict";return m.getElementDimensions(this._input.getElement()).x;};t.prototype.getDefaultFontSize=function(){"use strict";var u=l.get(this._input.getElement(),'font-size'),v=/^([\d\.]+)px$/.exec(u),w=v&&Number(v[1]);return Math.max(n,Math.min(o,w));};t.prototype.calculateFontSize=function(){"use strict";var u=this.getTextWidth(),v=this._calculatedSize;if(u>this._containerWidth-p){v--;}else if(u<this._containerWidth-q)v++;this._calculatedSize=i(v,n,this._defaultSize);return this._calculatedSize;};t.prototype.getTextWidth=function(){"use strict";var u=this._calculatedSize+this.getValueKey();if(!this._cachedSizes.hasOwnProperty(u))this._cachedSizes[u]=this.measureTextWidth();return this._cachedSizes[u];};t.prototype.getValueKey=function(){"use strict";var u=this._core.getValue().getHash(),v=r*Math.floor(u.length/r);return u.substr(0,v);};t.prototype.measureTextWidth=function(){"use strict";var u=h(this._input.getRawInputElement());return u.reduce(function(v,w){return v+s(w);},0);};t.prototype.adjustFontSize=function(){"use strict";for(var u=0;u<10;u++){var v=this.calculateFontSize();if(v!=this._appliedSize){this._appliedSize=v;l.set(this._input.getElement(),'font-size',v+'px');l.set(this._view.content,'font-size',v+'px');}else break;}};g(t.prototype,{disable:j});e.exports=t;},null);
__d("TypeaheadSearchMegaphone",["AsyncRequest","DOM","DOMQuery","Event","Parent"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m){"use strict";this.$TypeaheadSearchMegaphone0=m;}l.prototype.enable=function(){"use strict";var m=i.scry(this.$TypeaheadSearchMegaphone0.getView().getElement(),'.megaphone_location_gsv2_typeahead')[0];if(!m)return;this.ajaxify=i.scry(m,'a.megaphone_hide_link[ajaxify]')[0].getAttribute('ajaxify');i.scry(m,'a').forEach(this.processLink,this);j.listen(m,'click',this.onClick.bind(this));};l.prototype.disable=function(){"use strict";};l.prototype.processLink=function(m){"use strict";if(m.getAttribute('ajaxify'))return;h.setAttributes(m,{target:'_blank'});};l.prototype.onClick=function(event){"use strict";var m=k.byTag(event.target,'a');if(!m||m.getAttribute('ajaxify'))return;g.bootstrap(this.ajaxify,m);};e.exports=l;},null);