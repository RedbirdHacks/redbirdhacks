/*!CK:2504782087!*//*1422601661,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["+64eR"]); }

__d("ItunesPluginLogging",["Run","Bootloader"],function(a,b,c,d,e,f,g){var h={logPluginData:function(){g.onAfterLoad(function(){var i=b('Bootloader');i.loadModules(["ItunesDetector","AsyncRequest"],function(j,k){new k().setURI('/ajax/ads/media/log').setData({status:j.hasItunes()}).send();});});}};e.exports=h;},null);
__d("BuddyListNub",["Arbiter","AvailableList","BlackbirdUpsell","ChannelConnection","ChannelConstants","ChatConfig","ChatSidebar","ChatVisibility","CSS","Dock","DOM","Event","JSLogger","JSXDOM","KeyEventController","Keys","NubController","OrderedFriendsList","Parent","PresencePrivacy","PresenceStatus","Toggler","csx","cx","setTimeoutAcrossTransitions","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa){var ga=32,ha=s.create('buddylist_nub');for(var ia in w)if(w.hasOwnProperty(ia))ka[ia]=w[ia];var ja=w===null?null:w.prototype;ka.prototype=Object.create(ja);ka.prototype.constructor=ka;ka.__superConstructor__=w;function ka(la,ma,na){"use strict";w.call(this);ja.init.call(this,la);this.root=la;this.orderedList=ma;this.typeahead=na;this.button=q.find(la,'a.fbNubButton');this.unreadCount=q.find(la,"span._5ayx");this.label=q.find(la,'span.label');this.body=q.scry(la,'div.fbNubFlyoutBody')[0];this.container=y.byClass(la,"_56ox");this.typeaheadContainer=q.find(la,'.fbChatTypeaheadViewContainer');var oa=q.find(la,'div.fbNubFlyoutTitlebar');ba.createInstance(oa).setSticky(false);ma.subscribe('render',this.flyoutContentChanged.bind(this));ma.setScrollContainer(this.body);h.subscribe('buddylist/availability-changed',this._updateCount.bind(this));g.subscribe('chat/connect',this._handleConnect.bind(this));g.subscribe('chat/option-changed',function(pa,qa){if(qa.name=='hide_groups')this.onResize();}.bind(this));z.subscribe('privacy-user-presence-changed',this._handleVisibilityChange.bind(this));this.message=q.find(la,"div._4mq1");this.warningMsgText=null;this.warningMsgEventListener=null;this.showWarningTimeout=null;j.subscribe(j.CONNECTED,this._handleChannelConnected.bind(this));j.subscribe(j.SHUTDOWN,this._handleChannelShutdown.bind(this));j.subscribe(j.RECONNECTING,this._handleChannelReconnecting.bind(this));j.subscribe([j.MUTE_WARNING,j.UNMUTE_WARNING],this._updateView.bind(this));this.subscribe('show',this.onShow.bind(this));this.subscribe('hide',this.onHide.bind(this));this.subscribe('resize',this.onResize.bind(this));r.listen(la,'keydown',this._onKeyDown.bind(this));r.listen(this.button,'click',this.onButtonClick.bind(this));u.registerKey('q',function(event){if(this._isOpen){na.getCore().getElement().focus();}else{this.onButtonClick();this.show();}event.prevent();}.bind(this));na.getCore().subscribe('escape',this.hide.bind(this));na.subscribe(['respond','reset'],function(pa,qa){if(this._isOpen){if(qa&&qa.value&&qa.value===na.getCore().getValue()&&na.getView().isVisible()){p.setUseMaxHeight(this.root,false);this._hideBuddyList();}else this._showBuddyList();this.flyoutContentChanged();}}.bind(this));g.subscribe('sidebar/show',this.hide.bind(this));g.subscribe('minisidebar/show',this.hide.bind(this));g.subscribe('sidebar/hide',this._onSidebarHide.bind(this));this._orderedListCount=x.getList().length;g.inform('buddylist-nub/initialized',this,g.BEHAVIOR_PERSISTENT);this._handleVisibilityChange();ha.log('buddylist_initialized');}ka.prototype.getButton=function(){"use strict";return this.button;};ka.prototype.getRoot=function(){"use strict";return this.root;};ka.prototype._handleConnect=function(la){"use strict";this._updateView(true);};ka.prototype._getShutdownReason=function(la){"use strict";switch(la){case k.HINT_AUTH:return "Your session has timed out. Please log in.";case k.HINT_CONN:return fa._("Facebook {Chat} is currently unavailable.",[fa.param("Chat","Chat")]);case k.HINT_MAINT:return fa._("Facebook {Chat} is currently down for maintenance.",[fa.param("Chat","Chat")]);default:return fa._("Facebook {Chat} is currently unavailable.",[fa.param("Chat","Chat")]);}};ka.prototype._getReconnectMsg=function(la){"use strict";var ma;if(la===null||false===navigator.onLine){ma="Unable to connect to chat. Check your Internet connection.";}else if(la>l.get('warning_countdown_threshold_msec')){var na=q.create('a',{href:'#',className:'fbChatReconnectLink'},"Try again"),oa=q.create('div',null,na),pa=oa.innerHTML;ma=fa._("Unable to connect to chat. {try-again-link}",[fa.param("try-again-link",pa)]);}else if(la>1000){ma=fa._("Unable to connect to chat. Reconnecting in {seconds}...",[fa.param("seconds",Math.floor(la/1000))]);}else ma="Unable to connect to chat. Reconnecting...";return ma;};ka.prototype._resetShowWarningTimeout=function(){"use strict";if(this.showWarningTimeout){clearTimeout(this.showWarningTimeout);this.showWarningTimeout=null;}};ka.prototype._handleChannelConnected=function(la){"use strict";this._resetShowWarningTimeout();if(this.orderedList.isVisible())n.goOnline();this.warningMsgText=null;this._updateView();};ka.prototype._handleChannelShutdown=function(la,ma){"use strict";this._resetShowWarningTimeout();this.warningMsgText=this._getShutdownReason(ma);this._updateView();};ka.prototype._handleChannelReconnecting=function(la,ma){"use strict";this._resetShowWarningTimeout();this.warningMsgText=this._getReconnectMsg(ma);if(ma>1000){if(ma>l.get('warning_countdown_threshold_msec')){if(this.warningMsgEventListener){this.warningMsgEventListener.remove();this.warningMsgEventListener=null;}this.warningMsgEventListener=r.listen(this.message,'click',function(event){if(o.hasClass(event.getTarget(),'fbChatReconnectLink')){this._tryReconnect();event.kill();}}.bind(this));}this.showWarningTimeout=ea(this._handleChannelReconnecting.bind(this,la,ma-1000),1000);}this._updateView();};ka.prototype._tryReconnect=function(){"use strict";if(j.disconnected())j.reconnect();};ka.prototype._handleVisibilityChange=function(){"use strict";this._updateView();if(i.shouldShow()){if(n.hasBlackbirdEnabled()){i.showBlackbirdDialog(this.getButton(),z.getVisibility());}else if(!n.isOnline())i.showOfflineDialog(this.getButton());}else i.hide();if(!n.isOnline())this.hide();};ka.prototype._updateView=function(la){"use strict";var ma=this.container;if(ma){o.conditionClass(ma,'offline',!n.isOnline());o.conditionClass(ma,'error',j.disconnected());}if(j.disconnected())q.setContent(this.message,this.warningMsgText);var na,oa;if(!n.isOnline()){na=fa._("{Chat} (Off)",[fa.param("Chat","Chat")]);}else if(j.disconnected()){na=fa._("{Chat} (Disconnected)",[fa.param("Chat","Chat")]);}else{var pa=aa.getOnlineCount();if(pa){var qa=t.span({className:"count"},"(",pa,")");na=fa._("{Chat} {number-available}",[fa.param("Chat","Chat"),fa.param("number-available",qa)]);}else{na="Chat";oa=true;}}this._setUnread(this._unreadMessageCount);this._setLabel(na,oa);this.buttonContentChanged();};ka.prototype.onButtonClick=function(){"use strict";if(o.shown(this.typeahead.getElement())){var la=this.subscribe('show',function(){this.typeahead.getCore().getElement().focus();i.dismiss();}.bind(this));setTimeout(this.unsubscribe.bind(this,la),0);}};ka.prototype.onHide=function(){"use strict";this._isOpen=false;if(this._buddyListRenderSubscription){this.orderedList.unsubscribe(this._buddyListRenderSubscription);this._buddyListRenderSubscription=null;}this._hideBuddyList();this.typeahead.getCore().reset();};ka.prototype._onKeyDown=function(event){"use strict";var la=r.getKeyCode(event);if(la===v.ESC&&!o.hasClass(this.root,'menuOpened')){this.hide();return false;}else if(la==v.RETURN)m.enable();};ka.prototype._onSidebarHide=function(event){"use strict";this.getButton().focus();};ka.prototype.onResize=function(){"use strict";var la=p.getMaxFlyoutHeight(this.root)-60,ma=Math.max(250,la);this.orderedList.setNumTopFriends(Math.floor(ma/ga));};ka.prototype._showBuddyList=function(){"use strict";if(!this._buddyListRenderSubscription)this._buddyListRenderSubscription=this.orderedList.subscribe('render',p.setUseMaxHeight.bind(p,this.root,false));o.hide(this.typeaheadContainer);this.orderedList.show();ha.bump('buddylist_show');};ka.prototype._hideBuddyList=function(){"use strict";o.show(this.typeaheadContainer);this.orderedList.hide();ha.bump('buddylist_hide');};ka.prototype.onShow=function(){"use strict";this._isOpen=true;if(j.disconnected()){this._tryReconnect();this._showBuddyList();}else n.goOnline(this._showBuddyList.bind(this));};ka.prototype._setLabel=function(la,ma){"use strict";var na=this.label.cloneNode(true);q.setContent(na,la);q.replace(this.label,na);this.label=na;this.throbber&&o.conditionShow(this.throbber,!!ma);};ka.prototype._setUnread=function(la){"use strict";o.conditionShow(this.unreadCount,!!la);if(la){la=t.span({className:"_51jx _5ayw"},la);q.setContent(this.unreadCount,la);}};ka.prototype._updateCount=function(){"use strict";this._updateView();};e.exports=ka;},null);
__d("NotificationImpressions",["AsyncSignal","NotificationTokens","URI"],function(a,b,c,d,e,f,g,h,i){var j='/ajax/notifications/impression.php';function k(l,m){var n={ref:m};h.untokenizeIDs(l).forEach(function(o,p){n['alert_ids['+p+']']=o;});new g(i(j).getQualifiedURI().toString(),n).send();}e.exports={log:k};},null);
__d("NotificationBeeperItemContents.react",["Animation","AsyncRequest","Bootloader","CloseButton.react","ImageBlock.react","InlineStoryInsert","NotificationURI","NotificationUserActions","React","TextWithEntities.react","Timestamp.react","URI","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(v,w){return o.createElement("span",{className:"fwb"},v);}var u=o.createClass({displayName:"NotificationBeeperItemContents",_markAsRead:function(){n.markNotificationsAsRead([this.props.beep.notificationID]);},_onClick:function(v){this._markAsRead();this.props.onHide();if(v.button===1||v.altKey||v.ctrlKey||v.metaKey||v.shiftKey)return;var w=this.props.beep,x=r(w.url).getPath();if(m.isAlbumDraftRecoveryDialogURI(w.link)){new h(w.link).send();v.preventDefault();}else if(w.photo&&m.snowliftable(w.link)){i.loadModules(["PhotoSnowlift"],function(y){y.bootstrap(w.link,v.currentTarget);});v.preventDefault();}else if(w.eligibleToRenderInFeed){if(!l._isInFeed()){l.gotoPermalink(w.link);}else l._insert(w.link,x,w.notifID);v.preventDefault();}else if(w.ajaxifyLink){i.loadModules(["AsyncDialog"],function(y){y.bootstrap(w.ajaxifyLink,v.currentTarget,'dialog');});v.preventDefault();}},_onClose:function(){this._markAsRead();this.props.onHide();},_doFlash:function(){new g(this.refs.inner.getDOMNode()).from('opacity','0').to('opacity','1').duration(200).go();},componentDidMount:function(){this.props.onReadyToHide(this.props.beep.notificationID);},componentDidUpdate:function(v){if(v.beep.beepID!==this.props.beep.beepID){this._doFlash();this.props.onReadyToHide(this.props.beep.notificationID);}},render:function(){var v=this.props.beep;return (o.createElement("div",{ref:"inner"},o.createElement(j,{className:"_3soc",onClick:this._onClose,size:"medium"}),o.createElement("a",{href:v.link,onClick:this._onClick,className:"_3soi"},o.createElement(k,{className:"_3soj",spacing:"medium"},o.createElement("img",{src:v.actors[0].profile_picture.uri,className:"_3sok"}),o.createElement("div",{className:"_3sol"},o.createElement(p,{renderEmoticons:true,renderEmoji:true,interpolator:t,ranges:v.text.ranges,aggregatedranges:v.text.aggregated_ranges,text:v.text.text}),o.createElement(k,{className:"_3som"},o.createElement("img",{className:"_1x8t",src:v.icon.uri}),o.createElement(q,{time:v.timestamp.time,text:v.timestamp.text,verbose:v.timestamp.verbose})))))));}});e.exports=u;},null);
__d("NotificationBeeperConst",["keyMirror"],function(a,b,c,d,e,f,g){var h={IDLE_DELAY:10000,ACTIVE_DELAY_LONG:4000,FADE_OUT_LENGTH:1500,BeepStates:g({PENDING:true,RENDERED:true,READY_TO_HIDE:true,FADING_OUT:true})};e.exports=h;},null);
__d("NotificationBeeperItem.react",["Animation","BrowserSupport","NotificationBeeperItemContents.react","React","NotificationBeeperItemRenderersList","Style","NotificationBeeperConst","cx","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=j.createClass({displayName:"NotificationBeeperItem",getInitialState:function(){return {fadedIn:false,hidden:false};},componentDidMount:function(){var q;if(h.hasCSSAnimations()){q=this.setState.bind(this,{fadedIn:true},null);}else q=function(){new g(this.refs.item.getDOMNode()).from('top','-30px').from('opacity','0').to('top','0px').to('opacity','1').duration(200).ondone(this.setState.bind(this,{fadedIn:true},null)).go();}.bind(this);o(q,50);this.props.onInserted(this.props.beep);},componentWillUnmount:function(){if(this._fadeOutAnimation){this._fadeOutAnimation.stop();this._fadeOutAnimation=null;}},_onHide:function(){this.setState({hidden:true});},render:function(){var q=this.props.beep,r=(("_3sod")+(this.state.fadedIn?' '+"_3soe":'')+(this.state.hidden?' '+"_3sof":'')),s=this._getRenderer(q.beepRenderer);return (j.createElement("li",{className:r,ref:"item","data-gt":q.tracking},j.createElement(s,{beep:q,onHide:this._onHide,onReadyToHide:this.props.onReadyToHide,ref:"itemContents"})));},componentDidUpdate:function(q,r,s){if(this.props.fadingOut){if(!this._fadeOutAnimation)this._fadeOutAnimation=new g(this.refs.item.getDOMNode()).from('opacity','1').to('opacity','0').duration(m.FADE_OUT_LENGTH).ondone(this._onHide).go();this.refs.item.getDOMNode().style.transitionDuration='0ms';}else if(this._fadeOutAnimation){this._fadeOutAnimation.stop();this._fadeOutAnimation=null;l.set(this.refs.item.getDOMNode(),'opacity','1');}},_getRenderer:function(q){if(q in k)return k[q];return i;}});e.exports=p;},null);
__d("NotificationSound",["Sound","copyProperties"],function(a,b,c,d,e,f,g,h){var i=5000;g.init(['audio/mpeg']);function j(k){this._soundPath=k;this._lastPlayed=0;}h(j.prototype,{play:function(k){if(!this._soundPath)return;var l=Date.now();if((l-this._lastPlayed)<i)return;this._lastPlayed=l;g.play(this._soundPath,k);}});e.exports=j;},null);
__d("NotificationBeeper.react",["Arbiter","ChannelConstants","NotificationBeeperItem.react","NotificationConstants","NotificationImpressions","NotificationPhotoThumbnail","NotificationSound","NotificationUpdates","NotificationURI","NotificationUserActions","React","XPermalinkDialogController","NotificationBeeperConst","NotificationBeeperPinnedPostLoader","cx","isEmpty","setTimeoutAcrossTransitions","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){var y=s.BeepStates,z='beeper',aa=j.PayloadSourceType.LIVE_SEND,ba=j.PayloadSourceType.OTHER_APPLICATION,ca=q.createClass({displayName:"NotificationBeeper",propTypes:{},getInitialState:function(){return {soundEnabled:this.props.soundEnabled,hovering:false,fading:false,beeps:{}};},componentWillMount:function(){var da=h.getArbiterType('notif_sound_pref_changed'),ea='update-notifications';this.subscriptions=[n.subscribe(ea,function(fa,ga){if(ga.payloadsource===aa||ga.payloadsource===ba){var ha=ga.nodes;if(ha&&ha.length)this._handleBeepChanges(this._convertNotifications(ha));}}.bind(this)),g.subscribe(da,function(fa,ga){this.setState({soundEnabled:ga.obj.enabled});}.bind(this))];g.inform('NotificationBeeper/mounted',null,g.BEHAVIOR_PERSISTENT);if(t.payload)this._handleBeepChanges(this._convertNotifications(t.payload.nodes));},componentWillUnmount:function(){this.subscriptions.forEach(function(da){da.unsubscribe();});this.subscriptions=null;},_onMouseEnter:function(){this._hideWait&&clearTimeout(this._hideWait);var da=[],ea=this.state.beeps;Object.keys(ea).forEach(function(fa){if(ea[fa].state!=y.PENDING){da.push(fa);}else ea[fa].state=y.RENDERED;});p.markNotificationsAsSeen(da);this.setState({hovering:true,fading:false,beeps:ea});},_onMouseLeave:function(){this._waitToHide(s.ACTIVE_DELAY_LONG);this.setState({hovering:false});},_onInsertedItem:function(da){if(!this.state.hovering)this._waitToHide();if(this.state.soundEnabled&&da.sound){if(!this._notifSound)this._notifSound=new m(this.props.soundPath);this._notifSound.play(da.beepID);}if(this.props.shouldLogImpressions)k.log([da.notificationID],z);},_waitToHide:function(da){this._hideWait&&clearTimeout(this._hideWait);this._hideWait=w(x(this._hide,this),da||s.IDLE_DELAY);},_onReadyToHide:function(da){this.state.beeps[da].state=y.READY_TO_HIDE;if(!this._hideWait)this._waitToHide();},_hide:function(){this._hideWait=null;var da=this.state.beeps;Object.keys(da).forEach(function(ea){if(da[ea].state==y.READY_TO_HIDE)da[ea].state=y.FADING_OUT;});this.setState({fading:true});w(x(this._finishHide,this),s.FADE_OUT_LENGTH);},_finishHide:function(){if(!this.state.fading)return;var da=this.state.beeps;Object.keys(da).forEach(function(ea){if(da[ea].state==y.FADING_OUT)delete da[ea];});this.setState({fading:false,beeps:da});w(function(){var ea=this.state.beeps;Object.keys(ea).forEach(function(fa){if(ea[fa].state==y.PENDING)ea[fa].state=y.RENDERED;});this.setState({beeps:ea});}.bind(this));},_handleBeepChanges:function(da){var ea=this.state.fading?y.PENDING:y.RENDERED,fa=this.state.beeps,ga=false;Object.keys(da).reverse().forEach(function(ha){var ia={state:ea,data:da[ha]};if(!fa[ha]||fa[ha].data.beepID!=ia.data.beepID){if(fa[ha]){ga=true;if(ia.data.beepUpdatesOnTop)delete fa[ha];}fa[ha]=ia;}});if(ga)this._waitToHide();this.forceUpdate();},render:function(){var da=this.state.beeps,ea={};Object.keys(da).reverse().forEach(function(ha){var ia=da[ha];if(ia.state==y.PENDING)return;ia.data.eligibleToRenderInFeed=ia.data.hasEntStory&&this.props.storyInsert;ea[ha]=q.createElement(i,{fadingOut:this.state.fading&&ia.state==y.FADING_OUT,beep:ia.data,onInserted:this._onInsertedItem,onReadyToHide:this._onReadyToHide});},this);var fa=!v(ea),ga=((!fa?"hidden_elem":'')+(' '+"_50d1"));return (q.createElement("ul",{ref:"container",className:ga,"data-gt":this.props.tracking,onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave},ea));},_convertNotifications:function(da){var ea={};da.forEach(function(fa){if(!fa.showBeep)return;var ga=fa.alert_id,ha=ga+'-'+fa.receivedTime,ia=l.getThumbnail(fa.attachments,fa.attached_story),ja=ea[ga]={notificationID:ga,notifID:fa.id,beepID:ha,beepRenderer:fa.beepRenderer,rendererData:fa.rendererData,beepUpdatesOnTop:fa.beepUpdatesOnTop,actors:fa.unaggregatedActors||fa.actors,icon:fa.icon,link:fa.url?o.localize(fa.url):'#',url:fa.url,ajaxifyLink:fa.ajaxify_url,hasPermalinkDialog:fa.hasPermalinkDialog,hasEntStory:fa.hasEntStory,photo:ia,text:fa.unaggregatedTitle||fa.title,timestamp:fa.timestamp,receivedTime:fa.receivedTime,sound:!!fa.sound,tracking:fa.tracking};if(ja.hasPermalinkDialog&&this.props.shouldShowPermalinkDialog)ja.ajaxifyLink=r.getURIBuilder().setString('uri',ja.link).getURI().toString();}.bind(this));return ea;}});e.exports=ca;},null);
__d("MissedVideoCallHandler",["AsyncRequest","Dialog","VideoCallSupport"],function(a,b,c,d,e,f,g,h,i){var j={_missedCallDialog:null,_shouldSuppressMissedCallDialogs:false,onMissedCall:function(k,l){if(!i.isVideoCallSupported()||this._shouldSuppressMissedCallDialogs)return;var m='/ajax/chat/video/missed_call.php?idTarget='+k.from,n=new h().setAsync(new g(m));if(l){this._missedCallDialog=n;}else{n.show();this._shouldSuppressMissedCallDialogs=true;}},showDialog:function(){if(!!this._missedCallDialog){this._missedCallDialog.show();this._shouldSuppressMissedCallDialogs=true;}},resetDialog:function(){this._missedCallDialog=null;},setSuppressAll:function(k){this._shouldSuppressMissedCallDialogs=k;}};e.exports=j;},null);
__d("FBRTCStruct",[],function(a,b,c,d,e,f){var g=function(i,j,k){var l,m;if(typeof i=='string'||i instanceof String){m=i;l=i;}else for(var n in i)if(i.hasOwnProperty(n))if(n==='index'){k=i[n];}else{m=n;l=i[n];}j[m]=k;j.strNames[k]=l;};function h(i){"use strict";this.strNames=[];for(var j=0;j<i.length;j++)g(i[j],this,j);}e.exports=h;},null);
__d("FBRTCConstants",["FBRTCStruct"],function(a,b,c,d,e,f,g){var h={OFFER:'offer',ANSWER:'answer',ICE_CANDIDATE:'ice_candidate',OK:'ok',HANGUP:'hang_up',OTHER_DISMISS:'other_dismiss',MSG_ACK:'msg_ack',PRANSWER:'pranswer',ICERESTART_OFFER:'icerestart_offer',ICERESTART_ANSWER:'icerestart_answer',OFFER_ACK:'offer_ack',OFFER_NACK:'offer_nack',ANSWER_ACK:'answer_ack',SET_VIDEO:'set_video'},i=new g([{IGNORE_CALL:'IgnoreCall'},{HANGUP_CALL:'HangupCall'},{IN_ANOTHER_CALL:'InAnotherCall'},{ACCEPT_AFTER_HANGUP:'CallEndAcceptAfterHangUp'},{NO_ANSWER_TIMEOUT:'NoAnswerTimeout'},{INCOMING_TIMEOUT:'IncomingTimeout'},{OTHER_INSTANCE_HANDLED:'OtherInstanceHandled'},{SIGNALING_MESSAGE_FAILED:'SignalingMessageFailed'},{CONNECTION_DROPPED:'ConnectionDropped'},{CLIENT_INTERRUPTED:'ClientInterrupted'},{WEBRTC_ERROR:'WebRTCError'},{CLIENT_ERROR:'ClientError'},{NO_PERMISSION:'NoPermission'},{OTHER_NOT_CAPABLE:'OtherNotCapable'},{NO_UI_ERROR:'NoUIShown'},{UNSUPPORTED_VERSION:'VersionUnsupported'},{CALLER_NOT_VISIBLE:'CallerNotVisible'},{CARRIER_BLOCKED:'CarrierBlocked'},{OTHER_CARRIER_BLOCKED:'OtherCarrierBlocked'}]),j={HANG_UP:1,TOGGLE_MUTE_AUDIO:2,TOGGLE_MUTE_VIDEO:3,TOGGLE_FULL_SCREEN:4,TOGGLE_SELF_VIEW:5,SUBMIT_STAR_RATING:6,SUBMIT_FEEDBACK:7,SHOW_SETTINGS:8},k={PayloadType:h,CallEndReason:i,UIEventType:j,endCallReasonFromString:function(l){return i.strNames.indexOf(l);},callEndReasonString:function(l){if(l<0||l>i.strNames.length)return 'Unknown';return i.strNames[l];},fullCallEndReasonString:function(l,m){return this.callEndReasonString(l)+'_'+(m?'remote':'local');}};e.exports=k;},null);
__d("FBRTCIceStatsParser",[],function(a,b,c,d,e,f){var g=null;h.getInstance=function(){"use strict";if(!g)g=new h();return g;};function h(){"use strict";}h.prototype.extractIceInfo=function(i){"use strict";var j=[],k=i.split("\r\n");for(var l=0;l<k.length;l++){var m=k[l];if(this.$FBRTCIceStatsParser0(m))j.push({gen:this.$FBRTCIceStatsParser1(m),type:this.$FBRTCIceStatsParser2(m)});}return j;};h.prototype.$FBRTCIceStatsParser0=function(i){"use strict";return (i.indexOf('candidate:')>-1);};h.prototype.$FBRTCIceStatsParser1=function(i){"use strict";var j=0,k=i.match(/generation (\d+)/);if(k)j=parseInt(k[1],10);return j;};h.prototype.$FBRTCIceStatsParser2=function(i){"use strict";var j=i.match(/typ (host|relay|srflx|prflx)/);if(j){return j[1];}else return 'unknown';};e.exports=h;},null);
__d("FBRTCCallSummary",["FBRTCConstants","FBRTCIceStatsParser","FBRTCLogger","UserAgentData","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k){var l={CALL_STARTED:'started',POPUP_OPENED:'opened',SENT_OFFER:'s_o',RECV_OFFER:'r_o',SENT_OFFER_ACK:'s_oack',RECV_OFFER_ACK:'r_oack',SENT_RETRIED_OFFER:'s_o2',RECV_RETRIED_OFFER:'r_o2',SENT_RETRIED_OFFER_ACK:'s_oack2',RECV_RETRIED_OFFER_ACK:'r_oack2',SENT_PRANSWER:'s_pr',RECV_PRANSWER:'r_pr',NETWORK_READY:'network_ready',SENT_ANSWER:'s_a',RECV_ANSWER:'r_a',SENT_ANSWER_ACK:'s_aack',RECV_ANSWER_ACK:'r_aack',SENT_RETRIED_ANSWER:'s_a2',RECV_RETRIED_ANSWER:'r_a2',SENT_RETRIED_ANSWER_ACK:'s_aack2',RECV_RETRIED_ANSWER_ACK:'r_aack2',SENT_OK:'s_ok',RECV_OK:'r_ok',CALL_CONNECTED:'connected',CALL_ENDED:'ended'};m.CURRENT_SUMMARY_VERSION=10;function m(n){"use strict";this.peerID=n.peerID;this.callID=n.callID;this.$FBRTCCallSummary0=n.isCaller;this.$FBRTCCallSummary1=(new Date()).valueOf();this.$FBRTCCallSummary2=null;this.$FBRTCCallSummary3={};this.$FBRTCCallSummary4=null;this.$FBRTCCallSummary5=null;this.$FBRTCCallSummary6=null;this.$FBRTCCallSummary7=null;this.$FBRTCCallSummary8=null;this.$FBRTCCallSummary9=null;this.$FBRTCCallSummarya={};this.$FBRTCCallSummaryb={};this.$FBRTCCallSummaryc={};this.$FBRTCCallSummaryd={};this.$FBRTCCallSummarye={};this.$FBRTCCallSummaryf={};this.$FBRTCCallSummaryg=0;this.$FBRTCCallSummaryh={};this.addExtraInfo(i.Key.DEVICE_INFO,this.$FBRTCCallSummaryi());this.$FBRTCCallSummaryj();this.$FBRTCCallSummaryk=h.getInstance();}m.prototype.toJsonString=function(){"use strict";this.$FBRTCCallSummary8=(new Date()).valueOf();return JSON.stringify({version:m.CURRENT_SUMMARY_VERSION,peerID:this.peerID,callID:this.callID,isCaller:this.$FBRTCCallSummary0,startTime:this.$FBRTCCallSummary1,trigger:this.$FBRTCCallSummary2,signalingTime:this.$FBRTCCallSummary3,endCallReason:this.$FBRTCCallSummary4,endCallSubreason:this.$FBRTCCallSummary5,isRemoteEnded:this.$FBRTCCallSummary6,lastUpdatedTime:this.$FBRTCCallSummary7,lastSerializedTime:this.$FBRTCCallSummary8,unsetOnRetrieve:this.$FBRTCCallSummary9,openCount:this.$FBRTCCallSummaryg,extraInfo:this.$FBRTCCallSummaryh,pcStats:this.$FBRTCCallSummarya,captureStats:this.$FBRTCCallSummaryb,gen0IceSentCount:this.$FBRTCCallSummaryc,gen0IceReceivedCount:this.$FBRTCCallSummaryd,iceSentCount:this.$FBRTCCallSummarye,iceReceivedCount:this.$FBRTCCallSummaryf});};m.fromJsonString=function(n){"use strict";var o;try{o=JSON.parse(n);}catch(p){return null;}if(o.version!==m.CURRENT_SUMMARY_VERSION)return null;if(!o.hasOwnProperty('peerID')||!o.hasOwnProperty('callID')||!o.hasOwnProperty('isCaller')||!o.hasOwnProperty('startTime')||!o.hasOwnProperty('trigger')||!o.hasOwnProperty('signalingTime')||!o.hasOwnProperty('endCallReason')||!o.hasOwnProperty('isRemoteEnded')||!o.hasOwnProperty('lastUpdatedTime')||!o.hasOwnProperty('lastSerializedTime'))return null;var q=new m({peerID:o.peerID,callID:o.callID,isCaller:o.isCaller});q.$FBRTCCallSummary1=o.startTime;q.$FBRTCCallSummary2=o.trigger;q.$FBRTCCallSummary3=o.signalingTime;q.$FBRTCCallSummary4=o.endCallReason;q.$FBRTCCallSummary5=o.endCallSubreason;q.$FBRTCCallSummary6=o.isRemoteEnded;q.$FBRTCCallSummary7=o.lastUpdatedTime;q.$FBRTCCallSummary8=o.lastSerializedTime;if(o.unsetOnRetrieve)q.$FBRTCCallSummary9=o.unsetOnRetrieve;if(o.openCount)q.$FBRTCCallSummaryg=o.openCount;if(o.extraInfo)q.$FBRTCCallSummaryh=o.extraInfo;if(o.pcStats)q.$FBRTCCallSummarya=o.pcStats;if(o.captureStats)q.$FBRTCCallSummaryb=o.captureStats;if(o.gen0IceSentCount)q.$FBRTCCallSummaryc=o.gen0IceSentCount;if(o.gen0IceReceivedCount)q.$FBRTCCallSummaryd=o.gen0IceReceivedCount;if(o.iceSentCount)q.$FBRTCCallSummarye=o.iceSentCount;if(o.iceReceivedCount)q.$FBRTCCallSummaryf=o.iceReceivedCount;return q;};m.restoreOrInitialize=function(n,o,p,q,r){"use strict";var s=n.retrieveCallSummary(o,p);if(!s){s=new m({peerID:o,callID:p,isCaller:q});if(r){s.onMessageTypeReceived(r);s.onOfferAckSent(r);}else s.onCallStarted(i.Trigger.UNKNOWN);i.getInstance().logError(o,p,'Missing call summary from storage');}else if(s.$FBRTCCallSummary9){s.$FBRTCCallSummary4=null;s.$FBRTCCallSummary5=null;s.$FBRTCCallSummary6=null;delete s.$FBRTCCallSummary3[l.CALL_ENDED];s.$FBRTCCallSummary9=null;}return s;};m.logSavedSummaries=function(n){"use strict";var o=n.getLoggableSummaries(),p=o.length;if(p<=0)return;var q=i.getInstance(),r=[];for(var s=0;s<p;s++){var t=o[s];q.logEndCallSummary(t);r.push({peerID:t.peerID,callID:t.callID});}n.removeCallSummaries(r);q.logToConsole('Logged pending summaries: '+p);};m.prototype.save=function(n){"use strict";n.storeCallSummary(this.peerID,this.callID,this);};m.prototype.getLastUpdatedTime=function(){"use strict";return this.$FBRTCCallSummary7;};m.prototype.setLastUpdatedTime=function(n){"use strict";this.$FBRTCCallSummary7=n;};m.prototype.getExtraInfo=function(){"use strict";return this.$FBRTCCallSummaryh;};m.prototype.addExtraInfo=function(n,o){"use strict";this.$FBRTCCallSummaryh[n]=o;this.$FBRTCCallSummaryj();};m.prototype.onCallStarted=function(n){"use strict";this.$FBRTCCallSummary2=n;this.$FBRTCCallSummaryl(l.CALL_STARTED);this.$FBRTCCallSummaryj();};m.prototype.onPopupOpened=function(){"use strict";this.$FBRTCCallSummaryl(l.POPUP_OPENED);this.$FBRTCCallSummaryg++;this.$FBRTCCallSummaryj();};m.prototype.setPcStats=function(n){"use strict";this.$FBRTCCallSummarya=n;this.$FBRTCCallSummaryj();};m.prototype.setVideoCaptureStats=function(n,o){"use strict";this.$FBRTCCallSummaryb={w:n,h:o};this.$FBRTCCallSummaryj();};m.prototype.onOfferAckSent=function(n){"use strict";this.onMessageTypeSent({type:g.PayloadType.OFFER_ACK,flag:n.flag});};m.prototype.onMessageTypeSent=function(n){"use strict";var o=n.flag===1;switch(n.type){case g.PayloadType.OFFER:this.$FBRTCCallSummarym(o,l.SENT_OFFER,l.SENT_RETRIED_OFFER);this.$FBRTCCallSummaryn(n,this.$FBRTCCallSummaryc,this.$FBRTCCallSummarye);break;case g.PayloadType.ANSWER:this.$FBRTCCallSummarym(o,l.SENT_ANSWER,l.SENT_RETRIED_ANSWER);this.$FBRTCCallSummaryn(n,this.$FBRTCCallSummaryc,this.$FBRTCCallSummarye);break;case g.PayloadType.OK:this.$FBRTCCallSummaryl(l.SENT_OK);break;case g.PayloadType.PRANSWER:this.$FBRTCCallSummaryl(l.SENT_PRANSWER);break;case g.PayloadType.OFFER_ACK:this.$FBRTCCallSummarym(o,l.SENT_OFFER_ACK,l.SENT_RETRIED_OFFER_ACK);break;case g.PayloadType.ANSWER_ACK:this.$FBRTCCallSummarym(o,l.SENT_ANSWER_ACK,l.SENT_RETRIED_ANSWER_ACK);break;case g.PayloadType.ICE_CANDIDATE:this.$FBRTCCallSummaryn(n,this.$FBRTCCallSummaryc,this.$FBRTCCallSummarye);break;default:}this.$FBRTCCallSummaryj();};m.prototype.$FBRTCCallSummaryn=function(n,o,p){"use strict";var q=null,r=null,s=this.$FBRTCCallSummaryk.extractIceInfo(n.sdp);for(var t=0;t<s.length;t++){q=s[t].gen;r=s[t].type;if(q===0)this.$FBRTCCallSummaryo(o,r);this.$FBRTCCallSummaryo(p,r);}};m.prototype.$FBRTCCallSummaryo=function(n,o){"use strict";if(!n[o]){n[o]=1;}else n[o]=n[o]+1;};m.prototype.onMessageTypeReceived=function(n){"use strict";var o=n.flag===1;switch(n.type){case g.PayloadType.OFFER:this.$FBRTCCallSummarym(o,l.RECV_OFFER,l.RECV_RETRIED_OFFER);this.$FBRTCCallSummaryn(n,this.$FBRTCCallSummaryd,this.$FBRTCCallSummaryf);break;case g.PayloadType.ANSWER:this.$FBRTCCallSummarym(o,l.RECV_ANSWER,l.RECV_RETRIED_ANSWER);this.$FBRTCCallSummaryn(n,this.$FBRTCCallSummaryd,this.$FBRTCCallSummaryf);break;case g.PayloadType.OK:this.$FBRTCCallSummaryl(l.RECV_OK);break;case g.PayloadType.PRANSWER:this.$FBRTCCallSummaryl(l.RECV_PRANSWER);break;case g.PayloadType.OFFER_ACK:this.$FBRTCCallSummarym(o,l.RECV_OFFER_ACK,l.RECV_RETRIED_OFFER_ACK);break;case g.PayloadType.ANSWER_ACK:this.$FBRTCCallSummarym(o,l.RECV_ANSWER_ACK,l.RECV_RETRIED_ANSWER_ACK);break;case g.PayloadType.ICE_CANDIDATE:this.$FBRTCCallSummaryn(n,this.$FBRTCCallSummaryd,this.$FBRTCCallSummaryf);break;default:}this.$FBRTCCallSummaryj();};m.prototype.onCallConnected=function(){"use strict";this.$FBRTCCallSummaryl(l.NETWORK_READY);this.$FBRTCCallSummaryl(l.CALL_CONNECTED);this.$FBRTCCallSummaryj();};m.prototype.onCallEnded=function(n,o,p,q){"use strict";this.$FBRTCCallSummary9=p;this.$FBRTCCallSummary4=n;this.$FBRTCCallSummary5=q;this.$FBRTCCallSummary6=o;this.$FBRTCCallSummaryl(l.CALL_ENDED);this.$FBRTCCallSummaryj();};m.prototype.toString=function(){"use strict";var n={};n.core_metrics=this.$FBRTCCallSummaryp();n.time_series=null;return JSON.stringify(n);};m.prototype.$FBRTCCallSummaryp=function(){"use strict";var n={};n.ver=m.CURRENT_SUMMARY_VERSION;n.caller=this.$FBRTCCallSummary0;n.conn=this.$FBRTCCallSummaryq();n.peer_id=this.peerID;n.has_video=true;n.open_count=this.$FBRTCCallSummaryg;n.signaling=this.$FBRTCCallSummaryr();n.sender=this.$FBRTCCallSummarys();n.receiver=this.$FBRTCCallSummaryt();n.end=this.$FBRTCCallSummaryu();n.video=this.$FBRTCCallSummaryv();return n;};m.prototype.$FBRTCCallSummaryq=function(){"use strict";var n={dtls:1};if(this.$FBRTCCallSummarya.sender&&this.$FBRTCCallSummarya.sender.rtt)n.rtt=this.$FBRTCCallSummarya.sender.rtt;return n;};m.prototype.$FBRTCCallSummaryr=function(){"use strict";var n={};if(this.$FBRTCCallSummary2)n.trigger=this.$FBRTCCallSummary2;n.start_time=this.$FBRTCCallSummary1;n.time_from_start=this.$FBRTCCallSummary3;var o=this.$FBRTCCallSummary3[l.CALL_CONNECTED],p=this.$FBRTCCallSummary3[l.CALL_ENDED];if(o){if(!p)if(this.$FBRTCCallSummary8){p=this.$FBRTCCallSummary8-this.$FBRTCCallSummary1;}else p=this.$FBRTCCallSummaryw();var q=p-o;if(q>0)n.duration=q;}return n;};m.prototype.$FBRTCCallSummarys=function(){"use strict";var n={};if(this.$FBRTCCallSummaryc)n.ice_g0=this.$FBRTCCallSummaryc;if(this.$FBRTCCallSummarye)n.ice=this.$FBRTCCallSummarye;if(this.$FBRTCCallSummarya.sender)k(n,this.$FBRTCCallSummarya.sender);return n;};m.prototype.$FBRTCCallSummaryt=function(){"use strict";var n={};if(this.$FBRTCCallSummaryd)n.ice_g0=this.$FBRTCCallSummaryd;if(this.$FBRTCCallSummaryf)n.ice=this.$FBRTCCallSummaryf;return n;};m.prototype.$FBRTCCallSummaryu=function(){"use strict";var n={};if(this.$FBRTCCallSummary4!==null){n.end_call_reason_string=g.callEndReasonString(this.$FBRTCCallSummary4);if(this.$FBRTCCallSummary5!==null)n.end_call_subreason_string=this.$FBRTCCallSummary5;n.remote_ended=this.$FBRTCCallSummary6;}if(this.$FBRTCCallSummarya.end)k(n,this.$FBRTCCallSummarya.end);return n;};m.prototype.$FBRTCCallSummaryv=function(){"use strict";var n={capture:{}};if(this.$FBRTCCallSummarya.video&&this.$FBRTCCallSummarya.video.sender)k(n,this.$FBRTCCallSummarya.video.sender);if(this.$FBRTCCallSummaryb)k(n.capture,this.$FBRTCCallSummaryb);return {sender:n};};m.prototype.$FBRTCCallSummaryw=function(){"use strict";return (new Date()).valueOf()-this.$FBRTCCallSummary1;};m.prototype.$FBRTCCallSummaryl=function(n){"use strict";if(this.$FBRTCCallSummary3[n])return;this.$FBRTCCallSummary3[n]=this.$FBRTCCallSummaryw();};m.prototype.$FBRTCCallSummarym=function(n,o,p){"use strict";if(n){this.$FBRTCCallSummaryl(p);}else this.$FBRTCCallSummaryl(o);};m.prototype.$FBRTCCallSummaryj=function(){"use strict";this.$FBRTCCallSummary7=(new Date()).valueOf();};m.prototype.$FBRTCCallSummaryi=function(){"use strict";return {device:j.deviceName,os:j.platformName,os_version:j.platformFullVersion,browser:j.browserName,browser_version:j.browserFullVersion,screen_height:window.screen.availHeight,screen_width:window.screen.availWidth};};e.exports=m;},null);
__d("FBRTCCallSummaryStore",["CacheStorage","FBRTCCallSummary","FBRTCLogger","areEqual"],function(a,b,c,d,e,f,g,h,i,j){var k='localstorage',l='RTC_CALL_SUMMARY_',m='summary',n=2000,o=3,p=3*60*1000,q=null;r.getInstance=function(){"use strict";if(!q)q=new r();return q;};function r(){"use strict";this.$FBRTCCallSummaryStore0=new g(k,l);this.$FBRTCCallSummaryStore1=i.getInstance();}r.prototype.storeCallSummary=function(s,t,u){"use strict";var v=this;this.$FBRTCCallSummaryStore2(function(w){if(!w[s])w[s]={};var x=w[s][t];if(x){var y=v.$FBRTCCallSummaryStore3(x);if(y&&y.getLastUpdatedTime()>u.getLastUpdatedTime()){v.$FBRTCCallSummaryStore1.logToConsole('Outdated summaries');return null;}}w[s][t]=v.$FBRTCCallSummaryStore4(u);return w;},v.$FBRTCCallSummaryStore1.logError.bind(v.$FBRTCCallSummaryStore1,s,t));};r.prototype.retrieveCallSummary=function(s,t){"use strict";var u=this.$FBRTCCallSummaryStore5(),v=null;if(u[s])v=u[s][t];if(v){return this.$FBRTCCallSummaryStore3(v);}else return null;};r.prototype.removeCallSummary=function(s,t){"use strict";this.removeCallSummaries([{peerID:s,callID:t}]);};r.prototype.removeCallSummaries=function(s){"use strict";var t=this;this.$FBRTCCallSummaryStore2(function(u){var v=s.length;for(var w=0;w<v;w++){var x=s[w].peerID,y=s[w].callID;if(u[x]&&u[x][y]){delete u[x][y];if(t.$FBRTCCallSummaryStore6(u[x]))delete u[x];}}return u;},t.$FBRTCCallSummaryStore1.logError.bind(t.$FBRTCCallSummaryStore1,null,null));};r.prototype.getLoggableSummaries=function(){"use strict";var s=this.$FBRTCCallSummaryStore5(),t=[];for(var u in s)if(s.hasOwnProperty(u))for(var v in s[u])if(s[u].hasOwnProperty(v)){var w=this.$FBRTCCallSummaryStore3(s[u][v],p);if(w)t.push(w);}return t;};r.prototype.$FBRTCCallSummaryStore6=function(s){"use strict";for(var t in s)if(s.hasOwnProperty(t))return false;return true;};r.prototype.$FBRTCCallSummaryStore4=function(s){"use strict";var t={__t:Date.now(),__d:s.toJsonString()};return t;};r.prototype.$FBRTCCallSummaryStore3=function(s,t){"use strict";if(s)if(!t||(Date.now()-s.__t>=t))return h.fromJsonString(s.__d);return null;};r.prototype.$FBRTCCallSummaryStore5=function(){"use strict";var s=this.$FBRTCCallSummaryStore0.get(m)||{};return s;};r.prototype.$FBRTCCallSummaryStore2=function(s,t,u,v){"use strict";if(u===(void 0)||u===null)u=o;var w=this.$FBRTCCallSummaryStore5(),x=this.$FBRTCCallSummaryStore5(),y=s(w);if(y===null)return;var z=this.$FBRTCCallSummaryStore5();if(j(x,z)){this.$FBRTCCallSummaryStore0.set(m,y);this.$FBRTCCallSummaryStore1.logToConsole('Updated summaries');}else if(u>0){t('Retry lock');if(v){var aa=this;setTimeout(function(){aa.$FBRTCCallSummaryStore2(s,t,u-1,true);},n);}else this.$FBRTCCallSummaryStore2(s,t,u-1,true);}else t('Failed to lock');};e.exports=r;},null);
__d("FBRTCUtils",["emptyFunction","randomInt","AsyncRequest"],function(a,b,c,d,e,f,g,h,i){var j=6000,k={attachMediaStream:function(l,m){if(window.webkitRTCPeerConnection){l.src=window.webkitURL.createObjectURL(m);}else{l.mozSrcObject=m;l.play();}},reattachMediaStream:function(l,m){if(window.webkitRTCPeerConnection){l.src=m.src;}else{l.mozSrcObject=m.mozSrcObject;l.play();}},generateRandomInt:function(){return h(0,4294967294)+1;},aboutEqual:function(l,m){return (l-m)<.01&&(m-l)<.01;},sendServerRequest:function(l,m,n,o,p){m=m||g;n=n||g;o=o||false;p=p||j;var q=new i().setURI(l).setAllowCrossPageTransition(true).setHandler(m).setErrorHandler(n).setTimeoutHandler(p,function(){n();});if(o)q.setOption('asynchronous',false);q.send();}};e.exports=k;},null);
__d("XVideoCallInitController",["XController"],function(a,b,c,d,e,f){e.exports=b("XController").create("\/videocall\/init\/",{peer_id:{type:"Int",required:true},call_id:{type:"Int",required:true},is_caller:{type:"Bool",defaultValue:false}});},null);
__d("XVideoCallController",["XController"],function(a,b,c,d,e,f){e.exports=b("XController").create("\/videocall\/incall\/",{peer_id:{type:"Int",required:true},call_id:{type:"Int"},is_caller:{type:"Bool",defaultValue:false}});},null);
__d("FBRTCUrlManager",["FBRTCLogger","FBRTCUtils","XVideoCallInitController","XVideoCallController","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k){var l=3,m=function(q,r,s){g.getInstance().logCallAction(q,r,g.CallAction.OLD_URI);return j.getURIBuilder().setInt('peer_id',q).setInt('call_id',r).setBool('is_caller',s).getURI();},n=function(q,r,s,t,u,v){if(v===(void 0)||v===null)v=l;var w=i.getURIBuilder().setInt('peer_id',q).setInt('call_id',r).setBool('is_caller',s).getURI();h.sendServerRequest(w,function(x){t(x.payload.uri);},function(x){if(v>0){n(q,r,s,t,u,v-1);}else t(m(q,r,s));});},o=function(q){window.history.replaceState({},'',q);},p={init:function(q,r){this._pendingUriUpdate=false;this._peerID=q.peerID;this._callID=q.callID;if(r){this._connectedUri=r;}else this._connectedUri=m(this._peerID,this._callID);},setCallModel:function(q){if(this._peerID!==q.peerID||this._callID!==q.callID){this._peerID=q.peerID;this._callID=q.callID;this._connectedUri=null;n(this._peerID,this._callID,null,this._onNewConnectedUriSet.bind(this),k);}},onCallStarted:function(){if(this._connectedUri){o(this._connectedUri);}else this._pendingUriUpdate=true;},onCallEnded:function(){o(m(this._peerID));},getCallUri:n,_onNewConnectedUriSet:function(q){this._connectedUri=q;if(this._pendingUriUpdate){o(q);this._pendingUriUpdate=false;}}};e.exports=p;},null);
__d("FBRTCCallUI",["Cookie","UserAgent","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConstants","FBRTCLogger","FBRTCUrlManager","pageID"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=null,p={openAsCaller:function(q,r,s){if(!o&&window.rtcCallChildWindow){o=window.rtcCallChildWindow;window.rtcCallChildWindow=null;}if(this._shouldFocusCallWindow(q)){o.focus();return;}if(this._shouldCloseCallWindow())o.close();l.getInstance().logCallAction(q,r,l.CallAction.START_CALL,null,s);var t=new i({peerID:q,callID:r,isCaller:true});t.onCallStarted(s);this._open(q,r,true,t,false);},openAsCallee:function(q,r,s,t){this._open(q,r,false,s,t);},_shouldFocusCallWindow:function(q){return o&&!o.closed&&o.rtcCallInProgessWith===q;},_shouldCloseCallWindow:function(){return o&&!o.closed&&!o.rtcCallInProgessWith;},_open:function(q,r,s,t,u){g.clear('vcpwn');g.clear('vctid');var v=this._windowPosition(),w=['menubar=no','location=no','scrollbars=no','status=no','personalbar=no',v.height,v.width,v.top,v.left].join(',');if(this._isSparkBrowser())w='';t.addExtraInfo(l.Key.INITIATED_BY_PAGE_ID,n);t.onCallEnded(k.CallEndReason.CLIENT_ERROR,false,true,'PopupPending');t.save(j.getInstance());if(!u){o=window.open('','Video Call',w);this._setUri(o,q,r,s);}else{l.getInstance().logCallAction(q,r,l.CallAction.OPEN_POPUP);o=window.open(u,'Video Call',w);}if(window.focus)o.focus();},_setUri:function(q,r,s,t){m.getCallUri(r,s,t,function(u){l.getInstance().logCallAction(r,s,l.CallAction.OPEN_POPUP);q.location=u;},function(){l.getInstance().logCallAction(r,s,l.CallAction.FAILED_GETTING_URI);});},_windowPosition:function(){var q=933,r=700,s,t,u,v;if(window.innerWidth!==(void 0)){t=window.innerWidth;s=window.innerHeight;}else{t=screen.width;s=screen.height;}if(window.screenLeft!==(void 0)){u=window.screenLeft;v=window.screenTop;}else{u=window.screenX;v=window.screenY;}var w=Math.floor(((t/2)-(q/2))+u),x=Math.floor(((s/2)-(r/2))+v);return {height:'height='+r.toString(),width:'width='+q.toString(),top:'top='+x.toString(),left:'left='+w.toString()};},_isSparkBrowser:function(){return h.isBrowser('Chrome < 34')&&h.isBrowser('Chrome > 33');}};e.exports=p;},null);
__d("FBRTCIceCache",[],function(a,b,c,d,e,f){function g(){"use strict";this.$FBRTCIceCache0={};}g.prototype.cacheCandidate=function(h,i,j){"use strict";if(!this.$FBRTCIceCache0[h])this.$FBRTCIceCache0[h]=[];if(!this.$FBRTCIceCache0[h][i])this.$FBRTCIceCache0[h][i]=[];this.$FBRTCIceCache0[h][i].unshift(j);};g.prototype.drainCandidates=function(h,i,j){"use strict";if(this.$FBRTCIceCache0[h]&&this.$FBRTCIceCache0[h][i]){var k;while(this.$FBRTCIceCache0[h][i].length>0){k=this.$FBRTCIceCache0[h][i].pop();j(k);}}};e.exports=g;},null);
__d("XIncomingCallDialogController",["XController"],function(a,b,c,d,e,f){e.exports=b("XController").create("\/videocall\/incoming\/",{user_id:{type:"Int",required:true},call_id:{type:"Int"},__asyncDialog:{type:"Int"}});},null);
__d("FBRTCIncomingCall",["AsyncDialog","AsyncRequest","Dialog","MissedVideoCallHandler","setTimeoutAcrossTransitions","XIncomingCallDialogController","FBRTCSoundController"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=70000;function o(p,q,r,s){"use strict";this.peerID=p;this.callID=q;this.callSummary=r;this.offerMsg=s;this.ringing=false;this.$FBRTCIncomingCall0=null;}o.prototype.showIncomingDialog=function(){"use strict";var p=i.getCurrent();if(p)p.hide();j.setSuppressAll(true);this.ringing=true;this.timeout=k(this.$FBRTCIncomingCall1.bind(this),n);var q=l.getURIBuilder().setInt('user_id',this.peerID).setInt('call_id',this.callID).getURI();this.$FBRTCIncomingCall0=new h(q);g.send(this.$FBRTCIncomingCall0,this.$FBRTCIncomingCall2.bind(this));};o.prototype.$FBRTCIncomingCall2=function(p){"use strict";this.$FBRTCIncomingCall0=null;this.view=p;p.subscribe('confirm',this.$FBRTCIncomingCall3.bind(this));p.subscribe('cancel',this.$FBRTCIncomingCall4.bind(this));m.playIncomingRingtone(this.callID,this.peerID,true);j.setSuppressAll(false);};o.prototype.cancel=function(){"use strict";if(this.$FBRTCIncomingCall0){this.$FBRTCIncomingCall0.abort();this.$FBRTCIncomingCall0=null;}if(this.timeout)clearTimeout(this.timeout);if(this.view){this.view.hide();this.view=null;}m.stopIncomingRingtone();this.ringing=false;};o.prototype.isForPeer=function(p){"use strict";return this.peerID===p;};o.prototype.isForPeerAndCall=function(p,q){"use strict";return (this.peerID===p)&&(this.callID===q);};o.prototype.$FBRTCIncomingCall3=function(p,q){"use strict";this.cancel();if(this.onAnswer)this.onAnswer(this.peerID,this.callID,this.offerMsg,this.callSummary,q.value);};o.prototype.$FBRTCIncomingCall4=function(){"use strict";this.cancel();if(this.onIgnore)this.onIgnore(this.peerID,this.callID,this.callSummary);};o.prototype.$FBRTCIncomingCall1=function(){"use strict";this.cancel();if(this.onTimeout)this.onTimeout(this.peerID,this.callID,this.callSummary);};e.exports=o;},null);
__d("FBRTCLocalMessageQueue",["CacheStorage","FBRTCLogger","randomInt"],function(a,b,c,d,e,f,g,h,i){var j='localstorage',k='RTC_',l='offer',m='data_',n='last_write_index',o='session_id',p=30*1000,q=20*1000,r=15*1000,s=500;function t(){"use strict";this.$FBRTCLocalMessageQueue0=null;this.$FBRTCLocalMessageQueue1=null;this.$FBRTCLocalMessageQueue2=null;this.$FBRTCLocalMessageQueue3=null;this.$FBRTCLocalMessageQueue4=null;this.$FBRTCLocalMessageQueue5=h.getInstance();}t.prototype.enqueueOffer=function(u,v){"use strict";var w=this.$FBRTCLocalMessageQueue6(u);this.$FBRTCLocalMessageQueue7(w,l,v);};t.prototype.getOffer=function(u){"use strict";var v=this.$FBRTCLocalMessageQueue6(u);return this.$FBRTCLocalMessageQueue8(v,l);};t.prototype.removeOffer=function(u){"use strict";var v=this.$FBRTCLocalMessageQueue6(u);v.remove(l);};t.prototype.maybeEnqueueMessage=function(u,v,w){"use strict";if(!this.$FBRTCLocalMessageQueue9(u))return;var x=this.$FBRTCLocalMessageQueue6(u),y=x.get(n)||0;y++;x.set(n,y,true);var z=m+y.toString();this.$FBRTCLocalMessageQueue7(x,z,w);this.$FBRTCLocalMessageQueue5.logToConsole('Queued '+z);};t.prototype.enableEnqueuing=function(u,v,w){"use strict";this.$FBRTCLocalMessageQueue5.logInfo(u,v,'Enabled enqueuing');if(this.$FBRTCLocalMessageQueue1)clearTimeout(this.$FBRTCLocalMessageQueue1);if(w===(void 0))w=q;if(this.$FBRTCLocalMessageQueue0!==u){var x=this.$FBRTCLocalMessageQueue6(u);this.$FBRTCLocalMessageQueue0=u;x.set(n,0,true);x.set(o,i(0,4294967295),true);}var y=this;this.$FBRTCLocalMessageQueue1=setTimeout(function(){y.$FBRTCLocalMessageQueue5.logInfo(u,v,'Disabled enqueuing');y.$FBRTCLocalMessageQueue0=null;y.$FBRTCLocalMessageQueue1=null;},w);};t.prototype.enableDequeuing=function(u,v,w){"use strict";if(w===(void 0))w=r;this.$FBRTCLocalMessageQueuea(u,v,w);};t.prototype.$FBRTCLocalMessageQueuea=function(u,v,w){"use strict";var x=this.$FBRTCLocalMessageQueue6(u),y=x.get(o);if(y!==this.$FBRTCLocalMessageQueue4){this.$FBRTCLocalMessageQueue4=y;this.$FBRTCLocalMessageQueue3=0;}var z=x.get(n)||0,aa=0;while(this.$FBRTCLocalMessageQueue3<z){this.$FBRTCLocalMessageQueue3++;var ba=m+this.$FBRTCLocalMessageQueue3.toString(),ca=this.$FBRTCLocalMessageQueueb(x,ba);if(ca&&v){v(ca);aa++;}}this.$FBRTCLocalMessageQueue5.logToConsole('Dequeued '+aa+' ('+u+') with '+w+' left)');if(w>0){var da=this;this.$FBRTCLocalMessageQueue2=setTimeout(da.$FBRTCLocalMessageQueuea.bind(da,u,v,w-s),s);}else{this.$FBRTCLocalMessageQueue2=null;this.$FBRTCLocalMessageQueue3=null;this.$FBRTCLocalMessageQueue4=null;}};t.prototype.$FBRTCLocalMessageQueue9=function(u){"use strict";return (this.$FBRTCLocalMessageQueue0===u);};t.prototype.$FBRTCLocalMessageQueue7=function(u,v,w){"use strict";var x={__t:Date.now(),__d:w};u.set(v,x);};t.prototype.$FBRTCLocalMessageQueue8=function(u,v){"use strict";var w=u.get(v);if(w&&this.$FBRTCLocalMessageQueuec(w)){return w.__d;}else if(w)u.remove(v);return null;};t.prototype.$FBRTCLocalMessageQueueb=function(u,v){"use strict";var w=this.$FBRTCLocalMessageQueue8(u,v);if(w!==null){u.remove(v);return w;}return null;};t.prototype.$FBRTCLocalMessageQueuec=function(u){"use strict";return Date.now()-u.__t<p;};t.prototype.$FBRTCLocalMessageQueue6=function(u){"use strict";return new g(j,k+u+'_');};e.exports=t;},null);
__d("FBRTCMessageDedup",[],function(a,b,c,d,e,f){var g={},h={check:function(i,j,k){if(!g[i])g[i]={};if(!g[i][j])g[i][j]={};if(g[i][j][k])return false;g[i][j][k]=true;return true;}};e.exports=h;},null);
__d("FBRTCSdpUtils",[],function(a,b,c,d,e,f){var g='m=video 0',h=function(k){return k.match(/^a=rtpmap:(\d+)\s/)[1];},i=function(k,l,m){var n=h(k[l]),o=k[m].split('RTP/SAVPF'),p=o[1].split(/\s+/),q=p.indexOf(n);p.splice(q,1);o[1]=p.join(' ');k[m]=o.join('RTP/SAVPF');k.splice(l,1);},j={addIceOptionToSdp:function(k,l){"use strict";var m="a=ice-options:",n=k.indexOf(m);if(n>=0){var o=k.indexOf("\r",n);return [k.slice(0,o)," ",l,k.slice(o)].join('');}var p=m+l,q=k.split("\r\n"),r=false,s=-1;for(var t=0;t<q.length;t++){var u=q[t].slice(0,2);if(u=="s="){r=true;continue;}if(r&&u=="a="){s=t;break;}}if(s>=0){q.splice(s,0,p);return q.join("\r\n");}return [k,p,"\r\n"].join('');},preferIsac:function(k){var l=k.split("\r\n"),m=-1,n=-1,o=-1,p=-1;for(var q=0;q<l.length;q++){var r=l[q];if(r.match(/m=audio\s+\d+\s+RTP\/SAVPF(\s+\d+)+/))m=q;if(p===-1&&m>-1&&r.match(/^a=rtpmap:/))p=q;if(r.match(/^a=rtpmap:\d+\s+ISAC\/16000/))n=q;if(r.match(/^a=rtpmap:\d+\s+ISAC\/32000/))o=q;}if(m===-1||n===-1||p===-1)return l.join("\r\n");var s=l[n];i(l,n,m);l.splice(p,0,s);l[m]=l[m].replace('RTP/SAVPF','RTP/SAVPF '+h(s));if(o>-1)i(l,o,m);return l.join("\r\n");},disableVideo:function(k){var l=/m=video\s+\S+/;k=k.replace(l,g);return k;},isVideoSupported:function(k){return (k&&k.indexOf('m=video')&&k.indexOf(g)==-1);}};e.exports=j;},null);
__d("FBRTCMessageUtils",["FBRTCSdpUtils","VideoCallSupport"],function(a,b,c,d,e,f,g,h){var i='mobile',j={maybeDisableVideoInOffer:function(k,l){if(l===i){k.sdp=g.disableVideo(k.sdp);k.videoon=false;}return k;},shouldIgnoreInteropMessage:function(k){return (!h.isReceiveInteropSupported()&&k===i);}};e.exports=j;},null);
__d("XVideoCallSendMessageController",["XController"],function(a,b,c,d,e,f){e.exports=b("XController").create("\/videocall\/sendmessage\/",{recipient_id:{type:"Int",required:true},msg_id:{type:"Int",required:true},message_info:{type:"String",required:true},webrtc_fbtrace:{type:"Int"}});},null);
__d("FBRTCMessageSender",["CurrentUser","XVideoCallSendMessageController","FBRTCConstants","FBRTCLogger","FBRTCUtils","SiteData","Fbtrace","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=0;function p(){"use strict";this.onSendFailure=null;this.$FBRTCMessageSender0=j.getInstance();}p.prototype.sendOffer=function(q,r,s,t){"use strict";var u=this.$FBRTCMessageSender1(r,i.PayloadType.OFFER);u.sdp=s;u.handlescollision=true;u.videoon=t;this.$FBRTCMessageSender2(q,u);return this.$FBRTCMessageSender3(q,u);};p.prototype.sendAnswer=function(q,r,s,t){"use strict";var u=this.$FBRTCMessageSender1(r,i.PayloadType.ANSWER);u.sdp=s;u.videoon=t;this.$FBRTCMessageSender2(q,u);return this.$FBRTCMessageSender3(q,u);};p.prototype.sendIceCandidate=function(q,r,s){"use strict";var t=this.$FBRTCMessageSender1(r,i.PayloadType.ICE_CANDIDATE);t.sdp_mid=s.sdpMid;t.label=s.sdpMLineIndex;t.sdp=s.candidate;this.$FBRTCMessageSender4(q,t);};p.prototype.sendHangup=function(q,r,s,t){"use strict";var u=this.$FBRTCMessageSender1(r,i.PayloadType.HANGUP);u.reason=s;this.$FBRTCMessageSender4(q,u,t);};p.prototype.sendOtherDismiss=function(q){"use strict";var r=this.$FBRTCMessageSender1(q,i.PayloadType.OTHER_DISMISS);this.$FBRTCMessageSender4(g.getID(),r);};p.prototype.sendOfferAck=function(q,r,s){"use strict";this.$FBRTCMessageSender5(q,r,s,i.PayloadType.OFFER_ACK);};p.prototype.sendOfferNack=function(q,r,s){"use strict";this.$FBRTCMessageSender5(q,r,s,i.PayloadType.OFFER_NACK,1356043);};p.prototype.sendAnswerAck=function(q,r,s){"use strict";this.$FBRTCMessageSender5(q,r,s,i.PayloadType.ANSWER_ACK);};p.prototype.sendIcerestartOffer=function(q,r,s){"use strict";var t=this.$FBRTCMessageSender1(r,i.PayloadType.ICERESTART_OFFER);t.sdp=s;t.handlescollision=true;t.icerestart=true;this.$FBRTCMessageSender2(q,t);return this.$FBRTCMessageSender3(q,t);};p.prototype.sendMuteStateUpdate=function(q,r,s){"use strict";var t=this.$FBRTCMessageSender1(r,i.PayloadType.SET_VIDEO);t.videoon=s;this.$FBRTCMessageSender4(q,t);};p.prototype.sendMsgAck=function(){"use strict";};p.prototype.sendOk=function(){"use strict";};p.prototype.sendPranswer=function(){"use strict";};p.prototype.sendIcerestartAnswer=function(){"use strict";};p.prototype.$FBRTCMessageSender1=function(q,r){"use strict";var s=k.generateRandomInt(),t={version:o,type:r,call_id:q,msg_id:s};return t;};p.prototype.$FBRTCMessageSender3=function(q,r){"use strict";r.flag=1;return this.$FBRTCMessageSender2.bind(this,q,r);};p.prototype.$FBRTCMessageSender2=function(q,r){"use strict";this.$FBRTCMessageSender4(q,r,false,true,true);};p.prototype.$FBRTCMessageSender5=function(q,r,s,t,u){"use strict";var v=this.$FBRTCMessageSender1(r,t);v.ack_id=s.msg_id;if(s.flag===1)v.flag=1;if(u!==(void 0))s.errorCode=u;this.$FBRTCMessageSender4(q,v);};p.prototype.$FBRTCMessageSender4=function(q,r,s,t,u){"use strict";var v=r.msg_id,w={peer_id:q,call_id:r.call_id,msg_id:v,msg_type:r.type},x={};n(x,w);x.op='sendServerRequest:'+r.type;x.policy='WebRTC';var y=m.requestReceive('browser',String(l.revision||'dev'),x),z=(h.getURIBuilder()).setInt('recipient_id',q).setInt('msg_id',v).setString('message_info',JSON.stringify(r)).setInt('webrtc_fbtrace',y.isOn()?1:0).getURI();if(t)var aa=this.$FBRTCMessageSender4.bind(this,q,r,s,false,u);var ba=this.$FBRTCMessageSender6.bind(this,w),ca=this.$FBRTCMessageSender7.bind(this,w,aa,u);m.withDefaultNode(y,function(){k.sendServerRequest(z,ba,ca,s);});if(this.onMessageSent)this.onMessageSent(q,r);this.$FBRTCMessageSender0.logSentMessage(q,r.call_id,r);};p.prototype.$FBRTCMessageSender6=function(q){"use strict";this.$FBRTCMessageSender0.logSentMessageSuccess(q.peer_id,q.call_id,q.msg_type,q.msg_id);};p.prototype.$FBRTCMessageSender7=function(q,r,s,t){"use strict";if(t)var u=t.getError?t.getError():t;this.$FBRTCMessageSender0.logSentMessageFailure(q.peer_id,q.call_id,q.msg_type,q.msg_id,u);if(this.onSendFailure){var v=null;if(u===1356001||u===1356049){v=i.CallEndReason.NO_PERMISSION;}else if(u===1356046||u===1356045){v=i.CallEndReason.CALLER_NOT_VISIBLE;}else if(u===1356003||u===1356002||u===1356044||u===1356048){v=i.CallEndReason.OTHER_NOT_CAPABLE;}else if(r){r();return;}else if(s)v=i.CallEndReason.SIGNALING_MESSAGE_FAILED;if(v)this.onSendFailure(v,u);}};e.exports=p;},null);
__d("XVideoCallMissedCallController",["XController"],function(a,b,c,d,e,f){e.exports=b("XController").create("\/videocall\/missed_call\/",{user_id:{type:"Int",required:true},__asyncDialog:{type:"Int"}});},null);
__d("FBRTCMissedVideoCallHandler",["AsyncDialog","AsyncRequest","FBRTCLogger","MissedVideoCallHandler","VideoCallSupport","XVideoCallMissedCallController"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=null,n=null;o.hideDialog=function(){"use strict";if(m){m.hide();m=null;n=null;j.setSuppressAll(false);}};function o(p){"use strict";this.$FBRTCMissedVideoCallHandler0=p;this.$FBRTCMissedVideoCallHandler1=null;}o.prototype.onCallMissed=function(p){"use strict";if(!k.isWebrtcSupported())return;if(n===null)this.$FBRTCMissedVideoCallHandler1=p;};o.prototype.showDialog=function(){"use strict";if(!this.$FBRTCMissedVideoCallHandler1||n)return;j.setSuppressAll(true);n=this.$FBRTCMissedVideoCallHandler1;this.$FBRTCMissedVideoCallHandler1=null;var p=l.getURIBuilder().setInt('user_id',n).getURI(),q=new h(p);g.send(q,this.$FBRTCMissedVideoCallHandler2.bind(this));};o.prototype.$FBRTCMissedVideoCallHandler2=function(p){"use strict";m=p;p.subscribe('confirm',this.$FBRTCMissedVideoCallHandler3.bind(this));p.subscribe('cancel',this.$FBRTCMissedVideoCallHandler4.bind(this));};o.prototype.$FBRTCMissedVideoCallHandler3=function(){"use strict";this.$FBRTCMissedVideoCallHandler0.showOutgoingCallDialog(n,'missed_call_dialog',i.Trigger.RETURN_CALL);o.hideDialog();};o.prototype.$FBRTCMissedVideoCallHandler4=function(){"use strict";o.hideDialog();};e.exports=o;},null);
__d("FBRTCIncomingCallController",["Banzai","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCCallUI","FBRTCConstants","FBRTCIceCache","FBRTCIncomingCall","FBRTCLocalMessageQueue","FBRTCLogger","FBRTCMessageDedup","FBRTCMessageUtils","FBRTCMessageSender","FBRTCMissedVideoCallHandler","FBRTCUnsupportedBrowserMessage","VideoCallSupport"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){function v(w){"use strict";this.$FBRTCIncomingCallController0=null;this.$FBRTCIncomingCallController1=new s(w);this.$FBRTCIncomingCallController2=new r();this.$FBRTCIncomingCallController3=new n();this.$FBRTCIncomingCallController4=i.getInstance();this.$FBRTCIncomingCallController5=new l();this.$FBRTCIncomingCallController6=o.getInstance();w.setRTCMessageHandler(this.$FBRTCIncomingCallController7.bind(this));g.subscribe(g.SEND,h.logSavedSummaries.bind(this,this.$FBRTCIncomingCallController4));}v.prototype.startingCallTo=function(w,x){"use strict";this.$FBRTCIncomingCallController3.enableEnqueuing(w,x);};v.prototype.$FBRTCIncomingCallController7=function(w){"use strict";if(!w.payload||!w.call_id||!w.from){this.$FBRTCIncomingCallController6.logErrorWithoutID('Unknown data: '+JSON.stringify(w));return;}var x=w.from,y=parseInt(w.call_id,10),z=JSON.parse(w.payload),aa=z.type,ba=w.source;if(q.shouldIgnoreInteropMessage(ba)){this.$FBRTCIncomingCallController6.logInfo(x,y,'Ignoring message (no-interop): '+z.msg_id);return;}if(!p.check(x,y,z.msg_id)){this.$FBRTCIncomingCallController6.logInfo(x,y,'Ignoring message (duplicate): '+z.msg_id);return;}this.$FBRTCIncomingCallController6.logReceivedMessage(x,y,z);if(u.isWebrtcSupported())this.$FBRTCIncomingCallController3.maybeEnqueueMessage(x,y,w);switch(aa){case k.PayloadType.OFFER:z=q.maybeDisableVideoInOffer(z,ba);this.$FBRTCIncomingCallController8(x,y,z);break;case k.PayloadType.HANGUP:this.$FBRTCIncomingCallController9(x,y,z);break;case k.PayloadType.OTHER_DISMISS:this.$FBRTCIncomingCallControllera();break;case k.PayloadType.ICE_CANDIDATE:if(u.isWebrtcSupported())this.$FBRTCIncomingCallController5.cacheCandidate(x,y,w);break;case k.PayloadType.OFFER_ACK:if(u.isWebrtcSupported()){this.$FBRTCIncomingCallController3.enableEnqueuing(x,y);this.$FBRTCIncomingCallController3.maybeEnqueueMessage(x,y,w);}break;case k.PayloadType.ANSWER:case k.PayloadType.MSG_ACK:case k.PayloadType.OK:case k.PayloadType.PRANSWER:case k.PayloadType.ICERESTART_OFFER:case k.PayloadType.ICERESTART_ANSWER:case k.PayloadType.ANSWER_ACK:case k.PayloadType.SET_VIDEO:case k.PayloadType.OFFER_NACK:break;default:break;}};v.prototype.$FBRTCIncomingCallController8=function(w,x,y){"use strict";if(u.isWebrtcSupported()){this.$FBRTCIncomingCallController2.sendOfferAck(w,x,y);}else this.$FBRTCIncomingCallController2.sendOfferNack(w,x,y);this.$FBRTCIncomingCallController6.logCallAction(w,x,o.CallAction.RECEIVED_CALL);var z=this.$FBRTCIncomingCallControllerb(w,x,y);if(this.$FBRTCIncomingCallController0!==null&&!this.$FBRTCIncomingCallController0.isForPeer(w)){this.$FBRTCIncomingCallControllerc(w,x,z,k.CallEndReason.IN_ANOTHER_CALL,false,false,true);this.$FBRTCIncomingCallController1.onCallMissed(w);return;}if(!u.isWebrtcSupported()){this.$FBRTCIncomingCallControllerc(w,x,z,k.CallEndReason.UNSUPPORTED_VERSION,false,false,false);t.showForIncomingCall(x,w);return;}this.$FBRTCIncomingCallController0=new m(w,x,z,y);this.$FBRTCIncomingCallController0.onAnswer=this.$FBRTCIncomingCallControllerd.bind(this);this.$FBRTCIncomingCallController0.onIgnore=this.$FBRTCIncomingCallControllere.bind(this);this.$FBRTCIncomingCallController0.onTimeout=this.$FBRTCIncomingCallControllerf.bind(this);s.hideDialog();this.$FBRTCIncomingCallController0.showIncomingDialog();this.$FBRTCIncomingCallController6.logEvent(w,x,'Incoming call dialog shown');};v.prototype.$FBRTCIncomingCallController9=function(w,x,y){"use strict";if(this.$FBRTCIncomingCallController0&&this.$FBRTCIncomingCallController0.isForPeerAndCall(w,x)){var z=y.reason;if(typeof z=='string'||z instanceof String)z=k.endCallReasonFromString(z);this.$FBRTCIncomingCallController0.cancel();this.$FBRTCIncomingCallControllerc(w,x,this.$FBRTCIncomingCallController0.callSummary,z,true,true,false);this.$FBRTCIncomingCallController0.cancel();this.$FBRTCIncomingCallController0=null;if(z!==k.CallEndReason.OTHER_INSTANCE_HANDLED){this.$FBRTCIncomingCallController1.onCallMissed(w);this.$FBRTCIncomingCallController1.showDialog();}}};v.prototype.$FBRTCIncomingCallControllera=function(){"use strict";t.dismiss();if(this.$FBRTCIncomingCallController0){this.$FBRTCIncomingCallController0.cancel();this.$FBRTCIncomingCallController0=null;}};v.prototype.$FBRTCIncomingCallControllerb=function(w,x,y){"use strict";var z=new h({peerID:w,callID:x,isCaller:false});z.onMessageTypeReceived(y);z.onOfferAckSent(y);return z;};v.prototype.$FBRTCIncomingCallControllerd=function(w,x,y,z,aa){"use strict";this.$FBRTCIncomingCallController6.logCallAction(w,x,o.CallAction.ANSWER_CALL);this.$FBRTCIncomingCallController2.sendOtherDismiss(x);this.$FBRTCIncomingCallController3.enableEnqueuing(w,x);this.$FBRTCIncomingCallController3.enqueueOffer(w,y);var ba=this;this.$FBRTCIncomingCallController5.drainCandidates(w,x,function(ca){ba.$FBRTCIncomingCallController3.maybeEnqueueMessage(w,x,ca);});j.openAsCallee(w,x,z,aa);this.$FBRTCIncomingCallController0=null;this.$FBRTCIncomingCallController1.showDialog();};v.prototype.$FBRTCIncomingCallControllere=function(w,x,y){"use strict";this.$FBRTCIncomingCallControllerc(w,x,y,k.CallEndReason.IGNORE_CALL,false,true,true);this.$FBRTCIncomingCallController0=null;this.$FBRTCIncomingCallController1.showDialog();};v.prototype.$FBRTCIncomingCallControllerf=function(w,x,y){"use strict";this.$FBRTCIncomingCallControllerc(w,x,y,k.CallEndReason.NO_ANSWER_TIMEOUT,false,true,true);this.$FBRTCIncomingCallController0=null;this.$FBRTCIncomingCallController1.onCallMissed(w);this.$FBRTCIncomingCallController1.showDialog();};v.prototype.$FBRTCIncomingCallControllerc=function(w,x,y,z,aa,ba,ca){"use strict";if(ca)this.$FBRTCIncomingCallController2.sendHangup(w,x,z);if(ba)this.$FBRTCIncomingCallController2.sendOtherDismiss(x);y.onCallEnded(z,aa);y.save(this.$FBRTCIncomingCallController4);var da=k.fullCallEndReasonString(z,aa);this.$FBRTCIncomingCallController6.logCallAction(w,x,o.CallAction.END_CALL,da);};e.exports=v;},null);
__d("ChatTabTypeaheadDataSource",["MercuryTypeaheadConstants","MercuryTypeaheadDataSource"],function(a,b,c,d,e,f,g,h){for(var i in h)if(h.hasOwnProperty(i))k[i]=h[i];var j=h===null?null:h.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=h;function k(l){"use strict";l=l||{};l.maxResults=g.COMPOSER_CHATTAB_MAX;h.call(this,l);this.$ChatTabTypeaheadDataSource0=true;}k.prototype.buildData=function(l){"use strict";var m=[],n=[],o=[],p=[],q=[];l.forEach(function(r){var s=j.getEntry.call(this,r);switch(s.render_type){case g.FRIEND_TYPE:m.push(r);break;case g.THREAD_TYPE:if(this.$ChatTabTypeaheadDataSource0)n.push(r);break;case g.NON_FRIEND_TYPE:o.push(r);break;case g.FB4C_TYPE:p.push(r);break;case g.PAGE_TYPE:if(this.$ChatTabTypeaheadDataSource0)q.push(r);break;default:this.logQuery({event:'chat_tab_render_type_error'});break;}},this);return j.buildData.call(this,m.concat(p,n,q,o));};k.prototype.query=function(l,m,n,o){"use strict";this.logQuery({event:'query_chat_tab',query:l});return j.query.call(this,l,m,n,o);};k.prototype.respond=function(l,m,n){"use strict";var o=j.respond.call(this,l,m,n);this.logResponse({event:'query_response_chat_tab',response_query:l,response_uids:m});return o;};k.prototype.setShowThreads=function(l){"use strict";this.$ChatTabTypeaheadDataSource0=l;};e.exports=k;},null);
__d("SyncRequestNotificationBeeperItemContents.react",["Animation","CloseButton.react","ImageBlock.react","NotificationUserActions","React","SyncRequest.react","SyncRequestStatusEnum","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=k.createClass({displayName:"SyncRequestNotificationBeeperItemContents",_markAsRead:function(){j.markNotificationsAsRead([this.props.beep.notificationID]);this.props.onHide();},_onClose:function(){this._markAsRead();this.props.onHide();},_doFlash:function(){new g(this.refs.inner.getDOMNode()).from('opacity','0').to('opacity','1').duration(200).go();},componentDidMount:function(){if(this.props.beep.rendererData.status!=m.PENDING)this.props.onReadyToHide(this.props.beep.notificationID);},componentDidUpdate:function(p){if(this.props.beep.rendererData.status!=m.PENDING&&p.beep.rendererData.status==m.PENDING)this.props.onReadyToHide(this.props.beep.notificationID);},onRequestStatusUpdate:function(p,q){if(p!=m.PENDING&&q==m.PENDING)this.props.onReadyToHide(this.props.beep.notificationID);},render:function(){var p=this.props.beep,q=p.rendererData;return (k.createElement("div",{ref:"inner"},k.createElement(h,{className:"_3soc",onClick:this._onClose,size:"medium"}),k.createElement(i,{className:"_3soj"},k.createElement("img",{src:p.actors[0].profile_picture.uri,className:"_3sok"}),k.createElement("div",{className:"_3sol"},k.createElement(l,{app:q.app,creationTime:q.creation_time,requestId:q.id.toString(),receiver:q.receiver,sender:q.sender,status:q.status,timeout:q.timeout,timeRemaining:q.time_remaining,viewerId:q.receiver.id,onStatusUpdate:this.onRequestStatusUpdate})))));}});e.exports=o;},null);
__d("LiveMessageReceiver",["Arbiter","ChannelConstants","copyProperties","emptyFunction","shield"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m){this.eventName=m;this.subs=null;this.handler=j;this.shutdownHandler=null;this.registered=false;this.appId=1;}i(l,{getAppMessageType:function(m,n){return 'live_message/'+m+':'+n;},route:function(m){var n=function(o){var p=l.getAppMessageType(m.app_id,m.event_name);g.inform(p,o,g.BEHAVIOR_PERSISTENT);};n(m.response);}});i(l.prototype,{setAppId:function(m){this.appId=m;return this;},setHandler:function(m){this.handler=m;this._dirty();return this;},setRestartHandler:j,setShutdownHandler:function(m){this.shutdownHandler=k(m);this._dirty();return this;},_dirty:function(){if(this.registered){this.unregister();this.register();}},register:function(){var m=function(o,p){return this.handler(p);}.bind(this),n=l.getAppMessageType(this.appId,this.eventName);this.subs={};this.subs.main=g.subscribe(n,m);if(this.shutdownHandler)this.subs.shut=g.subscribe(h.ON_SHUTDOWN,this.shutdownHandler);this.registered=true;return this;},unregister:function(){if(!this.subs)return this;for(var m in this.subs)if(this.subs[m])this.subs[m].unsubscribe();this.subs=null;this.registered=false;return this;}});e.exports=l;},null);
__d("initLiveMessageReceiver",["Arbiter","ChannelConstants","LiveMessageReceiver"],function(a,b,c,d,e,f,g,h,i){g.subscribe(h.getArbiterType('app_msg'),function(j,k){i.route(k.obj);});},null);