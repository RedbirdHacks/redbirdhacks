/*!CK:881787519!*//*1422245755,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["BzKt+"]); }

__d("ComposerXLinkScraperAttachment",["Arbiter","AsyncRequest","BanzaiODS","Button","ComposerXAttachment","ComposerXAttachmentButtonBarState","ComposerXAttachmentUtils","ComposerXController","ComposerXDragDrop","ComposerXPrivacyWidgetTags","DOM","Event","Parent","copyProperties","csx","XUploadVideoCalloutController"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){for(var w in k)if(k.hasOwnProperty(w))y[w]=k[w];var x=k===null?null:k.prototype;y.prototype=Object.create(x);y.prototype.constructor=y;y.__superConstructor__=k;function y(z,aa,ba){"use strict";k.call(this);this._root=z;this._tagger=aa;this._config=ba;this.attachmentClassName=ba.selectedAttachmentClassName;if(ba.plus_version)this._initDragDropDialog(ba.dragdropPhotoDialog);if(this._config.upload_video_instead)this._uploadVideoInsteadDialog=this._config.upload_video_instead;}y.prototype.getRoot=function(){"use strict";return this._root;};y.prototype.initWithComponents=function(){"use strict";if(!this._config.canCreateShare){this._switchToAttachmentWithoutLinkShare();return;}var z=this.getComponent('maininput');m.initMentions(z,this._config.mentionsPlaceholder,this.getComposerID());this._tagger.init(this);this._privacyWidgetTags=new p(this);l.trackCityChanges(this);var aa=q.scry(this._root,"._9s");if(aa.length>0){var ba=aa[0];this._removeListener=r.listen(ba,'click',function(){i.bumpEntityKey('content_production','composer.remove_link.fbfeed');this._switchToAttachmentWithoutLinkShare();}.bind(this));}if(this._uploadVideoInsteadDialog){this._uploadVideoInsteadDialog.show();this._postActionButtonsSetEnable(false);this._uploadVideoInsteadDialog.subscribe('confirm',this._onUploadInsteadDialogClose.bind(this));}if(this._config.plus_version)this._dragdrop=new o(this._root,this._composerID,this._config.targetID,this._onDragDropPhoto.bind(this));if(this._config.postActionsButton!=null)this._config.postActionsButton.initHiddenInputs(this.getComponent('pabhiddeninputs').instance);g.inform('topictargeting/link_scraped',this._root);g.inform('composer/render_pab_nux');};y.prototype.cleanup=function(){"use strict";if(this._config.canCreateShare)this._tagger.cleanup();if(this._privacyWidgetTags){this._privacyWidgetTags.destroy();this._privacyWidgetTags=null;}if(this._removeListener){this._removeListener.remove();this._removeListener=null;}if(this._dragdrop){this._dragdrop.deactivate();this._dragdrop=null;}};y.prototype.reset=function(){"use strict";this._tagger.reset();};y.prototype.canSwitchAway=function(){"use strict";return !s.byClass(this._root,'async_saving');};y.prototype._onUploadInsteadDialogClose=function(){"use strict";this._postActionButtonsSetEnable(true);this._uploadVideoInsteadDialog.hide();var z=v.getURIBuilder().getURI();new h().setURI(z).send();};y.prototype._postActionButtonsSetEnable=function(z){"use strict";j.setEnabled(this._config.postActionsButton.postButton,z);j.setEnabled(this._config.postActionsButton.postActionsButton,z);j.setEnabled(this._config.postActionsButton.boostButton,z);};y.prototype._switchToAttachmentWithoutLinkShare=function(){"use strict";n.getAttachment(this._root,this._config.removeEndpoint);g.inform('topictargeting/link_removed',this._root);};y.prototype._initDragDropDialog=function(z){"use strict";this._dragdropPhotoDialog=z;z.subscribe('button',this._onConfirmDragDropPhoto.bind(this));};y.prototype._onDragDropPhoto=function(z){"use strict";this._uploadPhotoCallback=z;this._dragdropPhotoDialog.show();};y.prototype._onConfirmDragDropPhoto=function(){"use strict";this._uploadPhotoCallback&&this._uploadPhotoCallback();this._dragdropPhotoDialog.hide();};t(y.prototype,{_privacyWidgetTags:null,_removeListener:null,_uploadPhotoCallback:null,_dragdrop:null});e.exports=y;},null);
__d("ComposerXMediaUploadProgressBarAttachment",["Button","CSS","ComposerXAttachment","ComposerXAttachmentUtils","ComposerXController","ComposerXMediaUploadHandler","ComposerXPrivacyWidgetTags","ComposerXAttachmentPrefillMixin","DOM","DOMQuery","ErrorDialog","Event","Form","PagesBanzaiLogger","Parent","React","Run","SubscriptionsHandler","VideoUploadProcessingDialog.react","classWithMixins","cx","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba){var ca={},da=z(i,ba(n));for(var ea in da)if(da.hasOwnProperty(ea))ga[ea]=da[ea];var fa=da===null?null:da.prototype;ga.prototype=Object.create(fa);ga.prototype.constructor=ga;ga.__superConstructor__=da;function ga(ha){"use strict";da.call(this);this._root=ha.root;this._fileInput=ha.file_input;this._fileInputButton=ha.file_input_button;this._fileInputText=ha.file_input_text;this._trailerCheckbox=ha.trailer_checkbox;this._trailerCheckboxContainer=ha.trailer_checkbox_container;this._progressBar=ha.progress_bar;this._tagger=ha.tagger;this._submitButton=ha.submit_button;this._config=ha.config;this.attachmentClassName="_92";this._processingDialogContainer=ha.processing_dialog_container;}ga.prototype.getRoot=function(){"use strict";return this._root;};ga.prototype.initWithComponents=function(){"use strict";ca[this._composerID]=this;i.registerConditionForComposerCancel&&i.registerConditionForComposerCancel(this.getComposerID(),function(){return this._fileInput.getValue();}.bind(this));w.onLeave(this._abandonUpload.bind(this));w.onUnload(this._abandonUpload.bind(this));this._subscriptionsHandler=new x();this._subscriptionsHandler.addSubscriptions(this._fileInput.subscribe('change',this._handleFileChange.bind(this)),r.listen(this._root,'submit',this._handleSubmit.bind(this),r.Priority.URGENT),this._config.videoUploader.subscribe('upload-finished',this._handleVideoUploadFinished.bind(this)),this._config.videoUploader.subscribe('upload-failed',this._handleVideoUploadFailed.bind(this)),this._config.videoUploader.subscribe('post-finished',this._handleVideoPostFinished.bind(this)),this._config.videoUploader.subscribe('post-failed',this._handleVideoPostFailed.bind(this)));j.initMentions(this.getComponent('maininput'),this._config.mentionsPlaceholder,this.getComposerID(),{dontFocusMentions:this._config.dontFocusMentions});this._tagger.init(this);this._privacyWidgetTags=new m(this);this._hasSelected=false;this._root.action=this._config.photoEndpoint;if(this._config.postActionsButton!=null)this._config.postActionsButton.initHiddenInputs(this.getComponent('pabhiddeninputs').instance);if(this._config.prefill)this._initPrefill(p.find(this.getComponent('maininput').element,'textarea.input'),this._config.prefill);};ga.prototype.cleanup=function(){"use strict";this._tagger.cleanup();this._privacyWidgetTags.destroy();this._privacyWidgetTags=null;this._subscriptionsHandler.release();delete ca[this._composerID];};ga.prototype.reset=function(){"use strict";this._tagger.reset();this._resetState();if(this._config.prefill)this._resetPrefill();};ga.prototype.canSwitchAway=function(){"use strict";return !u.byClass(this._root,'async_saving')&&!this._config.videoUploader.isSessionInProgress();};ga.prototype._abandonUpload=function(){"use strict";if(this._config.videoUploader.isSessionInProgress())this._config.videoUploader.abandon();};ga.prototype._handleFileChange=function(){"use strict";g.setEnabled(this._submitButton,!!this._fileInput.getValue());o.setContent(this._fileInputText,this._fileInput.getValue().split('\\').pop());if(this._trailerCheckboxContainer){h.conditionClass(this._trailerCheckboxContainer,'hidden_elem',!l.isVideoFile(this._fileInput));this._trailerCheckbox.checked=false;}var ha=this._config.pageSelectLoggingData;if(ha&&!this._hasSelected&&this._fileInput.getValue()){this._hasSelected=true;t.logData(ha,null);}};ga.prototype._handleSubmit=function(){"use strict";if(!l.isVideoFile(this._fileInput))return;g.setEnabled(this._submitButton,false);g.setEnabled(this._fileInputButton,false);var ha=this._fileInput.getInput();ha.name='video';this._config.videoUploader.upload(ha);h.addClass(this._root,"_4_8");return false;};ga.prototype._handleVideoUploadFinished=function(){"use strict";var ha=s.serialize(this._root);this._config.videoUploader.post(ha);};ga.prototype._handleVideoUploadFailed=function(event,ha){"use strict";if(ha)q.show(ha.error_summary,ha.error_description);this._resetState();};ga.prototype._handleVideoPostFinished=function(event,ha){"use strict";v.render(v.createElement(y,{videoID:ha.video_id,show:true}),this._processingDialogContainer);k.reset(this._root);};ga.prototype._handleVideoPostFailed=function(event,ha){"use strict";if(ha)q.show(ha.error_summary,ha.error_description);this._resetState();};ga.prototype._resetState=function(){"use strict";this._progressBar.reset();this._fileInput.clear();this._fileInput.getInput().name='file1';this._config.videoUploader.abandon();o.setContent(this._fileInputText,'');g.setEnabled(this._fileInputButton,true);h.removeClass(this._root,"_4_8");h.hide(this._trailerCheckboxContainer);};e.exports=ga;},null);
__d("ComposerXTimelineTagger",["Arbiter","ComposerXPlusTagger","CSS","cx","DOMQuery","Event","Focus"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){for(var n in h)if(h.hasOwnProperty(n))p[n]=h[n];var o=h===null?null:h.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=h;function p(){"use strict";if(h!==null)h.apply(this,arguments);}p.prototype.init=function(q,r){"use strict";o.init.call(this,q);if(!r)r='backdateicon';this._datepicker=this.getTimelineDatepickerComponent(q);this._datepickerIcon=q.getComponent(r);if(this._datepickerIcon&&this._datepicker){this.registerTagger('date',this._datepicker,this._datepickerIcon);var s=k.find(this._datepicker.element,'select.periodMenu.yearMenu');this.setTaggerCallback('date',m.set.bind(null,s));this._subscriptions.push(this._datepicker.instance.subscribe('changed',this._handleDateChanged.bind(this)));this._subscriptions.push(g.subscribe('Datepicker/schedulingPosts',this._handleDateChanged.bind(this)));this._subscriptions.push(g.subscribe('Datepicker/resetSchedulingPosts',function(){this._handleDateChanged('Datepicker/resetSchedulingPosts');this.hideTaggers();}.bind(this)));l.listen(this._datepickerIcon.element,'click',function(){g.inform('Datepicker/clicked');});}g.inform('ComposerXTimelineTagger/init',{composerTimelineTagger:this,datePickerElement:this._datepicker?this._datepicker.element:null,datePickerInstance:this._datepicker?this._datepicker.instance:null},g.BEHAVIOR_STATE);};p.prototype.getTimelineDatepickerComponent=function(q){"use strict";return q.getComponent('backdatepicker');};p.prototype._handleDateChanged=function(event){"use strict";var q=this._datepicker.instance.isSet();i.conditionClass(this._datepickerIcon.element,"_4_na",(q||event=='Datepicker/schedulingPosts')&&event!='Datepicker/resetSchedulingPosts');};e.exports=p;},null);